<h2 id='setup'>SETUP()</h2><pre class="highlight fortran tab-fortran"><code><span class="w">      </span><span class="k">SUBROUTINE</span><span class="w"> </span><span class="n">SETUP</span><span class="p">(</span><span class="n">LAST</span><span class="p">)</span><span class="w">                                            
      </span><span class="k">IMPLICIT</span><span class="w"> </span><span class="kt">REAL</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">H</span><span class="p">,</span><span class="n">O</span><span class="o">-</span><span class="n">Z</span><span class="p">)</span><span class="w"> 
      </span><span class="k">IMPLICIT</span><span class="w"> </span><span class="kt">INTEGER</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="n">N</span><span class="p">)</span><span class="w"> 
      </span><span class="kt">INTEGER</span><span class="o">*</span><span class="mi">4</span><span class="w"> </span><span class="n">NSEED</span><span class="w">                                       
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">INPT</span><span class="p">/</span><span class="n">NGAS</span><span class="p">,</span><span class="n">NSTEP</span><span class="p">,</span><span class="n">NANISO</span><span class="p">,</span><span class="n">EFINAL</span><span class="p">,</span><span class="n">ESTEP</span><span class="p">,</span><span class="n">AKT</span><span class="p">,</span><span class="n">ARY</span><span class="p">,</span><span class="n">TEMPC</span><span class="p">,</span><span class="n">TORR</span><span class="p">,</span><span class="n">IPEN</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">CNSTS</span><span class="p">/</span><span class="n">ECHARG</span><span class="p">,</span><span class="n">EMASS</span><span class="p">,</span><span class="n">AMU</span><span class="p">,</span><span class="n">PIR2</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">INPT2</span><span class="p">/</span><span class="n">KGAS</span><span class="p">,</span><span class="n">LGAS</span><span class="p">,</span><span class="n">DETEFF</span><span class="p">,</span><span class="n">EXCWGHT</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">INPT1</span><span class="p">/</span><span class="n">NDVEC</span><span class="w">                                
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">CNSTS1</span><span class="p">/</span><span class="n">CONST1</span><span class="p">,</span><span class="n">CONST2</span><span class="p">,</span><span class="n">CONST3</span><span class="p">,</span><span class="n">CONST4</span><span class="p">,</span><span class="n">CONST5</span><span class="w">                  
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">RATIO</span><span class="p">/</span><span class="n">AN1</span><span class="p">,</span><span class="n">AN2</span><span class="p">,</span><span class="n">AN3</span><span class="p">,</span><span class="n">AN4</span><span class="p">,</span><span class="n">AN5</span><span class="p">,</span><span class="n">AN6</span><span class="p">,</span><span class="n">AN</span><span class="p">,</span><span class="n">FRAC</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w">               
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">GASN</span><span class="p">/</span><span class="n">NGASN</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w">                                 
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">SETP</span><span class="p">/</span><span class="n">TMAX</span><span class="p">,</span><span class="n">SMALL</span><span class="p">,</span><span class="n">API</span><span class="p">,</span><span class="n">ESTART</span><span class="p">,</span><span class="n">THETA</span><span class="p">,</span><span class="n">PHI</span><span class="p">,</span><span class="n">TCFMAX</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">TCFMAX1</span><span class="p">,</span><span class="w">
     </span><span class="p">/</span><span class="n">RSTART</span><span class="p">,</span><span class="n">EFIELD</span><span class="p">,</span><span class="n">ETHRM</span><span class="p">,</span><span class="n">ECUT</span><span class="p">,</span><span class="n">NEVENT</span><span class="p">,</span><span class="n">IMIP</span><span class="p">,</span><span class="n">IWRITE</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">SET2</span><span class="p">/</span><span class="n">DRXINIT</span><span class="p">,</span><span class="n">DRYINIT</span><span class="p">,</span><span class="n">DRZINIT</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">BFLD</span><span class="p">/</span><span class="n">EOVB</span><span class="p">,</span><span class="n">WB</span><span class="p">,</span><span class="n">BTHETA</span><span class="p">,</span><span class="n">BMAG</span><span class="w"> 
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">IONC</span><span class="p">/</span><span class="kt">DOUBLE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">20000</span><span class="p">),</span><span class="n">CMINIXSC</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">CMINEXSC</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">ECLOSS</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">WPLN</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">ICOUNT</span><span class="p">,</span><span class="n">AVPFRAC</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">MRATIO</span><span class="p">/</span><span class="n">VAN1</span><span class="p">,</span><span class="n">VAN2</span><span class="p">,</span><span class="n">VAN3</span><span class="p">,</span><span class="n">VAN4</span><span class="p">,</span><span class="n">VAN5</span><span class="p">,</span><span class="n">VAN6</span><span class="p">,</span><span class="n">VAN</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">OUTPT</span><span class="p">/</span><span class="n">ICOLL</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span><span class="n">NETOT</span><span class="p">,</span><span class="n">NPRIME</span><span class="p">,</span><span class="n">TMAX1</span><span class="p">,</span><span class="n">TIME</span><span class="p">(</span><span class="mi">300</span><span class="p">),</span><span class="n">NNULL</span><span class="p">,</span><span class="w">
     </span><span class="p">/</span><span class="n">NITOT</span><span class="p">,</span><span class="n">ICOLN</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span><span class="n">ICOLNN</span><span class="p">(</span><span class="mi">60</span><span class="p">),</span><span class="n">NREAL</span><span class="p">,</span><span class="n">NEXCTOT</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">PRIM3</span><span class="p">/</span><span class="n">MSUM</span><span class="p">(</span><span class="mi">10000</span><span class="p">),</span><span class="n">MCOMP</span><span class="p">(</span><span class="mi">10000</span><span class="p">),</span><span class="n">MRAYL</span><span class="p">(</span><span class="mi">10000</span><span class="p">),</span><span class="n">MPAIR</span><span class="p">(</span><span class="mi">10000</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">MPHOT</span><span class="p">(</span><span class="mi">10000</span><span class="p">),</span><span class="n">MVAC</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">RLTVY</span><span class="p">/</span><span class="n">BET</span><span class="p">(</span><span class="mi">20000</span><span class="p">),</span><span class="n">GAM</span><span class="p">(</span><span class="mi">20000</span><span class="p">),</span><span class="n">VC</span><span class="p">,</span><span class="n">EMS</span><span class="w"> 
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">COMP</span><span class="p">/</span><span class="n">ICMP</span><span class="p">,</span><span class="n">ICFLG</span><span class="p">,</span><span class="n">IRAY</span><span class="p">,</span><span class="n">IRFLG</span><span class="p">,</span><span class="n">IPAP</span><span class="p">,</span><span class="n">IPFLG</span><span class="p">,</span><span class="n">IBRM</span><span class="p">,</span><span class="n">IBFLG</span><span class="p">,</span><span class="n">LPEFLG</span><span class="w"> 
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">MIX2</span><span class="p">/</span><span class="n">E</span><span class="p">(</span><span class="mi">20000</span><span class="p">),</span><span class="n">EROOT</span><span class="p">(</span><span class="mi">20000</span><span class="p">),</span><span class="n">QTOT</span><span class="p">(</span><span class="mi">20000</span><span class="p">),</span><span class="n">QREL</span><span class="p">(</span><span class="mi">20000</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">QINEL</span><span class="p">(</span><span class="mi">20000</span><span class="p">),</span><span class="n">QEL</span><span class="p">(</span><span class="mi">20000</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">PLOT</span><span class="p">/</span><span class="n">NXPL10</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NYPL10</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NZPL10</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NXPL40</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">NYPL40</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NZPL40</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NXPL100</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NYPL100</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NZPL100</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">NXPL400</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NYPL400</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NZPL400</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NXPL1000</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NYPL1000</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">NZPL1000</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NXPL2</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NYPL2</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NZPL2</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NXPL4000</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">NYPL4000</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NZPL4000</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NXPL10000</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NYPL10000</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">NZPL10000</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NXPL40000</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NYPL40000</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NZPL40000</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">NXPL100000</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NYPL100000</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NZPL100000</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NRPL2</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NRPL10</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">NRPL40</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NRPL100</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NRPL400</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NRPL1000</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NRPL4000</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">NRPL10000</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NRPL40000</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NRPL100000</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">NEPL1</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">NEPL10</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span><span class="n">NEPL100</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span><span class="n">MELEC</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span><span class="n">MELEC3</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span><span class="n">MELEC10</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">MELEC30</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span><span class="n">MELEC100</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span><span class="n">MELEC300</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">BREMG</span><span class="p">/</span><span class="n">EBRGAM</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">BRDCOSX</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">BRDCOSY</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">BRDCOSZ</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">BRX</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">BRY</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">BRZ</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">BRT</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">EBRTOT</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">NBREM</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">CLUS</span><span class="p">/</span><span class="n">XAV</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span><span class="n">YAV</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span><span class="n">ZAV</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span><span class="n">TAV</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">XYAV</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span><span class="n">XYZAV</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span><span class="n">DX</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span><span class="n">DY</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span><span class="n">DZ</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DT</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span><span class="n">DXY</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span><span class="n">DXYZ</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span><span class="n">NCL</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span><span class="n">FARX1</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span><span class="w">
     </span><span class="p">/,</span><span class="n">FARY1</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span><span class="n">FARZ1</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span><span class="n">FARXY1</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span><span class="n">RMAX1</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">TSUM</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span><span class="n">XNEG</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span><span class="w"> 
     </span><span class="p">/</span><span class="n">YNEG</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span><span class="n">ZNEG</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span><span class="n">EDELTA</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span><span class="n">EDELTA2</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">NCLEXC</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">KSEED</span><span class="p">/</span><span class="n">NSEED</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">ECASC</span><span class="p">/</span><span class="n">NEGAS</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span><span class="n">LEGAS</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span><span class="n">IESHELL</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span><span class="n">IECASC</span><span class="w">
</span><span class="n">C</span><span class="w">                                                                       
</span><span class="n">C</span><span class="w">   </span><span class="n">NEW</span><span class="w"> </span><span class="n">UPDATE</span><span class="w"> </span><span class="n">OF</span><span class="w"> </span><span class="n">CONSTANTS</span><span class="w"> </span><span class="mi">2010</span><span class="w">
</span><span class="n">C</span><span class="w">
      </span><span class="n">API</span><span class="o">=</span><span class="n">DACOS</span><span class="p">(</span><span class="mf">-1.0D0</span><span class="p">)</span><span class="w">                                                 
      </span><span class="n">ARY</span><span class="o">=</span><span class="mf">13.60569253D0</span><span class="w">                                              
      </span><span class="n">PIR2</span><span class="o">=</span><span class="mf">8.7973554297D-17</span><span class="w">                                       
      </span><span class="n">ECHARG</span><span class="o">=</span><span class="mf">1.602176565D-19</span><span class="w">                                            
      </span><span class="n">EMASS</span><span class="o">=</span><span class="mf">9.10938291D-31</span><span class="w">                     
      </span><span class="n">EMS</span><span class="o">=</span><span class="mf">510998.928D0</span><span class="w">
      </span><span class="n">VC</span><span class="o">=</span><span class="mf">299792458.0D0</span><span class="w">                       
      </span><span class="n">AMU</span><span class="o">=</span><span class="mf">1.660538921D-27</span><span class="w">                                             
      </span><span class="n">BOLTZ</span><span class="o">=</span><span class="mf">8.6173324D-5</span><span class="w">     
      </span><span class="n">BOLTZJ</span><span class="o">=</span><span class="mf">1.3806488D-23</span><span class="w">                                              
      </span><span class="n">AWB</span><span class="o">=</span><span class="mf">1.758820088D10</span><span class="w">                                              
      </span><span class="n">ALOSCH</span><span class="o">=</span><span class="mf">2.6867805D19</span><span class="w">      
      </span><span class="n">RE</span><span class="o">=</span><span class="mf">2.8179403267D-13</span><span class="w">    
      </span><span class="n">ALPH</span><span class="o">=</span><span class="mf">137.035999074</span><span class="w">
      </span><span class="n">HBAR</span><span class="o">=</span><span class="mf">6.58211928D-16</span><span class="w">                                     
      </span><span class="n">EOVM</span><span class="o">=</span><span class="n">DSQRT</span><span class="p">(</span><span class="mf">2.0D0</span><span class="o">*</span><span class="n">ECHARG</span><span class="p">/</span><span class="n">EMASS</span><span class="p">)</span><span class="o">*</span><span class="mf">100.0D0</span><span class="w">                            
      </span><span class="n">ABZERO</span><span class="o">=</span><span class="mf">273.15D0</span><span class="w">                                                   
      </span><span class="n">ATMOS</span><span class="o">=</span><span class="mf">760.0D0</span><span class="w">                                                     
      </span><span class="n">CONST1</span><span class="o">=</span><span class="n">AWB</span><span class="p">/</span><span class="mf">2.0D0</span><span class="o">*</span><span class="mf">1.0D-19</span><span class="w">                                          
      </span><span class="n">CONST2</span><span class="o">=</span><span class="n">CONST1</span><span class="o">*</span><span class="mf">1.0D-02</span><span class="w">                                             
      </span><span class="n">CONST3</span><span class="o">=</span><span class="n">DSQRT</span><span class="p">(</span><span class="mf">0.2D0</span><span class="o">*</span><span class="n">AWB</span><span class="p">)</span><span class="o">*</span><span class="mf">1.0D-09</span><span class="w">                                   
      </span><span class="n">CONST4</span><span class="o">=</span><span class="n">CONST3</span><span class="o">*</span><span class="n">ALOSCH</span><span class="o">*</span><span class="mf">1.0D-15</span><span class="w">                                      
      </span><span class="n">CONST5</span><span class="o">=</span><span class="n">CONST3</span><span class="p">/</span><span class="mf">2.0D0</span><span class="w">
      </span><span class="n">TWOPI</span><span class="o">=</span><span class="mf">2.0D0</span><span class="o">*</span><span class="n">API</span><span class="w">
      </span><span class="n">NANISO</span><span class="o">=</span><span class="mi">2</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">55</span><span class="w"> </span><span class="n">K</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="w">
      </span><span class="n">NBREM</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">EBRTOT</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
   </span><span class="mi">55</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
      </span><span class="n">ICFLG</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">IRFLG</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">IPFLG</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">IBFLG</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">LPEFLG</span><span class="o">=</span><span class="mi">0</span><span class="w">
</span><span class="n">C</span><span class="w">  </span><span class="o">--------------------------------------------</span><span class="w">       
</span><span class="n">C</span><span class="w">                                                                       
</span><span class="n">C</span><span class="w">      </span><span class="k">READ</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">OUTPUT</span><span class="w"> </span><span class="n">CONTROL</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">INTEGRATION</span><span class="w"> </span><span class="k">DATA</span><span class="w">                      
</span><span class="n">C</span><span class="w">                                                                       
      </span><span class="k">READ</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">NGAS</span><span class="p">,</span><span class="n">NEVENT</span><span class="p">,</span><span class="n">IMIP</span><span class="p">,</span><span class="n">NDVEC</span><span class="p">,</span><span class="n">NSEED</span><span class="p">,</span><span class="n">ESTART</span><span class="p">,</span><span class="n">ETHRM</span><span class="p">,</span><span class="n">ECUT</span><span class="w">    
    </span><span class="mi">2</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="l">5I10</span><span class="p">,</span><span class="l">3F10.5</span><span class="p">)</span><span class="w">  
      </span><span class="n">ICOUNT</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">IMIP</span><span class="ow">.EQ.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">ICOUNT</span><span class="o">=</span><span class="mi">1</span><span class="w"> 
      </span><span class="k">IF</span><span class="p">(</span><span class="n">NGAS</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">99</span><span class="w"> 
      </span><span class="k">IF</span><span class="p">(</span><span class="n">ESTART</span><span class="ow">.GT.</span><span class="mf">3.0D6</span><span class="ow">.AND.</span><span class="n">IMIP</span><span class="ow">.EQ.</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
      </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">664</span><span class="p">)</span><span class="w"> </span><span class="n">ESTART</span><span class="w">
  </span><span class="mi">664</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' PROGRAM STOPPED: X-RAY ENERGY='</span><span class="p">,</span><span class="l">D12.3</span><span class="p">,</span><span class="s1">'EV. MAXIMUM ENERGY
     / 3.0MEV'</span><span class="p">)</span><span class="w">
       </span><span class="k">STOP</span><span class="w"> 
      </span><span class="k">ENDIF</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">IMIP</span><span class="ow">.NE.</span><span class="mf">1.</span><span class="n">AND</span><span class="ow">.NEVENT.</span><span class="n">GT</span><span class="mf">.10000</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> 
       </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">665</span><span class="p">)</span><span class="w"> </span><span class="n">NEVENT</span><span class="w">
  </span><span class="mi">665</span><span class="w">  </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' PROGRAM STOPPED NUMBER OF EVENTS ='</span><span class="p">,</span><span class="l">I7</span><span class="p">,</span><span class="s1">' LARGER THAN ARR
     /AY LIMIT OF 10000'</span><span class="p">)</span><span class="w">
       </span><span class="k">STOP</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">IMIP</span><span class="ow">.EQ.</span><span class="mf">1.</span><span class="n">AND</span><span class="ow">.NEVENT.</span><span class="n">GT</span><span class="mf">.100000</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
       </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">666</span><span class="p">)</span><span class="w"> </span><span class="n">NEVENT</span><span class="w">
  </span><span class="mi">666</span><span class="w">  </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' PROGRAM STOPPED NUMBER OF EVENTS ='</span><span class="p">,</span><span class="l">I7</span><span class="p">,</span><span class="s1">' LARGER THAN ARR
     /AY LIMIT OF 100000'</span><span class="p">)</span><span class="w">
       </span><span class="k">STOP</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">
</span><span class="n">C</span><span class="w"> 
</span><span class="n">C</span><span class="w">   </span><span class="n">GAS</span><span class="w"> </span><span class="n">IDENTIFIERS</span><span class="w"> 
</span><span class="n">C</span><span class="w">
      </span><span class="k">READ</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="n">NGASN</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NGASN</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">NGASN</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">NGASN</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">NGASN</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">NGASN</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w">
    </span><span class="mi">3</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="l">6I5</span><span class="p">)</span><span class="w">        
</span><span class="n">C</span><span class="w">      
</span><span class="n">C</span><span class="w">      </span><span class="n">GAS</span><span class="w"> </span><span class="n">PARAMETERS</span><span class="w">
</span><span class="n">C</span><span class="w">
      </span><span class="k">READ</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="n">FRAC</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">FRAC</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">FRAC</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">FRAC</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">FRAC</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">FRAC</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">TEMPC</span><span class="p">,</span><span class="w">
     </span><span class="p">/</span><span class="n">TORR</span><span class="w">                        
    </span><span class="mi">4</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="l">8F10.4</span><span class="p">)</span><span class="w">      
</span><span class="n">C</span><span class="w">                                                  
</span><span class="n">C</span><span class="w">      </span><span class="n">FIELD</span><span class="w"> </span><span class="n">VALUES</span><span class="w">                                                    
</span><span class="n">C</span><span class="w">                                                                       
      </span><span class="k">READ</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="n">EFIELD</span><span class="p">,</span><span class="n">BMAG</span><span class="p">,</span><span class="n">BTHETA</span><span class="p">,</span><span class="n">IWRITE</span><span class="p">,</span><span class="n">IPEN</span><span class="w">                         
    </span><span class="mi">5</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="l">3F10.3</span><span class="p">,</span><span class="l">2I5</span><span class="p">)</span><span class="w">
      </span><span class="k">READ</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="n">DETEFF</span><span class="p">,</span><span class="n">EXCWGHT</span><span class="p">,</span><span class="n">KGAS</span><span class="p">,</span><span class="n">LGAS</span><span class="p">,</span><span class="n">ICMP</span><span class="p">,</span><span class="n">IRAY</span><span class="p">,</span><span class="n">IPAP</span><span class="p">,</span><span class="n">IBRM</span><span class="p">,</span><span class="n">IECASC</span><span class="w"> 
    </span><span class="mi">6</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="l">2F10.3</span><span class="p">,</span><span class="l">7I5</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">656</span><span class="p">)</span><span class="w"> </span><span class="n">IWRITE</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="mi">656</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' IWRITE='</span><span class="p">,</span><span class="l">I3</span><span class="p">)</span><span class="w">  
      </span><span class="k">IF</span><span class="p">(</span><span class="n">IWRITE</span><span class="ow">.NE.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">OPEN</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">FILE</span><span class="o">=</span><span class="s1">'DEGRAD.OUT'</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">CALCULATE</span><span class="w"> </span><span class="n">EFINAL</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">DELTAS</span><span class="w"> </span><span class="n">OR</span><span class="w"> </span><span class="n">XRAYS</span><span class="w"> 
</span><span class="n">C</span><span class="w"> </span><span class="n">INCREASED</span><span class="w"> </span><span class="n">EFINAL</span><span class="w"> </span><span class="n">CAUSED</span><span class="w"> </span><span class="n">BY</span><span class="w"> </span><span class="n">ELECTRIC</span><span class="w"> </span><span class="n">FIELD</span><span class="w"> 
      </span><span class="n">EBIG</span><span class="o">=</span><span class="mf">0.05</span><span class="o">*</span><span class="n">ESTART</span><span class="p">/</span><span class="mf">1000.</span><span class="w"> 
      </span><span class="n">EFINAL</span><span class="o">=</span><span class="n">ESTART</span><span class="o">*</span><span class="mf">1.0001+760.0</span><span class="o">*</span><span class="n">EBIG</span><span class="p">/</span><span class="n">TORR</span><span class="o">*</span><span class="p">(</span><span class="n">TEMPC</span><span class="o">+</span><span class="n">ABZERO</span><span class="p">)/</span><span class="mf">293.15</span><span class="o">*</span><span class="n">EFIELD</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">EFINAL</span><span class="ow">.LT.</span><span class="p">(</span><span class="mf">1.01</span><span class="o">*</span><span class="n">ESTART</span><span class="p">))</span><span class="w"> </span><span class="n">EFINAL</span><span class="o">=</span><span class="mf">1.01</span><span class="o">*</span><span class="n">ESTART</span><span class="w"> 
</span><span class="n">C</span><span class="w">   </span><span class="n">CHECK</span><span class="w"> </span><span class="n">INPUT</span><span class="w">
      </span><span class="n">TOTFRAC</span><span class="o">=</span><span class="mf">0.0D0</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">NGAS</span><span class="ow">.EQ.</span><span class="mf">0.</span><span class="n">OR</span><span class="ow">.NGAS.</span><span class="n">GT</span><span class="mf">.6</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">999</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NGAS</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">NGASN</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="ow">.EQ.</span><span class="mf">0.</span><span class="n">OR</span><span class="err">.</span><span class="n">FRAC</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="ow">.EQ.</span><span class="mf">0.0D0</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">999</span><span class="w">
   </span><span class="mi">10</span><span class="w"> </span><span class="n">TOTFRAC</span><span class="o">=</span><span class="n">TOTFRAC</span><span class="o">+</span><span class="n">FRAC</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">DABS</span><span class="p">(</span><span class="n">TOTFRAC</span><span class="mf">-100.0D0</span><span class="p">)</span><span class="ow">.GT.</span><span class="mf">1.D-6</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">999</span><span class="w">
      </span><span class="n">LAST</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">TMAX</span><span class="o">=</span><span class="mf">100.0D0</span><span class="w">  
      </span><span class="n">NOUT</span><span class="o">=</span><span class="mi">10</span><span class="w">  
      </span><span class="n">NSTEP</span><span class="o">=</span><span class="mi">20000</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">INITIAL</span><span class="w"> </span><span class="n">ANGLES</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">NDVEC</span><span class="ow">.EQ.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
       </span><span class="n">PHI</span><span class="o">=</span><span class="mf">0.0D0</span><span class="w">                                
       </span><span class="n">THETA</span><span class="o">=</span><span class="mf">0.0D0</span><span class="w"> 
      </span><span class="k">ELSE</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="n">NDVEC</span><span class="ow">.EQ.</span><span class="p">(</span><span class="mi">-1</span><span class="p">))</span><span class="w"> </span><span class="k">THEN</span><span class="w">
       </span><span class="n">PHI</span><span class="o">=</span><span class="mf">0.0D0</span><span class="w">
       </span><span class="n">THETA</span><span class="o">=</span><span class="n">DACOS</span><span class="p">(</span><span class="mf">-1.D0</span><span class="p">)</span><span class="w">
      </span><span class="k">ELSE</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="n">NDVEC</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
       </span><span class="n">PHI</span><span class="o">=</span><span class="mf">0.0D0</span><span class="w">
       </span><span class="n">THETA</span><span class="o">=</span><span class="n">API</span><span class="p">/</span><span class="mf">2.0</span><span class="w">  
      </span><span class="k">ELSE</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="n">NDVEC</span><span class="ow">.EQ.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
       </span><span class="n">R3</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">  </span><span class="n">Self</span><span class="w"> </span><span class="n">Added</span><span class="w">
</span><span class="n">C</span><span class="w">       </span><span class="k">PRINT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RDUM</span><span class="w">
       </span><span class="n">PHI</span><span class="o">=</span><span class="n">TWOPI</span><span class="o">*</span><span class="n">R3</span><span class="w">
       </span><span class="n">R4</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
       </span><span class="n">THETA</span><span class="o">=</span><span class="n">DACOS</span><span class="p">(</span><span class="mf">1.0D0-2.0D0</span><span class="o">*</span><span class="n">R4</span><span class="p">)</span><span class="w">  
      </span><span class="k">ELSE</span><span class="w"> 
       </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">992</span><span class="p">)</span><span class="w"> </span><span class="n">NDVEC</span><span class="w">
  </span><span class="mi">992</span><span class="w">  </span><span class="k">FORMAT</span><span class="p">(</span><span class="l">/</span><span class="p">,</span><span class="l">2X</span><span class="p">,</span><span class="s1">'DIRECTION OF BEAM NOT DEFINED NDVEC ='</span><span class="p">,</span><span class="l">I5</span><span class="p">)</span><span class="w">
       </span><span class="k">STOP</span><span class="w">      
      </span><span class="k">ENDIF</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">INITIAL</span><span class="w"> </span><span class="n">DIRECTION</span><span class="w"> </span><span class="n">COSINES</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">CASCADE</span><span class="w"> </span><span class="n">CALCULATION</span><span class="w">
      </span><span class="n">DRZINIT</span><span class="o">=</span><span class="n">DCOS</span><span class="p">(</span><span class="n">THETA</span><span class="p">)</span><span class="w">
      </span><span class="n">DRXINIT</span><span class="o">=</span><span class="n">DSIN</span><span class="p">(</span><span class="n">THETA</span><span class="p">)</span><span class="o">*</span><span class="n">DCOS</span><span class="p">(</span><span class="n">PHI</span><span class="p">)</span><span class="w">
      </span><span class="n">DRYINIT</span><span class="o">=</span><span class="n">DSIN</span><span class="p">(</span><span class="n">THETA</span><span class="p">)</span><span class="o">*</span><span class="n">DSIN</span><span class="p">(</span><span class="n">PHI</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">ZERO</span><span class="w"> </span><span class="k">COMMON</span><span class="w"> </span><span class="n">BLOCKS</span><span class="w"> </span><span class="n">OF</span><span class="w"> </span><span class="n">OUTPUT</span><span class="w"> </span><span class="n">RESULTS</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">64</span><span class="w"> </span><span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">10000</span><span class="w">
      </span><span class="n">MSUM</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">MCOMP</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">MRAYL</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">MPAIR</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">MPHOT</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
   </span><span class="mi">64</span><span class="w"> </span><span class="n">MVAC</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">65</span><span class="w"> </span><span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">300</span><span class="w">                                                     
   </span><span class="mi">65</span><span class="w"> </span><span class="n">TIME</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0D0</span><span class="w">                                                     
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">70</span><span class="w"> </span><span class="n">K</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">30</span><span class="w">                                                      
   </span><span class="mi">70</span><span class="w"> </span><span class="n">ICOLL</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">  
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">80</span><span class="w"> </span><span class="n">K</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">512</span><span class="w">
   </span><span class="mi">80</span><span class="w"> </span><span class="n">ICOLN</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">                 
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">81</span><span class="w"> </span><span class="n">K</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">60</span><span class="w">
   </span><span class="mi">81</span><span class="w"> </span><span class="n">ICOLNN</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">                                       
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="n">K</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="w">                                                     
  </span><span class="mi">100</span><span class="w"> </span><span class="n">TCFMAX</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0D0</span><span class="w">   
</span><span class="n">C</span><span class="w"> </span><span class="n">ZERO</span><span class="w"> </span><span class="n">PLOT</span><span class="w"> </span><span class="n">ARRAYS</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">110</span><span class="w"> </span><span class="n">K</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">31</span><span class="w">
      </span><span class="n">NXPL2</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NYPL2</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NZPL2</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NXPL10</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NYPL10</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NZPL10</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NXPL40</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NYPL40</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NZPL40</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NXPL100</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NYPL100</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NZPL100</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NXPL400</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NYPL400</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NZPL400</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NXPL1000</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NYPL1000</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NZPL1000</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NXPL4000</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NYPL4000</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NZPL4000</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NXPL10000</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NYPL10000</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NZPL10000</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NXPL40000</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NYPL40000</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NZPL40000</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NXPL100000</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NYPL100000</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NZPL100000</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NRPL2</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NRPL10</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NRPL40</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NRPL100</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NRPL400</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NRPL1000</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NRPL4000</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NRPL10000</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NRPL40000</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
  </span><span class="mi">110</span><span class="w"> </span><span class="n">NRPL100000</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">111</span><span class="w"> </span><span class="n">K</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="w">
      </span><span class="n">NEPL1</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NEPL10</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
  </span><span class="mi">111</span><span class="w"> </span><span class="n">NEPL100</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">112</span><span class="w"> </span><span class="n">K</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="w">
      </span><span class="n">MELEC</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">MELEC3</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">MELEC10</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">MELEC30</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">MELEC100</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
  </span><span class="mi">112</span><span class="w"> </span><span class="n">MELEC300</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">ZERO</span><span class="w"> </span><span class="n">ARRAYS</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">113</span><span class="w"> </span><span class="n">KS</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">100000</span><span class="w">
      </span><span class="n">XAV</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
      </span><span class="n">YAV</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
      </span><span class="n">ZAV</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
      </span><span class="n">TAV</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
      </span><span class="n">XYAV</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
      </span><span class="n">XYZAV</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
      </span><span class="n">DX</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
      </span><span class="n">DY</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
      </span><span class="n">DZ</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
      </span><span class="n">DT</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
      </span><span class="n">DXY</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
      </span><span class="n">DXYZ</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
      </span><span class="n">FARX1</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
      </span><span class="n">FARY1</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
      </span><span class="n">FARZ1</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
      </span><span class="n">FARXY1</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
      </span><span class="n">RMAX1</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
      </span><span class="n">TSUM</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
      </span><span class="n">XNEG</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
      </span><span class="n">YNEG</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
      </span><span class="n">ZNEG</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
      </span><span class="n">EDELTA</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
      </span><span class="n">EDELTA2</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
      </span><span class="n">NCL</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NCLEXC</span><span class="p">(</span><span class="n">KS</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
  </span><span class="mi">113</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="o">----------------------------------------------------</span><span class="w">  
</span><span class="n">C</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="n">NSEED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="k">USE</span><span class="w"> </span><span class="n">STANDARD</span><span class="w"> </span><span class="n">SEED</span><span class="w"> </span><span class="n">VALUE</span><span class="w"> </span><span class="o">=</span><span class="mi">54217137</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">NSEED</span><span class="ow">.NE.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">CALL</span><span class="w"> </span><span class="n">RM48IN</span><span class="p">(</span><span class="n">NSEED</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w">                           
</span><span class="n">C</span><span class="o">-----------------------------------------------</span><span class="w">      
</span><span class="n">C</span><span class="w">
      </span><span class="n">CORR</span><span class="o">=</span><span class="n">ABZERO</span><span class="o">*</span><span class="n">TORR</span><span class="p">/(</span><span class="n">ATMOS</span><span class="o">*</span><span class="p">(</span><span class="n">ABZERO</span><span class="o">+</span><span class="n">TEMPC</span><span class="p">)</span><span class="o">*</span><span class="mf">100.0D0</span><span class="p">)</span><span class="w">                   
      </span><span class="n">AKT</span><span class="o">=</span><span class="p">(</span><span class="n">ABZERO</span><span class="o">+</span><span class="n">TEMPC</span><span class="p">)</span><span class="o">*</span><span class="n">BOLTZ</span><span class="w">
      </span><span class="n">AN1</span><span class="o">=</span><span class="n">FRAC</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span><span class="w">                                           
      </span><span class="n">AN2</span><span class="o">=</span><span class="n">FRAC</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span><span class="w">                                           
      </span><span class="n">AN3</span><span class="o">=</span><span class="n">FRAC</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span><span class="w">                                           
      </span><span class="n">AN4</span><span class="o">=</span><span class="n">FRAC</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span><span class="w">
      </span><span class="n">AN5</span><span class="o">=</span><span class="n">FRAC</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span><span class="w">
      </span><span class="n">AN6</span><span class="o">=</span><span class="n">FRAC</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span><span class="w">                                           
      </span><span class="n">AN</span><span class="o">=</span><span class="mf">100.0D0</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span><span class="w">                                            
</span><span class="n">C</span><span class="w">     </span><span class="n">VAN1</span><span class="o">=</span><span class="n">FRAC</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">CONST4</span><span class="o">*</span><span class="mf">1.0D15</span><span class="w">                                   
</span><span class="n">C</span><span class="w">     </span><span class="n">VAN2</span><span class="o">=</span><span class="n">FRAC</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">CONST4</span><span class="o">*</span><span class="mf">1.0D15</span><span class="w">                                   
</span><span class="n">C</span><span class="w">     </span><span class="n">VAN3</span><span class="o">=</span><span class="n">FRAC</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">CONST4</span><span class="o">*</span><span class="mf">1.0D15</span><span class="w">                                   
</span><span class="n">C</span><span class="w">     </span><span class="n">VAN4</span><span class="o">=</span><span class="n">FRAC</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">CONST4</span><span class="o">*</span><span class="mf">1.0D15</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="n">VAN5</span><span class="o">=</span><span class="n">FRAC</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">CONST4</span><span class="o">*</span><span class="mf">1.0D15</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="n">VAN6</span><span class="o">=</span><span class="n">FRAC</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">CONST4</span><span class="o">*</span><span class="mf">1.0D15</span><span class="w">                                   
</span><span class="n">C</span><span class="w">     </span><span class="n">VAN</span><span class="o">=</span><span class="mf">100.0D0</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">CONST4</span><span class="o">*</span><span class="mf">1.0D15</span><span class="w">
      </span><span class="n">VAN1</span><span class="o">=</span><span class="n">FRAC</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span><span class="o">*</span><span class="n">VC</span><span class="w">                                   
      </span><span class="n">VAN2</span><span class="o">=</span><span class="n">FRAC</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span><span class="o">*</span><span class="n">VC</span><span class="w">                                   
      </span><span class="n">VAN3</span><span class="o">=</span><span class="n">FRAC</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span><span class="o">*</span><span class="n">VC</span><span class="w">                                  
      </span><span class="n">VAN4</span><span class="o">=</span><span class="n">FRAC</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span><span class="o">*</span><span class="n">VC</span><span class="w">
      </span><span class="n">VAN5</span><span class="o">=</span><span class="n">FRAC</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span><span class="o">*</span><span class="n">VC</span><span class="w">
      </span><span class="n">VAN6</span><span class="o">=</span><span class="n">FRAC</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span><span class="o">*</span><span class="n">VC</span><span class="w">                                  
      </span><span class="n">VAN</span><span class="o">=</span><span class="mf">100.0D0</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span><span class="o">*</span><span class="n">VC</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">CALCULATE</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">STORE</span><span class="w"> </span><span class="n">ENERGY</span><span class="w"> </span><span class="n">GRID</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">XRAYS</span><span class="w"> </span><span class="n">BETAS</span><span class="w"> </span><span class="n">OR</span><span class="w"> </span><span class="n">PARTICLES</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">EFINAL</span><span class="ow">.LE.</span><span class="mf">20000.0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
       </span><span class="n">ESTEP</span><span class="o">=</span><span class="n">EFINAL</span><span class="p">/</span><span class="n">DFLOAT</span><span class="p">(</span><span class="n">NSTEP</span><span class="p">)</span><span class="w">
       </span><span class="n">EHALF</span><span class="o">=</span><span class="n">ESTEP</span><span class="p">/</span><span class="mf">2.0D0</span><span class="w">
       </span><span class="n">E</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">EHALF</span><span class="w">
       </span><span class="n">GAM</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">EMS</span><span class="o">+</span><span class="n">E</span><span class="p">(</span><span class="mi">1</span><span class="p">))/</span><span class="n">EMS</span><span class="w">
       </span><span class="n">BET</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">DSQRT</span><span class="p">(</span><span class="mf">1.0D0-1.0D0</span><span class="p">/(</span><span class="n">GAM</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">GAM</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span><span class="w">
       </span><span class="k">DO</span><span class="w"> </span><span class="mi">203</span><span class="w"> </span><span class="n">I</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="mi">20000</span><span class="w">
       </span><span class="n">AJ</span><span class="o">=</span><span class="n">DFLOAT</span><span class="p">(</span><span class="n">I</span><span class="mi">-1</span><span class="p">)</span><span class="w">
       </span><span class="n">E</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="n">EHALF</span><span class="o">+</span><span class="n">ESTEP</span><span class="o">*</span><span class="n">AJ</span><span class="w">
       </span><span class="n">GAM</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">EMS</span><span class="o">+</span><span class="n">E</span><span class="p">(</span><span class="n">I</span><span class="p">))/</span><span class="n">EMS</span><span class="w">
  </span><span class="mi">203</span><span class="w">  </span><span class="n">BET</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="n">DSQRT</span><span class="p">(</span><span class="mf">1.0D0-1.0D0</span><span class="p">/(</span><span class="n">GAM</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">GAM</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span><span class="w">
      </span><span class="k">ELSE</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="n">EFINAL</span><span class="ow">.GT.</span><span class="mf">20000.0</span><span class="ow">.AND.</span><span class="n">EFINAL</span><span class="ow">.LE.</span><span class="mf">140000.</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
       </span><span class="n">ESTEP</span><span class="o">=</span><span class="mf">1.0</span><span class="w">
       </span><span class="n">EHALF</span><span class="o">=</span><span class="mf">0.5</span><span class="w">
       </span><span class="n">E</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">EHALF</span><span class="w">
       </span><span class="n">GAM</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">EMS</span><span class="o">+</span><span class="n">E</span><span class="p">(</span><span class="mi">1</span><span class="p">))/</span><span class="n">EMS</span><span class="w">
       </span><span class="n">BET</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">DSQRT</span><span class="p">(</span><span class="mf">1.0D0-1.0D0</span><span class="p">/(</span><span class="n">GAM</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">GAM</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span><span class="w">
       </span><span class="k">DO</span><span class="w"> </span><span class="mi">231</span><span class="w"> </span><span class="n">I</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="mi">16000</span><span class="w">
       </span><span class="n">AJ</span><span class="o">=</span><span class="n">DFLOAT</span><span class="p">(</span><span class="n">I</span><span class="mi">-1</span><span class="p">)</span><span class="w">
       </span><span class="n">E</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="n">EHALF</span><span class="o">+</span><span class="n">ESTEP</span><span class="o">*</span><span class="n">AJ</span><span class="w">
       </span><span class="n">GAM</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">EMS</span><span class="o">+</span><span class="n">E</span><span class="p">(</span><span class="n">I</span><span class="p">))/</span><span class="n">EMS</span><span class="w">
  </span><span class="mi">231</span><span class="w">  </span><span class="n">BET</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="n">DSQRT</span><span class="p">(</span><span class="mf">1.0D0-1.0D0</span><span class="p">/(</span><span class="n">GAM</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">GAM</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span><span class="w">
       </span><span class="n">ESTEP1</span><span class="o">=</span><span class="p">(</span><span class="n">EFINAL</span><span class="mf">-16000.0</span><span class="p">)/</span><span class="n">DFLOAT</span><span class="p">(</span><span class="mi">4000</span><span class="p">)</span><span class="w">
       </span><span class="k">DO</span><span class="w"> </span><span class="mi">232</span><span class="w"> </span><span class="n">I</span><span class="o">=</span><span class="mi">16001</span><span class="p">,</span><span class="mi">20000</span><span class="w">
       </span><span class="n">AJ</span><span class="o">=</span><span class="n">DFLOAT</span><span class="p">(</span><span class="n">I</span><span class="mi">-16000</span><span class="p">)</span><span class="w">
       </span><span class="n">E</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="mf">16000.0</span><span class="o">+</span><span class="n">AJ</span><span class="o">*</span><span class="n">ESTEP1</span><span class="w">
       </span><span class="n">GAM</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">EMS</span><span class="o">+</span><span class="n">E</span><span class="p">(</span><span class="n">I</span><span class="p">))/</span><span class="n">EMS</span><span class="w">
  </span><span class="mi">232</span><span class="w">  </span><span class="n">BET</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="n">DSQRT</span><span class="p">(</span><span class="mf">1.0D0-1.0D0</span><span class="p">/(</span><span class="n">GAM</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">GAM</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span><span class="w">
      </span><span class="k">ELSE</span><span class="w">
       </span><span class="n">ESTEP</span><span class="o">=</span><span class="mf">1.0</span><span class="w">
       </span><span class="n">EHALF</span><span class="o">=</span><span class="mf">0.5</span><span class="w">
       </span><span class="n">E</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">EHALF</span><span class="w">
       </span><span class="n">GAM</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">EMS</span><span class="o">+</span><span class="n">E</span><span class="p">(</span><span class="mi">1</span><span class="p">))/</span><span class="n">EMS</span><span class="w">
       </span><span class="n">BET</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">DSQRT</span><span class="p">(</span><span class="mf">1.0D0-1.0D0</span><span class="p">/(</span><span class="n">GAM</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">GAM</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span><span class="w">
       </span><span class="k">DO</span><span class="w"> </span><span class="mi">233</span><span class="w"> </span><span class="n">I</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="mi">12000</span><span class="w">
       </span><span class="n">AJ</span><span class="o">=</span><span class="n">DFLOAT</span><span class="p">(</span><span class="n">I</span><span class="mi">-1</span><span class="p">)</span><span class="w">
       </span><span class="n">E</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="n">EHALF</span><span class="o">+</span><span class="n">ESTEP</span><span class="o">*</span><span class="n">AJ</span><span class="w">
       </span><span class="n">GAM</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">EMS</span><span class="o">+</span><span class="n">E</span><span class="p">(</span><span class="n">I</span><span class="p">))/</span><span class="n">EMS</span><span class="w">
  </span><span class="mi">233</span><span class="w">  </span><span class="n">BET</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="n">DSQRT</span><span class="p">(</span><span class="mf">1.0D0-1.0D0</span><span class="p">/(</span><span class="n">GAM</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">GAM</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span><span class="w">
       </span><span class="n">ESTEP1</span><span class="o">=</span><span class="mf">20.0</span><span class="w">
       </span><span class="k">DO</span><span class="w"> </span><span class="mi">234</span><span class="w"> </span><span class="n">I</span><span class="o">=</span><span class="mi">12001</span><span class="p">,</span><span class="mi">16000</span><span class="w">
       </span><span class="n">AJ</span><span class="o">=</span><span class="n">DFLOAT</span><span class="p">(</span><span class="n">I</span><span class="mi">-12000</span><span class="p">)</span><span class="w">
       </span><span class="n">E</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="mf">12000.0</span><span class="o">+</span><span class="n">AJ</span><span class="o">*</span><span class="n">ESTEP1</span><span class="w">
       </span><span class="n">GAM</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">EMS</span><span class="o">+</span><span class="n">E</span><span class="p">(</span><span class="n">I</span><span class="p">))/</span><span class="n">EMS</span><span class="w">
  </span><span class="mi">234</span><span class="w">  </span><span class="n">BET</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="n">DSQRT</span><span class="p">(</span><span class="mf">1.0D0-1.0D0</span><span class="p">/(</span><span class="n">GAM</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">GAM</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span><span class="w">
       </span><span class="n">ESTEP2</span><span class="o">=</span><span class="p">(</span><span class="n">EFINAL</span><span class="mf">-92000.0</span><span class="p">)/</span><span class="n">DFLOAT</span><span class="p">(</span><span class="mi">4000</span><span class="p">)</span><span class="w">
       </span><span class="k">DO</span><span class="w"> </span><span class="mi">235</span><span class="w"> </span><span class="n">I</span><span class="o">=</span><span class="mi">16001</span><span class="p">,</span><span class="mi">20000</span><span class="w">
       </span><span class="n">AJ</span><span class="o">=</span><span class="n">DFLOAT</span><span class="p">(</span><span class="n">I</span><span class="mi">-16000</span><span class="p">)</span><span class="w">
       </span><span class="n">E</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="mf">92000.0</span><span class="o">+</span><span class="n">AJ</span><span class="o">*</span><span class="n">ESTEP2</span><span class="w">
       </span><span class="n">GAM</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">EMS</span><span class="o">+</span><span class="n">E</span><span class="p">(</span><span class="n">I</span><span class="p">))/</span><span class="n">EMS</span><span class="w">
  </span><span class="mi">235</span><span class="w">  </span><span class="n">BET</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="n">DSQRT</span><span class="p">(</span><span class="mf">1.0D0-1.0D0</span><span class="p">/(</span><span class="n">GAM</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">GAM</span><span class="p">(</span><span class="n">I</span><span class="p">)))</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">
</span><span class="n">C</span><span class="w">  </span><span class="n">RADIANS</span><span class="w"> </span><span class="n">PER</span><span class="w"> </span><span class="n">PICOSECOND</span><span class="w">                                        
      </span><span class="n">WB</span><span class="o">=</span><span class="n">AWB</span><span class="o">*</span><span class="n">BMAG</span><span class="o">*</span><span class="mf">1.0D-12</span><span class="w"> 
</span><span class="n">C</span><span class="w">   </span><span class="n">METRES</span><span class="w"> </span><span class="n">PER</span><span class="w"> </span><span class="n">PICOSECOND</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">BMAG</span><span class="ow">.EQ.</span><span class="mf">0.0D0</span><span class="p">)</span><span class="w"> </span><span class="k">RETURN</span><span class="w">
      </span><span class="n">EOVB</span><span class="o">=</span><span class="n">EFIELD</span><span class="o">*</span><span class="mf">1.D-9</span><span class="p">/</span><span class="n">BMAG</span><span class="w">
      </span><span class="k">RETURN</span><span class="w">
  </span><span class="mi">999</span><span class="w"> </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">87</span><span class="p">)</span><span class="w"> </span><span class="n">NGAS</span><span class="p">,(</span><span class="n">J</span><span class="p">,</span><span class="n">NGASN</span><span class="p">(</span><span class="n">J</span><span class="p">),</span><span class="n">FRAC</span><span class="p">(</span><span class="n">J</span><span class="p">),</span><span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="w"> 
   </span><span class="mi">87</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="l">3</span><span class="p">(</span><span class="l">/</span><span class="p">),</span><span class="l">4X</span><span class="p">,</span><span class="s1">' ERROR IN GAS INPUT : NGAS='</span><span class="p">,</span><span class="l">I5</span><span class="p">,</span><span class="l">6</span><span class="p">(</span><span class="l">/</span><span class="p">,</span><span class="l">2X</span><span class="p">,</span><span class="s1">' N='</span><span class="p">,</span><span class="l">I3</span><span class="p">,</span><span class="s1">' 
     /NGAS='</span><span class="p">,</span><span class="l">I5</span><span class="p">,</span><span class="s1">' FRAC='</span><span class="p">,</span><span class="l">F8.3</span><span class="p">))</span><span class="w">                                         
   </span><span class="mi">99</span><span class="w"> </span><span class="n">LAST</span><span class="o">=</span><span class="mi">1</span><span class="w">                                                            
      </span><span class="k">RETURN</span><span class="w">                                                            
      </span><span class="k">END</span><span class="w"> 
</span></code></pre><pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">SETUP</span><span class="p">(</span><span class="n">LAST</span><span class="p">):</span>
    <span class="c">#IMPLICIT #real*8 (A-H,O-Z) </span>
    <span class="c">#IMPLICIT #integer*8 (I-N) </span>
    <span class="c">#integer*4 NSEED                                       </span>
    <span class="k">global</span> <span class="n">NGAS</span><span class="p">,</span><span class="n">NSTEP</span><span class="p">,</span><span class="n">NANISO</span><span class="p">,</span><span class="n">EFINAL</span><span class="p">,</span><span class="n">ESTEP</span><span class="p">,</span><span class="n">AKT</span><span class="p">,</span><span class="n">ARY</span><span class="p">,</span><span class="n">TEMPC</span><span class="p">,</span><span class="n">TORR</span><span class="p">,</span><span class="n">IPEN</span>
    <span class="k">global</span> <span class="n">ECHARG</span><span class="p">,</span><span class="n">EMASS</span><span class="p">,</span><span class="n">AMU</span><span class="p">,</span><span class="n">PIR2</span>
    <span class="k">global</span> <span class="n">KGAS</span><span class="p">,</span><span class="n">LGAS</span><span class="p">,</span><span class="n">DETEFF</span><span class="p">,</span><span class="n">EXCWGHT</span>
    <span class="k">global</span> <span class="n">NDVEC</span><span class="p">,</span><span class="n">CONST1</span><span class="p">,</span><span class="n">CONST2</span><span class="p">,</span><span class="n">CONST3</span><span class="p">,</span><span class="n">CONST4</span><span class="p">,</span><span class="n">CONST5</span>                  
    <span class="k">global</span> <span class="n">AN1</span><span class="p">,</span><span class="n">AN2</span><span class="p">,</span><span class="n">AN3</span><span class="p">,</span><span class="n">AN4</span><span class="p">,</span><span class="n">AN5</span><span class="p">,</span><span class="n">AN6</span><span class="p">,</span><span class="n">AN</span><span class="p">,</span><span class="n">FRAC</span> <span class="c">#=[0 for x in range[6]]               </span>
    <span class="k">global</span> <span class="n">NGASN</span> <span class="c">#=[0 for x in range[6]]                                 </span>
    <span class="k">global</span> <span class="n">TMAX</span><span class="p">,</span><span class="n">SMALL</span><span class="p">,</span><span class="n">API</span><span class="p">,</span><span class="n">ESTART</span><span class="p">,</span><span class="n">THETA</span><span class="p">,</span><span class="n">PHI</span><span class="p">,</span><span class="n">TCFMAX</span> <span class="c">#=[0 for x in range(10)]</span>
    <span class="k">global</span> <span class="n">TCFMAX1</span><span class="p">,</span><span class="n">RSTART</span><span class="p">,</span><span class="n">EFIELD</span><span class="p">,</span><span class="n">ETHRM</span><span class="p">,</span><span class="n">ECUT</span><span class="p">,</span><span class="n">NEVENT</span><span class="p">,</span><span class="n">IMIP</span><span class="p">,</span><span class="n">IWRITE</span>
    <span class="k">global</span> <span class="n">DRXINIT</span><span class="p">,</span><span class="n">DRYINIT</span><span class="p">,</span><span class="n">DRZINIT</span>
    <span class="k">global</span> <span class="n">EOVB</span><span class="p">,</span><span class="n">WB</span><span class="p">,</span><span class="n">BTHETA</span><span class="p">,</span><span class="n">BMAG</span> 
    <span class="k">global</span> <span class="n">DOUBLE</span> <span class="c">#=[[0 for x in range[6]] for y in range(20000)]</span>
    <span class="k">global</span> <span class="n">AVPFRAC</span> <span class="c">#=[[0 for x in range(3)] for y in range(6)]</span>
    <span class="k">global</span> <span class="n">CMINIXSC</span> <span class="c">#=[0 for x in range[6]]</span>
    <span class="k">global</span> <span class="n">CMINEXSC</span> <span class="c">#=[0 for x in range[6]]</span>
    <span class="k">global</span> <span class="n">ECLOSS</span> <span class="c">#=[0 for x in range[6]]</span>
    <span class="k">global</span> <span class="n">WPLN</span> <span class="c">#=[0 for x in range[6]]</span>
    <span class="k">global</span> <span class="n">ICOUNT</span>
    <span class="k">global</span> <span class="n">OVAN1</span><span class="p">,</span><span class="n">VAN2</span><span class="p">,</span><span class="n">VAN3</span><span class="p">,</span><span class="n">VAN4</span><span class="p">,</span><span class="n">VAN5</span><span class="p">,</span><span class="n">VAN6</span><span class="p">,</span><span class="n">VAN</span>
    <span class="k">global</span> <span class="n">ICOLL</span><span class="c">#=[0 for x in range(30)]</span>
    <span class="k">global</span> <span class="n">NETOT</span><span class="p">,</span><span class="n">NPRIME</span><span class="p">,</span><span class="n">TMAX1</span>
    <span class="k">global</span> <span class="n">TIME</span> <span class="c">#=[0 for x in range(300)]</span>
    <span class="k">global</span> <span class="n">NNULL</span><span class="p">,</span><span class="n">NITOT</span>
    <span class="k">global</span> <span class="n">ICOLN</span> <span class="c">#=[0 for x i range(512)]</span>
    <span class="k">global</span> <span class="n">ICOLNN</span><span class="c">#=[0 for x in range(60)]</span>
    <span class="k">global</span> <span class="n">NREAL</span><span class="p">,</span><span class="n">NEXCTOT</span>
    <span class="k">global</span> <span class="n">MSUM</span><span class="c">#=[0 for x in range(10000)]</span>
    <span class="k">global</span> <span class="n">MCOMP</span><span class="c">#=[0 for x in range(10000)]</span>
    <span class="k">global</span> <span class="n">MRAYL</span><span class="c">#=[0 for x in range(10000)]</span>
    <span class="k">global</span> <span class="n">MPAIR</span><span class="c">#=[0 for x in range(10000)]</span>
    <span class="k">global</span> <span class="n">MPHOT</span><span class="c">#=[0 for x in range(10000)]</span>
    <span class="k">global</span> <span class="n">MVAC</span><span class="c">#=[0 for x in range(10000)]</span>
    <span class="k">global</span> <span class="n">BET</span><span class="c">#=[0 for x in range(2000)]</span>
    <span class="k">global</span> <span class="n">GAM</span><span class="c">#=[0 for x in range(20000)]</span>
    <span class="k">global</span> <span class="n">VC</span><span class="p">,</span><span class="n">EMS</span> 
    <span class="k">global</span> <span class="n">ICMP</span><span class="p">,</span><span class="n">ICFLG</span><span class="p">,</span><span class="n">IRAY</span><span class="p">,</span><span class="n">IRFLG</span><span class="p">,</span><span class="n">IPAP</span><span class="p">,</span><span class="n">IPFLG</span><span class="p">,</span><span class="n">IBRM</span><span class="p">,</span><span class="n">IBFLG</span><span class="p">,</span><span class="n">LPEFLG</span> 
    <span class="k">global</span> <span class="n">E</span> <span class="c">#=[0 for x in range(20000)]</span>
    <span class="k">global</span> <span class="n">EROOT</span> <span class="c">#=[0 for x in range(20000)]</span>
    <span class="k">global</span> <span class="n">QTOT</span> <span class="c">#=[0 for x in range(20000)]</span>
    <span class="k">global</span> <span class="n">QREL</span> <span class="c">#=[0 for x in range(20000)]</span>
    <span class="k">global</span> <span class="n">QINEL</span> <span class="c">#=[0 for x in range(20000)]</span>
    <span class="k">global</span> <span class="n">QEL</span> <span class="c">#=[0 for x in range(20000)]</span>
    <span class="k">global</span> <span class="n">NXPL10</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NYPL10</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NZPL10</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NXPL40</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NYPL40</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NZPL40</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NXPL100</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NYPL100</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NZPL100</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NXPL400</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NYPL400</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NZPL400</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NXPL1000</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NYPL1000</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NZPL1000</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NXPL2</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NYPL2</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NZPL2</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NXPL4000</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NYPL4000</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NZPL4000</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NXPL10000</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NYPL10000</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NZPL10000</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NXPL40000</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NYPL40000</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NZPL40000</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NXPL100000</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NYPL100000</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NZPL100000</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NRPL2</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NRPL10</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NRPL40</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NRPL100</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NRPL400</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NRPL1000</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NRPL4000</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NRPL10000</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NRPL40000</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NRPL100000</span><span class="c">#=[0 for x in range(31)]</span>
    <span class="k">global</span> <span class="n">NEPL1</span><span class="c">#=[0 for x in range(100)]</span>
    <span class="k">global</span> <span class="n">NEPL10</span><span class="c">#=[0 for x in range(100)]</span>
    <span class="k">global</span> <span class="n">NEPL100</span><span class="c">#=[0 for x in range(100)]</span>
    <span class="k">global</span> <span class="n">MELEC</span><span class="c">#=[0 for x in range(1000)]</span>
    <span class="k">global</span> <span class="n">MELEC3</span><span class="c">#=[0 for x in range(1000)]</span>
    <span class="k">global</span> <span class="n">MELEC10</span><span class="c">#=[0 for x in range(1000)]</span>
    <span class="k">global</span> <span class="n">MELEC30</span><span class="c">#=[0 for x in range(1000)]</span>
    <span class="k">global</span> <span class="n">MELEC100</span><span class="c">#=[0 for x in range(1000)]</span>
    <span class="k">global</span> <span class="n">MELEC300</span><span class="c">#=[0 for x in range(1000)]</span>
    <span class="k">global</span> <span class="n">EBRGAM</span><span class="c">#=[0 for x in range(10)]</span>
    <span class="k">global</span> <span class="n">BRDCOSX</span><span class="c"># =[0 for x in range(10)]</span>
    <span class="k">global</span> <span class="n">BRDCOSY</span><span class="c"># =[0 for x in range(10)]</span>
    <span class="k">global</span> <span class="n">BRDCOSZ</span><span class="c"># =[0 for x in range(10)]</span>
    <span class="k">global</span> <span class="n">BRX</span><span class="c">#=[0 for x in range(10)]</span>
    <span class="k">global</span> <span class="n">BRY</span><span class="c">#=[0 for x in range(10)]</span>
    <span class="k">global</span> <span class="n">BRZ</span><span class="c">#=[0 for x in range(10)]</span>
    <span class="k">global</span> <span class="n">BRT</span><span class="c">#=[0 for x in range(10)]</span>
    <span class="k">global</span> <span class="n">EBRTOT</span><span class="c">#=[0 for x in range[6]]</span>
    <span class="k">global</span> <span class="n">NBREM</span><span class="c">#=[0 for x in range[6]]</span>
    <span class="k">global</span> <span class="n">XAV</span><span class="c">#=[0 for x in range(100000)]</span>
    <span class="k">global</span> <span class="n">YAV</span><span class="c">#=[0 for x in range(100000)]</span>
    <span class="k">global</span> <span class="n">ZAV</span><span class="c">#=[0 for x in range(100000)]</span>
    <span class="k">global</span> <span class="n">TAV</span><span class="c">#=[0 for x in range(100000)]</span>
    <span class="k">global</span> <span class="n">XYAV</span><span class="c">#=[0 for x in range(100000)]</span>
    <span class="k">global</span> <span class="n">XYZAV</span><span class="c">#=[0 for x in range(100000)]</span>
    <span class="k">global</span> <span class="n">DX</span><span class="c">#=[0 for x in range(100000)]</span>
    <span class="k">global</span> <span class="n">DY</span><span class="c">#=[0 for x in range(100000)] </span>
    <span class="k">global</span> <span class="n">DZ</span><span class="c">#=[0 for x in range(100000)]</span>
    <span class="k">global</span> <span class="n">DT</span><span class="c">#=[0 for x in range(100000)]</span>
    <span class="k">global</span> <span class="n">DXY</span><span class="c">#=[0 for x in range(100000)]</span>
    <span class="k">global</span> <span class="n">DXYZ</span><span class="c">#=[0 for x in range(100000)]</span>
    <span class="k">global</span> <span class="n">NCL</span><span class="c">#=[0 for x in range(100000)]</span>
    <span class="k">global</span> <span class="n">FARX1</span><span class="c">#=[0 for x in range(100000)]</span>
    <span class="k">global</span> <span class="n">FARY1</span><span class="c">#=[0 for x in range(100000)]</span>
    <span class="k">global</span> <span class="n">FARZ1</span><span class="c">#=[0 for x in range(100000)]</span>
    <span class="k">global</span> <span class="n">FARXY1</span><span class="c">#=[0 for x in range(100000)]</span>
    <span class="k">global</span> <span class="n">RMAX1</span><span class="c">#=[0 for x in range(100000)]</span>
    <span class="k">global</span> <span class="n">TSUM</span><span class="c">#=[0 for x in range(100000)]</span>
    <span class="k">global</span> <span class="n">XNEG</span><span class="c">#=[0 for x in range(100000)]</span>
    <span class="k">global</span> <span class="n">YNEG</span><span class="c">#=[0 for x in range(100000)]</span>
    <span class="k">global</span> <span class="n">ZNEG</span><span class="c">#=[0 for x in range(100000)]</span>
    <span class="k">global</span> <span class="n">EDELTA</span><span class="c">#[100000]</span>
    <span class="k">global</span> <span class="n">EDELTA2</span><span class="c">#=[0 for x in range(100000)]</span>
    <span class="k">global</span> <span class="n">NCLEXC</span><span class="c">#=[0 for x in range(100000)]</span>
    <span class="k">global</span> <span class="n">NSEED</span>
    <span class="k">global</span> <span class="n">NEGAS</span><span class="c">#=[0 for x in range(512)]</span>
    <span class="k">global</span> <span class="n">LEGAS</span><span class="c">#=[0 for x in range(512)]</span>
    <span class="k">global</span> <span class="n">IESHELL</span><span class="c">#=[0 for x in range(512)]</span>
    <span class="k">global</span> <span class="n">IECASC</span>
    <span class="c">#                                                                       </span>
    <span class="c">#   NEW UPDATE OF CONSTANTS 2010</span>
    <span class="c">#</span>
    <span class="n">API</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="o">-</span><span class="mf">1.00</span><span class="p">)</span>                                                 
    <span class="n">ARY</span><span class="o">=</span><span class="mf">13.605692530</span>                                              
    <span class="n">PIR2</span><span class="o">=</span><span class="mf">8.7973554297</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">ECHARG</span><span class="o">=</span><span class="mf">1.602176565</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="mi">19</span><span class="p">)</span>                                         
    <span class="n">EMASS</span><span class="o">=</span><span class="mf">9.10938291</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="mi">31</span><span class="p">)</span>                     
    <span class="n">EMS</span><span class="o">=</span><span class="mf">510998.9280</span>
    <span class="n">VC</span><span class="o">=</span><span class="mf">299792458.00</span>                       
    <span class="n">AMU</span><span class="o">=</span><span class="mf">1.660538921</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="mi">27</span><span class="p">)</span>                                             
    <span class="n">BOLTZ</span><span class="o">=</span><span class="mf">8.6173324</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="mi">5</span><span class="p">)</span>    
    <span class="n">BOLTZJ</span><span class="o">=</span><span class="mf">1.3806488</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="mi">23</span><span class="p">)</span>                                              
    <span class="n">AWB</span><span class="o">=</span><span class="mf">1.758820088</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="p">)</span>                                             
    <span class="n">ALOSCH</span><span class="o">=</span><span class="mf">2.6867805</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">19</span><span class="p">)</span>     
    <span class="n">RE</span><span class="o">=</span><span class="mf">2.8179403267</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="mi">13</span><span class="p">)</span>    
    <span class="n">ALPH</span><span class="o">=</span><span class="mf">137.035999074</span>
    <span class="n">HBAR</span><span class="o">=</span><span class="mf">6.58211928</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="mi">16</span><span class="p">)</span>                                     
    <span class="n">EOVM</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.00</span><span class="o">*</span><span class="n">ECHARG</span><span class="o">/</span><span class="n">EMASS</span><span class="p">)</span><span class="o">*</span><span class="mf">100.00</span>                            
    <span class="n">ABZERO</span><span class="o">=</span><span class="mf">273.150</span>                                                   
    <span class="n">ATMOS</span><span class="o">=</span><span class="mf">760.00</span>                                                     
    <span class="n">CONST1</span><span class="o">=</span><span class="n">AWB</span><span class="o">/</span><span class="mf">2.00</span><span class="o">*</span><span class="mf">1.0</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="mi">19</span><span class="p">)</span>                                          
    <span class="n">CONST2</span><span class="o">=</span><span class="n">CONST1</span><span class="o">*</span><span class="mf">1.0</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="mo">02</span><span class="p">)</span>                                             
    <span class="n">CONST3</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.20</span><span class="o">*</span><span class="n">AWB</span><span class="p">)</span><span class="o">*</span><span class="mf">1.0</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="mi">9</span><span class="p">)</span>                                   
    <span class="n">CONST4</span><span class="o">=</span><span class="n">CONST3</span><span class="o">*</span><span class="n">ALOSCH</span><span class="o">*</span><span class="mf">1.0</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="mi">15</span><span class="p">)</span>                                      
    <span class="n">CONST5</span><span class="o">=</span><span class="n">CONST3</span><span class="o">/</span><span class="mf">2.00</span>
    <span class="n">TWOPI</span><span class="o">=</span><span class="mf">2.00</span><span class="o">*</span><span class="n">API</span>
    <span class="n">NANISO</span><span class="o">=</span><span class="mi">2</span>
    <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
        <span class="n">NBREM</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">EBRTOT</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
    <span class="n">ICFLG</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">IRFLG</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">IPFLG</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">IBFLG</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">LPEFLG</span><span class="o">=</span><span class="mi">0</span>
    <span class="c">#  --------------------------------------------       </span>
    <span class="c">#                                                                       </span>
    <span class="c">#      READ IN OUTPUT CONTROL AND INTEGRATION DATA                      </span>
    <span class="c">#                                                                       </span>
    <span class="n">NGAS</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>
    <span class="n">NEVENT</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>
    <span class="n">IMIP</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>
    <span class="n">NDVEC</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>
    <span class="n">NSEED</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>
    <span class="n">ESTART</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>
    <span class="n">ETHRM</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>
    <span class="n">ECUT</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>
    <span class="n">ICOUNT</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">if</span><span class="p">(</span><span class="n">IMIP</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">ICOUNT</span><span class="o">=</span><span class="mi">1</span> 
    <span class="k">if</span><span class="p">(</span><span class="n">NGAS</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>  <span class="c">#yet to figure out </span>
        <span class="n">LAST</span><span class="o">=</span><span class="mi">1</span>
        <span class="k">return</span>  
    <span class="k">if</span><span class="p">(</span><span class="n">ESTART</span> <span class="o">&gt;</span> <span class="mf">3.0</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="ow">and</span> <span class="n">IMIP</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">' SUBROUTINE STOPPED: X-RAY ENERGY='</span><span class="p">,</span><span class="s">'</span><span class="si">%.3</span><span class="s">f'</span> <span class="o">%</span> <span class="n">ESTART</span><span class="p">,</span><span class="s">'EV. MAXIMUM ENERGY 3.0MEV'</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">()</span> 
    <span class="c"># endif</span>
    <span class="k">if</span><span class="p">(</span><span class="n">IMIP</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">NEVENT</span> <span class="o">&gt;</span> <span class="mi">10000</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">' SUBROUTINE STOPPED: NUMBER OF EVENTS ='</span><span class="p">,</span><span class="n">NEVENT</span><span class="p">,</span><span class="s">' LARGER THAN ARRAY LIMIT OF 10000'</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">()</span>
    <span class="c"># endif</span>
    <span class="k">if</span><span class="p">(</span><span class="n">IMIP</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">NEVENT</span> <span class="o">&gt;</span> <span class="mi">100000</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">' SUBROUTINE STOPPED: NUMBER OF EVENTS ='</span><span class="p">,</span><span class="n">NEVENT</span><span class="p">,</span><span class="s">' LARGER THAN ARRAY LIMIT OF 100000'</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">()</span>
    <span class="c"># endif</span>
    <span class="c"># </span>
    <span class="c">#   GAS IDENTifIERS </span>
    <span class="c">#</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
        <span class="n">NGASN</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>
    <span class="c">#      </span>
    <span class="c">#      GAS PARAMETERS</span>
    <span class="c">#</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
        <span class="n">FRAC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">()),</span><span class="mi">4</span><span class="p">)</span>             <span class="c">#print(8'%.4f' %)      </span>
    <span class="n">TEMPC</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">()),</span><span class="mi">4</span><span class="p">)</span>                   <span class="c">#print(8'%.4f' %)      </span>
    <span class="n">TORR</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">()),</span><span class="mi">4</span><span class="p">)</span>                    <span class="c">#print(8'%.4f' %)      </span>


    <span class="c">#print(8'%.4f' %)      </span>
    <span class="c">#                                                  </span>
    <span class="c">#      FIELD VALUES                                                    </span>
    <span class="c">#                                                                       </span>
    <span class="n">EFIELD</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">()),</span><span class="mi">3</span><span class="p">)</span>              <span class="c">#print(3'%.3f' % ,2I5)</span>
    <span class="n">BMAG</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">()),</span><span class="mi">3</span><span class="p">)</span>            <span class="c">#print(3'%.3f' % ,2I5)</span>
    <span class="n">BTHETA</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">()),</span><span class="mi">3</span><span class="p">)</span>          <span class="c">#print(3'%.3f' % ,2I5)</span>
    <span class="n">IWRITE</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>         <span class="c">#print(3'%.3f' % ,2I5)</span>
    <span class="n">IPEN</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>                               <span class="c">#print(3'%.3f' % ,2I5)     </span>

    <span class="n">DETEFF</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">()),</span><span class="mi">3</span><span class="p">)</span>          <span class="c"># print(2'%.3f' % ,7I5)</span>
    <span class="n">EXCWGHT</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">()),</span><span class="mi">3</span><span class="p">)</span>         <span class="c"># print(2'%.3f' % ,7I5)         </span>
    <span class="n">KGAS</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>                       <span class="c"># print(2'%.3f' % ,7I5)</span>
    <span class="n">LGAS</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>                       <span class="c"># print(2'%.3f' % ,7I5)</span>
    <span class="n">ICMP</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>                       <span class="c"># print(2'%.3f' % ,7I5)</span>
    <span class="n">IRAY</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>                       <span class="c"># print(2'%.3f' % ,7I5)</span>
    <span class="n">IPAP</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>                       <span class="c"># print(2'%.3f' % ,7I5)</span>
    <span class="n">IBRM</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>                       <span class="c"># print(2'%.3f' % ,7I5)</span>
    <span class="n">IECASC</span> <span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>                    <span class="c"># print(2'%.3f' % ,7I5)</span>
    <span class="c">#     WRITE(6,656) IWRITE</span>
    <span class="c"># 656 print(' IWRITE=',I3)  </span>
    <span class="k">if</span><span class="p">(</span><span class="n">IWRITE</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">OPEN</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">FILE</span><span class="o">=</span><span class="s">'DEGRAD.OUT'</span><span class="p">)</span>  <span class="c">#yet to be</span>
    <span class="c"># CALCULATE EFINAL FOR DELTAS OR XRAYS </span>
    <span class="c"># INCREASED EFINAL CAUSED BY ELECTRIC FIELD </span>
    <span class="n">EBIG</span><span class="o">=</span><span class="mf">0.05</span><span class="o">*</span><span class="n">ESTART</span><span class="o">/</span><span class="mf">1000.</span> 
    <span class="n">EFINAL</span><span class="o">=</span><span class="n">ESTART</span><span class="o">*</span><span class="mf">1.0001</span><span class="o">+</span><span class="mf">760.0</span><span class="o">*</span><span class="n">EBIG</span><span class="o">/</span><span class="n">TORR</span><span class="o">*</span><span class="p">(</span><span class="n">TEMPC</span><span class="o">+</span><span class="n">ABZERO</span><span class="p">)</span><span class="o">/</span><span class="mf">293.15</span><span class="o">*</span><span class="n">EFIELD</span>
    <span class="k">if</span><span class="p">(</span><span class="n">EFINAL</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mf">1.01</span><span class="o">*</span><span class="n">ESTART</span><span class="p">)):</span>
        <span class="n">EFINAL</span><span class="o">=</span><span class="mf">1.01</span><span class="o">*</span><span class="n">ESTART</span> 
    <span class="c">#   CHECK INPUT</span>
    <span class="n">TOTFRAC</span><span class="o">=</span><span class="mf">0.00</span>
    <span class="k">if</span><span class="p">(</span><span class="n">NGAS</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">NGAS</span> <span class="o">&gt;</span> <span class="mi">6</span><span class="p">):</span>
            <span class="n">GOTO999</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">J</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">NGAS</span><span class="p">):</span>
        <span class="k">if</span><span class="p">(</span><span class="n">NGASN</span><span class="p">[</span><span class="n">J</span><span class="p">]</span><span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">FRAC</span><span class="p">[</span><span class="n">J</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.00</span><span class="p">):</span>
            <span class="n">GOTO999</span><span class="p">()</span>
        <span class="n">TOTFRAC</span><span class="o">=</span><span class="n">TOTFRAC</span><span class="o">+</span><span class="n">FRAC</span><span class="p">[</span><span class="n">J</span><span class="p">]</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">TOTFRAC</span><span class="o">-</span><span class="mf">100.00</span><span class="p">)</span><span class="o">&gt;</span> <span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="mi">6</span><span class="p">)):</span>
        <span class="n">GOTO999</span><span class="p">()</span>
    <span class="n">LAST</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">TMAX</span><span class="o">=</span><span class="mf">100.00</span>  
    <span class="n">NOUT</span><span class="o">=</span><span class="mi">10</span>  
    <span class="n">NSTEP</span><span class="o">=</span><span class="mi">20000</span>
    <span class="c"># INITIAL ANGLES</span>
    <span class="k">if</span><span class="p">(</span><span class="n">NDVEC</span><span class="p">):</span> <span class="c">#22594</span>
        <span class="n">PHI</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">THETA</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">NDVEC</span><span class="o">==-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">PHI</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">THETA</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">NDVEC</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">PHI</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">THETA</span><span class="o">=</span><span class="n">API</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">NDVEC</span><span class="o">==</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">R3</span><span class="o">=</span><span class="n">DRAND48</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="n">PHI</span><span class="o">=</span><span class="n">TWOPI</span><span class="o">*</span><span class="n">R3</span>
        <span class="n">R4</span><span class="o">=</span><span class="n">DRAND48</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">)</span>
        <span class="n">THETA</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">R4</span><span class="p">)</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'DIRECTION OF BEAM NOT DEFINED NDVEC ='</span><span class="p">,</span><span class="n">NDVEC</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">()</span>

    <span class="c"># INITIAL DIRECTION COSINES FOR CASCADE CALCULATION</span>
    <span class="n">DRZINIT</span><span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">THETA</span><span class="p">)</span>
    <span class="n">DRXINIT</span><span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">THETA</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">PHI</span><span class="p">)</span>
    <span class="n">DRYINIT</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">THETA</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">PHI</span><span class="p">)</span>
    <span class="c"># ZERO COMMON BLOCKS OF OUTPUT RESULTS</span>
    <span class="k">for</span> <span class="n">J</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10000</span><span class="p">):</span>
        <span class="n">MSUM</span><span class="p">[</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">MCOMP</span><span class="p">[</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">MRAYL</span><span class="p">[</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">MPAIR</span><span class="p">[</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">MPHOT</span><span class="p">[</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">MVAC</span><span class="p">[</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>

    <span class="k">for</span> <span class="n">J</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">300</span><span class="p">):</span>
        <span class="n">TIME</span><span class="p">[</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">30</span><span class="p">):</span>
        <span class="n">ICOLL</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">512</span><span class="p">):</span>
        <span class="n">ICOLN</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">60</span><span class="p">):</span>
        <span class="n">ICOLNN</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">TCFMAX</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="c"># ZERO PLOT ARRAYS</span>
    <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">31</span><span class="p">):</span>
        <span class="n">NXPL2</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NYPL2</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NZPL2</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NXPL10</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NYPL10</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NZPL10</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NXPL40</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NYPL40</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NZPL40</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NXPL100</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NYPL100</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NZPL100</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NXPL400</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NYPL400</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NZPL400</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NXPL1000</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NYPL1000</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NZPL1000</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NXPL4000</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NYPL4000</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NZPL4000</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NXPL10000</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NYPL10000</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NZPL10000</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NXPL40000</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NYPL40000</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NZPL40000</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NXPL100000</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NYPL100000</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NZPL100000</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NRPL2</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NRPL10</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NRPL40</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NRPL100</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NRPL400</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NRPL1000</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NRPL4000</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NRPL10000</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NRPL40000</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NRPL100000</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span> <span class="c">#22678</span>
    <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">):</span>
        <span class="n">NEPL1</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NEPL10</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NEPL100</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">):</span>
        <span class="n">MELEC</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">MELEC3</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">MELEC10</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">MELEC30</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">MELEC100</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">MELEC300</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span> <span class="c">#22689</span>
    <span class="c"># C ZERO ARRAYS</span>
    <span class="k">for</span> <span class="n">KS</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100000</span><span class="p">):</span>
        <span class="n">XAV</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">YAV</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">ZAV</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">TAV</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">XYAV</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">XYZAV</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">DX</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">DY</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">DZ</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">DT</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">DXY</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">DXYZ</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">FARX1</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">FARY1</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">FARZ1</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">FARXY1</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">RMAX1</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">TSUM</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">XNEG</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">YNEG</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">ZNEG</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">EDELTA</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">EDELTA2</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">NCL</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">NCLEXC</span><span class="p">[</span><span class="n">KS</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span> <span class="c">##22716 #22915</span>
    <span class="c"># ----------------------------------------------------  </span>
    <span class="c"># if NSEED = 0 : USE STANDARD SEED VALUE =54217137</span>
    <span class="k">if</span><span class="p">(</span><span class="n">NSEED</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">RM48</span><span class="p">(</span><span class="n">NSEED</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>                           
    <span class="c">#-----------------------------------------------      </span>
    <span class="c">#</span>
    <span class="n">CORR</span><span class="o">=</span><span class="n">ABZERO</span><span class="o">*</span><span class="n">TORR</span><span class="o">/</span><span class="p">(</span><span class="n">ATMOS</span><span class="o">*</span><span class="p">(</span><span class="n">ABZERO</span><span class="o">+</span><span class="n">TEMPC</span><span class="p">)</span><span class="o">*</span><span class="mf">100.00</span><span class="p">)</span>                    <span class="c">#check precision</span>
    <span class="n">AKT</span><span class="o">=</span><span class="p">(</span><span class="n">ABZERO</span><span class="o">+</span><span class="n">TEMPC</span><span class="p">)</span><span class="o">*</span><span class="n">BOLTZ</span>
    <span class="n">AN1</span><span class="o">=</span><span class="n">FRAC</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span>                                           
    <span class="n">AN2</span><span class="o">=</span><span class="n">FRAC</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span>                                           
    <span class="n">AN3</span><span class="o">=</span><span class="n">FRAC</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span>                                           
    <span class="n">AN4</span><span class="o">=</span><span class="n">FRAC</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span>
    <span class="n">AN5</span><span class="o">=</span><span class="n">FRAC</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span>
    <span class="n">AN6</span><span class="o">=</span><span class="n">FRAC</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span>                                           
    <span class="n">AN</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="mf">100.00</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span><span class="p">)</span>
    <span class="n">AN</span><span class="o">=</span><span class="mf">100.00</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span>                                            
    <span class="c">#VAN1=FRAC[1]*CORR*CONST4*1.0D15                                   </span>
    <span class="c">#VAN2=FRAC[2]*CORR*CONST4*1.0D15                                   </span>
    <span class="c">#VAN3=FRAC(3)*CORR*CONST4*1.0D15                                   </span>
    <span class="c">#VAN4=FRAC[4]*CORR*CONST4*1.0D15</span>
    <span class="c">#VAN5=FRAC[5]*CORR*CONST4*1.0D15</span>
    <span class="c">#VAN6=FRAC[6]*CORR*CONST4*1.0D15                                   </span>
    <span class="c">#VAN=100.00*CORR*CONST4*1.0D15</span>
    <span class="n">VAN1</span><span class="o">=</span><span class="n">FRAC</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span><span class="o">*</span><span class="n">VC</span>                                   
    <span class="n">VAN2</span><span class="o">=</span><span class="n">FRAC</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span><span class="o">*</span><span class="n">VC</span>                                   
    <span class="n">VAN3</span><span class="o">=</span><span class="n">FRAC</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span><span class="o">*</span><span class="n">VC</span>                                  
    <span class="n">VAN4</span><span class="o">=</span><span class="n">FRAC</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span><span class="o">*</span><span class="n">VC</span>
    <span class="n">VAN5</span><span class="o">=</span><span class="n">FRAC</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span><span class="o">*</span><span class="n">VC</span>
    <span class="n">VAN6</span><span class="o">=</span><span class="n">FRAC</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span><span class="o">*</span><span class="n">VC</span>                                  
    <span class="n">VAN</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="mf">100.00</span><span class="o">*</span><span class="n">CORR</span><span class="o">*</span><span class="n">ALOSCH</span><span class="o">*</span><span class="n">VC</span><span class="p">)</span>    <span class="c">#22745 #22945</span>
    <span class="c"># CALCULATE AND STORE ENERGY GRID FOR XRAYS BETAS OR PARTICLES</span>

    <span class="k">if</span><span class="p">(</span><span class="n">EFINAL</span> <span class="o">&lt;=</span> <span class="mf">20000.0</span><span class="p">):</span>
        <span class="n">ESTEP</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">EFINAL</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">NSTEP</span><span class="p">))</span>
        <span class="n">EHALF</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">ESTEP</span><span class="o">/</span><span class="mf">2.00</span><span class="p">)</span>
        <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">EHALF</span>
        <span class="n">GAM</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">EMS</span><span class="o">+</span><span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">EMS</span>
        <span class="n">BET</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.00</span><span class="o">-</span><span class="mf">1.00</span><span class="o">/</span><span class="p">(</span><span class="n">GAM</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">GAM</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>  <span class="c">#ifcontinues</span>
        <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20000</span><span class="p">):</span>                      <span class="c">#ifcontinues</span>
            <span class="n">AJ</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">E</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">=</span><span class="n">EHALF</span><span class="o">+</span><span class="n">ESTEP</span><span class="o">*</span><span class="n">AJ</span>
            <span class="n">GAM</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">EMS</span><span class="o">+</span><span class="n">E</span><span class="p">[</span><span class="n">I</span><span class="p">])</span><span class="o">/</span><span class="n">EMS</span>
            <span class="n">BET</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.00</span><span class="o">-</span><span class="mf">1.00</span><span class="o">/</span><span class="p">(</span><span class="n">GAM</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">*</span><span class="n">GAM</span><span class="p">[</span><span class="n">I</span><span class="p">]))</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">EFINAL</span> <span class="o">&gt;</span> <span class="mf">20000.0</span> <span class="ow">and</span> <span class="n">EFINAL</span> <span class="o">&lt;=</span> <span class="mf">140000.</span><span class="p">)</span> <span class="p">:</span>
        <span class="n">ESTEP</span><span class="o">=</span><span class="mf">1.0</span>
        <span class="n">EHALF</span><span class="o">=</span><span class="mf">0.5</span>
        <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">EHALF</span>
        <span class="n">GAM</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">EMS</span><span class="o">+</span><span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">EMS</span>
        <span class="n">BET</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.00</span><span class="o">-</span><span class="mf">1.00</span><span class="o">/</span><span class="p">(</span><span class="n">GAM</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">GAM</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">16000</span><span class="p">):</span>
            <span class="n">AJ</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">E</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">=</span><span class="n">EHALF</span><span class="o">+</span><span class="n">ESTEP</span><span class="o">*</span><span class="n">AJ</span>
            <span class="n">GAM</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">EMS</span><span class="o">+</span><span class="n">E</span><span class="p">[</span><span class="n">I</span><span class="p">])</span><span class="o">/</span><span class="n">EMS</span>
            <span class="n">BET</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.00</span><span class="o">-</span><span class="mf">1.00</span><span class="o">/</span><span class="p">(</span><span class="n">GAM</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">*</span><span class="n">GAM</span><span class="p">[</span><span class="n">I</span><span class="p">]))</span>   <span class="c">#22768 #22968  </span>
        <span class="n">ESTEP1</span><span class="o">=</span><span class="p">(</span><span class="n">EFINAL</span><span class="o">-</span><span class="mf">16000.0</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">4000</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16001</span><span class="p">,</span><span class="mi">2000</span><span class="p">):</span>
            <span class="n">AJ</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">16000</span><span class="p">)</span>
            <span class="n">E</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">=</span><span class="mf">16000.0</span><span class="o">+</span><span class="n">AJ</span><span class="o">*</span><span class="n">ESTEP1</span>
            <span class="n">GAM</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">EMS</span><span class="o">+</span><span class="n">E</span><span class="p">[</span><span class="n">I</span><span class="p">])</span><span class="o">/</span><span class="n">EMS</span>
            <span class="n">BET</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.00</span><span class="o">-</span><span class="mf">1.00</span><span class="o">/</span><span class="p">(</span><span class="n">GAM</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">*</span><span class="n">GAM</span><span class="p">[</span><span class="n">I</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ESTEP</span><span class="o">=</span><span class="mf">1.0</span>
        <span class="n">EHALF</span><span class="o">=</span><span class="mf">0.5</span>
        <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">EHALF</span>
        <span class="n">GAM</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">EMS</span><span class="o">+</span><span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">EMS</span>
        <span class="n">BET</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.00</span><span class="o">-</span><span class="mf">1.00</span><span class="o">/</span><span class="p">(</span><span class="n">GAM</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">GAM</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">12000</span><span class="p">):</span>
            <span class="n">AJ</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">E</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">=</span><span class="n">EHALF</span><span class="o">+</span><span class="n">ESTEP</span><span class="o">*</span><span class="n">AJ</span>
            <span class="n">GAM</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">EMS</span><span class="o">+</span><span class="n">E</span><span class="p">[</span><span class="n">I</span><span class="p">])</span><span class="o">/</span><span class="n">EMS</span>
            <span class="n">BET</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.00</span><span class="o">-</span><span class="mf">1.00</span><span class="o">/</span><span class="p">(</span><span class="n">GAM</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">*</span><span class="n">GAM</span><span class="p">[</span><span class="n">I</span><span class="p">]))</span>
        <span class="n">ESTEP1</span><span class="o">=</span><span class="mf">20.0</span>
        <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12001</span><span class="p">,</span><span class="mi">16000</span><span class="p">):</span>
            <span class="n">AJ</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">12000</span><span class="p">)</span>
            <span class="n">E</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">=</span><span class="mf">12000.0</span><span class="o">+</span><span class="n">AJ</span><span class="o">*</span><span class="n">ESTEP1</span>
            <span class="n">GAM</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">EMS</span><span class="o">+</span><span class="n">E</span><span class="p">[</span><span class="n">I</span><span class="p">])</span><span class="o">/</span><span class="n">EMS</span>
            <span class="n">BET</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.00</span><span class="o">-</span><span class="mf">1.00</span><span class="o">/</span><span class="p">(</span><span class="n">GAM</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">*</span><span class="n">GAM</span><span class="p">[</span><span class="n">I</span><span class="p">]))</span>
        <span class="n">ESTEP2</span><span class="o">=</span><span class="p">(</span><span class="n">EFINAL</span><span class="o">-</span><span class="mf">92000.0</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">4000</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16001</span><span class="p">,</span><span class="mi">20000</span><span class="p">):</span>
            <span class="n">AJ</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">16000</span><span class="p">)</span>
            <span class="n">E</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">=</span><span class="mf">92000.0</span><span class="o">+</span><span class="n">AJ</span><span class="o">*</span><span class="n">ESTEP2</span>
            <span class="n">GAM</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">EMS</span><span class="o">+</span><span class="n">E</span><span class="p">[</span><span class="n">I</span><span class="p">])</span><span class="o">/</span><span class="n">EMS</span>
            <span class="n">BET</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.00</span><span class="o">-</span><span class="mf">1.00</span><span class="o">/</span><span class="p">(</span><span class="n">GAM</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">*</span><span class="n">GAM</span><span class="p">[</span><span class="n">I</span><span class="p">]))</span>
    <span class="c"># endif</span>
    <span class="c">#  RADIANS PER PICOSECOND                                        </span>
    <span class="n">WB</span><span class="o">=</span><span class="n">AWB</span><span class="o">*</span><span class="n">BMAG</span><span class="o">*</span><span class="mf">1.0</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="mi">12</span> <span class="p">)</span>
    <span class="c">#   METRES PER PICOSECOND</span>
    <span class="k">if</span><span class="p">(</span><span class="n">BMAG</span> <span class="o">==</span> <span class="mf">0.00</span><span class="p">):</span>
        <span class="k">return</span>
    <span class="n">EOVB</span><span class="o">=</span><span class="n">EFIELD</span><span class="o">*</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="mi">9</span><span class="p">)</span><span class="o">/</span><span class="n">BMAG</span>
    <span class="k">return</span>
    <span class="k">print</span><span class="p">(</span><span class="s">' ERROR IN GAS INPUT : NGAS='</span><span class="p">,</span><span class="n">NGAS</span><span class="p">,</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">J</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">' N='</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="s">' NGAS='</span><span class="p">,</span><span class="n">NGASN</span><span class="p">[</span><span class="n">J</span><span class="p">],</span><span class="s">' FRAC='</span><span class="p">,</span><span class="n">FRAC</span><span class="p">[</span><span class="n">J</span><span class="p">])</span>
    <span class="n">LAST</span><span class="o">=</span><span class="mi">1</span>                                                            
    <span class="k">return</span>                                                            
    <span class="c"># end                                                               </span>
</code></pre>
<p>The SETUP() function handles the gas inputs</p>
<h3 id='arguments'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>LAST</td>
<td>1 -&gt; end the program</td>
</tr>
<tr>
<td></td>
<td>0 -&gt; keep the Program running</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id='pseudo-code'>Pseudo Code</h3>
<ul>
<li>(Input Card 1)</li>
</ul>

<table><thead>
<tr>
<th>Variables</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>NGAS</td>
<td>Number of Gases</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>NEVENT</td>
<td>Event Number</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>IMIP</td>
<td>= 1 Mips Simulation  (dE/dX, Clusters)</td>
</tr>
<tr>
<td></td>
<td>= 2 Electron Beam  (Total Absorption)</td>
</tr>
<tr>
<td></td>
<td>= 3 X-ray</td>
</tr>
<tr>
<td></td>
<td>= 4 Beta Decay</td>
</tr>
<tr>
<td></td>
<td>= 5 Double Beta Decay</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>NDVEC</td>
<td>= 2 Mip X-ray or Beta in Random Direction</td>
</tr>
<tr>
<td></td>
<td>= 1 Mip X-ray or Beta Direction Parallel to E-field (Z)</td>
</tr>
<tr>
<td></td>
<td>=-1 Mip X-ray or Beta Direction Anti Parallel to E-field (-z)</td>
</tr>
<tr>
<td></td>
<td>= 0 Mip X-ray or Beta in Random Direction in X-y Plane</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>NSEED</td>
<td>= 0 Uses Standard Seed Value = 54217137</td>
</tr>
<tr>
<td></td>
<td>!= 0 Uses Value of NSEED as Seed Value</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>ESTART</td>
<td>Starting energy of the chosen IMIP ( MIP</td>
</tr>
<tr>
<td></td>
<td>electron,beta Decay or X-ray Energy in eV).</td>
</tr>
<tr>
<td></td>
<td>Note Double Beta Decay Energy Is to Be Entered as the</td>
</tr>
<tr>
<td></td>
<td>Energy of Each Beta (0.5 Times Total Decay Energy)</td>
</tr>
<tr>
<td></td>
<td>(if X-ray Max Energy=2.0 MeV)</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>ETHRM</td>
<td>Electrons Tracked Until They Fall to This Energy eV.</td>
</tr>
<tr>
<td></td>
<td>for Fast Calculation the Thermalisation Energy Should</td>
</tr>
<tr>
<td></td>
<td>Be Set to the Lowest Ionisation Potential in the Gas Mixture.</td>
</tr>
<tr>
<td></td>
<td>for More Accurate Thermalisation Range the Thermalisation</td>
</tr>
<tr>
<td></td>
<td>Energy Should Be Set to the Lowest Excitation Energy in</td>
</tr>
<tr>
<td></td>
<td>Pure Noble Gases or to 2.0 eV for Mixtures With Molecular Gas</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>ECUT</td>
<td>For Mips only. Applies Energy Cut in eV to Give the</td>
</tr>
<tr>
<td></td>
<td>Maximum Allowed Primary Cluster Energy ( Should Be Set</td>
</tr>
<tr>
<td></td>
<td>to Less Than 10000 eV to Give Maximum Primary Cluster Size)</td>
</tr>
<tr>
<td></td>
<td>of Typically 400 Electrons</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>

<ul>
<li>If number of gases is 0, then LAST =1 ( and end the program)</li>
<li>If X-Ray and Start energy ESTART &gt; 3 MeV then stop program</li>
<li>Stop if event limit NEVENT exceeded

<ul>
<li>non-MIPS Simulation:Limit for number of events = 10000 </li>
<li>MIPS Simulation: Limit for number of events = 100000</li>
</ul></li>
<li>Input Gas Identifiers (Input Card 2)</li>
</ul>

<table><thead>
<tr>
<th>Variable</th>
<th>Number of Inputs</th>
<th>Input Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>NGASN</td>
<td>6</td>
<td>int</td>
<td>Number to define which gas(between 1-80)</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>see Gas-List for identifying numbers</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>

<ul>
<li>Input Gas Parameters (Input Card 3)</li>
</ul>

<table><thead>
<tr>
<th>Variable</th>
<th>Number of Inputs</th>
<th>Input Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>FRAC</td>
<td>6</td>
<td>float .4f</td>
<td>Percentage fraction of gas in mixture</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TEMPC</td>
<td>1</td>
<td>float .4f</td>
<td>Temperature of Gas in Centigrade</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TORR</td>
<td>1</td>
<td>float .4f</td>
<td>Pressure of Gas in Torr</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>

<ul>
<li>Input Field values (Input Card 4)</li>
</ul>

<table><thead>
<tr>
<th>Variable</th>
<th>Input Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>EFIELD</td>
<td>float .3f</td>
<td>Electric Field in Volts/cm</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>BMAG</td>
<td>float .3f</td>
<td>Magnetic Field in Kilo Gauss</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>BTHETA</td>
<td>float .3f</td>
<td>Angle between electric and magnetic fields in degrees</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>IWRITE</td>
<td>int</td>
<td>= 0 Standard Output</td>
</tr>
<tr>
<td></td>
<td></td>
<td>= 1 then</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Line 1: Output no. of electrons and no. of excitations</td>
</tr>
<tr>
<td></td>
<td></td>
<td>for each event</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Line 2 : Output X,Y,Z and T for each thermalised electron</td>
</tr>
<tr>
<td></td>
<td></td>
<td>= 2 then</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Line 1: Output no. of electrons and no. of excitations</td>
</tr>
<tr>
<td></td>
<td></td>
<td>for each event</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Line 2: Outputs X,Y,Z and T for each thermalised electron</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Line 3: Outputs X,Y,Z and T for each excitation</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>IPEN</td>
<td>int</td>
<td>= 0 No Penning transfers</td>
</tr>
<tr>
<td></td>
<td></td>
<td>= 1 Penning transfers allowed</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>

<ul>
<li>(Input Card 5) </li>
</ul>

<table><thead>
<tr>
<th>Variable</th>
<th>Input type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>DETEFF</td>
<td>float .3f</td>
<td>Detection efficiency of photons. Used for calculation of</td>
</tr>
<tr>
<td></td>
<td></td>
<td>FANO factors for combined electron and photon detection</td>
</tr>
<tr>
<td></td>
<td></td>
<td>in pure noble gases (Between 0.0 - 100.0)</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>EXCWGHT</td>
<td>float .3f</td>
<td>Weight given to excitation events in FANO calculation</td>
</tr>
<tr>
<td></td>
<td></td>
<td>with respect to ionisation. Typically 0.5 - 0.6</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Use weight given by SQRT((Fele)/(Fexc))</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Fele = Electron FANO factor</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Fexc = Electron FANO factor</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>KGAS</td>
<td>int</td>
<td>Gas identifier for which gas in mixture has Beta decayed.</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Identifier Numbers : NGAS1 etc.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>LGAS</td>
<td>int</td>
<td>If molecular gas : LGAS identifies the component atom in</td>
</tr>
<tr>
<td></td>
<td></td>
<td>the molecule which has Beta decayed :</td>
</tr>
<tr>
<td></td>
<td></td>
<td>E.g. in CO2 1=Carbon 2=Oxygen</td>
</tr>
<tr>
<td></td>
<td></td>
<td>in CF4 1=Carbon 2=Fluorine</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>ICMP</td>
<td>int</td>
<td>=0 No Compton Scattering</td>
</tr>
<tr>
<td></td>
<td></td>
<td>=1 Include Compton Scattering</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>IRAY</td>
<td>int</td>
<td>=0 No Rayleigh Scattering</td>
</tr>
<tr>
<td></td>
<td></td>
<td>=1 Include Rayleigh Scattering</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>IPAP</td>
<td>int</td>
<td>=0 No pair production</td>
</tr>
<tr>
<td></td>
<td></td>
<td>=1 Include pair production</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>IBRM</td>
<td>int</td>
<td>=0 No Bremsstrahlung</td>
</tr>
<tr>
<td></td>
<td></td>
<td>=1 Include Bremsstrahlung</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>IECASC</td>
<td>int</td>
<td>=0 Use parameterised cascade for 2nd to n^(th) generation</td>
</tr>
<tr>
<td></td>
<td></td>
<td>of electron ionising collisions.</td>
</tr>
<tr>
<td></td>
<td></td>
<td>=1 Use exact cascade for 2nd to nth generation of</td>
</tr>
<tr>
<td></td>
<td></td>
<td>electron ionising collisions.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
