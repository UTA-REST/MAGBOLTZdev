def CSSTFB1(NVAC,L1,DIST1):           
	# IMPLICIT #real*8 (A-H,O-Z)
	# IMPLICIT #integer*8 (I-N)
	COMMON/CALCASB/IONSUM0(10),IFLSUM0(10),ESTORE0(10,28),EPHOTON0(10,28),DRXE0(10,28),DRYE0(10,28),DRZE0(10,28),DRX0(10,28),DRY0(10,28),DRZ0(10,28)
	COMMON/CALCAS1B/IONSUM(10),IFLSUM(10),ESTORE(10,28),EPHOTON(10,28),DRXE(10,28),DRYE(10,28),DRZE(10,28),DRX(10,28),DRY(10,28),DRZ[10,28]
	COMMON/GENB1/IONF1(10),ESTF1(10,28),X1(10,28),Y1(10,28),Z1(10,28),DRXS(10,28),DRYS(10,28),DRZS(10,28)
	COMMON/GEN11/X11(10,28),Y11(10,28),Z11(10,28)
	COMMON/GEN01/X01(10),Y01(10),Z01(10)
	#
	if(L1 == 0):
	:
	# ZERO COUNTER
	IONF1[NVAC]=0
	DO 11 K=1,28
	11  ESTF1(NVAC,K)=0.0
	return
	# endif
	# STORE EVENT DATA FOR FIRST GENERATION FLUORESCENCE
	if(IONSUM[NVAC]:
	> 28) :
	WRITE(6,99) IONSUM[NVAC],NVAC
	99   print(' WARNING FIRST GENERATION CONVERTED FLUORESCENCE HAS AN EVENT WITH',I3,' IONS.',/,' COMPTON BRANCH NO=',I3,/)
	sys.exit()
	# endif
	IONF1[NVAC]=IONSUM[NVAC]
	DO 1 J=1,IONSUM[NVAC]
	ESTF1(NVAC,J)=ESTORE(NVAC,J)
	X1(NVAC,J)=X01[NVAC]+DIST1*DRX0(NVAC,L1)
	Y1(NVAC,J)=Y01[NVAC]+DIST1*DRY0(NVAC,L1)
	Z1(NVAC,J)=Z01[NVAC]+DIST1*DRZ0(NVAC,L1)
	X11(NVAC,L1)=X1(NVAC,J)
	Y11(NVAC,L1)=Y1(NVAC,J)
	Z11(NVAC,L1)=Z1(NVAC,J)
	DRXS(NVAC,J)=DRXE(NVAC,J)
	DRYS(NVAC,J)=DRYE(NVAC,J)
	DRZS(NVAC,J)=DRZE(NVAC,J)
	1 CONTINUE
	return
	# end
def CSSTFB2(NVAC,L1,DIST1):               
	# IMPLICIT #real*8 (A-H,O-Z)
	# IMPLICIT #integer*8 (I-N)
	COMMON/CALCAS1B/IONSUM0(10),IFLSUM0(10),ESTORE0(10,28),EPHOTON0(10,28),DRXE0(10,28),DRYE0(10,28),DRZE0(10,28),DRX0(10,28),DRY0(10,28),DRZ0(10,28)
	COMMON/CALCAS2B/IONSUM(10),IFLSUM(10),ESTORE(10,28),EPHOTON(10,28),DRXE(10,28),DRYE(10,28),DRZE(10,28),DRX(10,28),DRY(10,28),DRZ[10,28]
	COMMON/GENB2/IONF2(10),ESTF2(10,28),X2(10,28),Y2(10,28),Z2(10,28),DRXS(10,28),DRYS(10,28),DRZS(10,28)
	COMMON/GEN21/X21(10,28),Y21(10,28),Z21(10,28)
	COMMON/GEN11/X11(10,28),Y11(10,28),Z11(10,28)
	#
	if(L1 == 0):
	:
	# ZERO COUNTER
	IONF2[NVAC]=0
	DO 11 K=1,28
	11  ESTF2(NVAC,K)=0.0
	return
	# endif
	# STORE EVENT DATA FOR FIRST GENERATION FLUORESCENCE
	# STORE EVENT DATA FOR SECOND GENERATION FLUORESCENCE
	if(IONSUM[NVAC]:
	> 28) :
	WRITE(6,99) IONSUM[NVAC],NVAC
	99   print(' WARNING SECOND GENERATION CONVERTED FLUORESCENCE HAS AN  EVENT WITH',I3,' IONS.',/,' COMPTON BRANCH NO=',I3,/)
	sys.exit()
	# endif
	IONF2[NVAC]=IONSUM[NVAC]
	DO 1 J=1,IONSUM[NVAC]
	ESTF2(NVAC,J)=ESTORE(NVAC,J)
	X2(NVAC,J)=X11(NVAC,L1)+DIST1*DRX0(NVAC,L1)
	Y2(NVAC,J)=Y11(NVAC,L1)+DIST1*DRY0(NVAC,L1)
	Z2(NVAC,J)=Z11(NVAC,L1)+DIST1*DRZ0(NVAC,L1)
	X21(NVAC,L1)=X2(NVAC,J)
	Y21[NVAC][L1]=Y2(NVAC,J)
	Z21[NVAC][L1]=Z2(NVAC,J)
	DRXS(NVAC,J)=DRXE(NVAC,J)
	DRYS(NVAC,J)=DRYE(NVAC,J)
	DRZS(NVAC,J)=DRZE(NVAC,J)
	1 CONTINUE
	return
	# end
def CSSTFB3(NVAC,L1,DIST1):
	# IMPLICIT #real*8 (A-H,O-Z)
	# IMPLICIT #integer*8 (I-N)
	COMMON/CALCAS2B/IONSUM0(10),IFLSUM0(10),ESTORE0(10,28),EPHOTON0(10,28),DRXE0(10,28),DRYE0(10,28),DRZE0(10,28),DRX0(10,28),DRY0(10,28),DRZ0(10,28)
	COMMON/CALCAS3B/IONSUM(10),IFLSUM(10),ESTORE(10,28),EPHOTON(10,28),DRXE(10,28),DRYE(10,28),DRZE(10,28),DRX(10,28),DRY(10,28),DRZ[10,28]
	COMMON/GENB3/IONF3(10),ESTF3(10,15),X3(10,15),Y3(10,15),Z3(10,15),DRXS(10,15),DRYS(10,15),DRZS(10,15)
	COMMON/GEN31/X31(10,28),Y31(10,28),Z31(10,28)
	COMMON/GEN21/X21(10,28),Y21(10,28),Z21(10,28)
	#
	if(L1 == 0):
	:
	# ZERO COUNTER
	IONF3[NVAC]=0
	DO 11 K=1,15
	11  ESTF3(NVAC,K)=0.0
	return
	# endif
	# STORE EVENT DATA FOR THIRD GENERATION FLUORESCENCE
	if(IONSUM[NVAC]:
	> 15) :
	WRITE(6,99) IONSUM[NVAC],NVAC
	99   print(' WARNING THIRD GENERATION CONVERTED FLUORESCENCE HAS AN  EVENT WITH',I3,' IONS.',/,' COMPTON BRANCH NO=',I3,/)
	sys.exit()
	# endif
	IONF3[NVAC]=IONSUM[NVAC]
	DO 1 J=1,IONSUM[NVAC]
	ESTF3(NVAC,J)=ESTORE(NVAC,J)
	X3(NVAC,J)=X21(NVAC,L1)+DIST1*DRX0(NVAC,L1)
	Z3[NVAC][J]=Y21[NVAC][L1]+DIST1*DRY0(NVAC,L1)
	Z3[NVAC][J]=Z21[NVAC][L1]+DIST1*DRZ0(NVAC,L1)
	X31[NVAC][L1]=X3(NVAC,J)
	Y31(NVAC,L1)=Z3[NVAC][J]
	Z31(NVAC,L1)=Z3[NVAC][J]
	DRXS(NVAC,J)=DRXE(NVAC,J)
	DRYS(NVAC,J)=DRYE(NVAC,J)
	DRZS(NVAC,J)=DRZE(NVAC,J)
	1 CONTINUE
	return
	# end
def CSSTFB4(NVAC,L1,DIST1):
	# IMPLICIT #real*8 (A-H,O-Z)
	# IMPLICIT #integer*8 (I-N)
	COMMON/CALCAS3B/IONSUM0(10),IFLSUM0(10),ESTORE0(10,28),EPHOTON0(10,28),DRXE0(10,28),DRYE0(10,28),DRZE0(10,28),DRX0(10,28),DRY0(10,28),DRZ0(10,28)
	COMMON/CALCAS4B/IONSUM(10),IFLSUM(10),ESTORE(10,28),EPHOTON(10,28),DRXE(10,28),DRYE(10,28),DRZE(10,28),DRX(10,28),DRY(10,28),DRZ[10,28]
	COMMON/GENB4/IONF4(10),ESTF4(10,12),X4(10,12),Y4(10,12),Z4(10,12),DRXS(10,12),DRYS(10,12),DRZS(10,12)
	COMMON/GEN31/X31(10,28),Y31(10,28),Z31(10,28)
	COMMON/GEN41/X41(10,28),Y41(10,28),Z41(10,28)
	#
	if(L1 == 0):
	:
	# ZERO COUNTER
	IONF4[NVAC]=0
	DO 11 K=1,12
	11  ESTF4(NVAC,K)=0.0
	return
	# endif
	# STORE EVENT DATA FOR FOURTH GENERATION FLUORESCENCE
	if(IONSUM[NVAC]:
	> 12) :
	WRITE(6,99) IONSUM[NVAC],NVAC
	99   print(' WARNING FOURTH GENERATION CONVERTED FLUORESCENCE HAS AN  EVENT WITH',I3,' IONS.',/,' COMPTON BRANCH NO=',I3,/)
	sys.exit()
	# endif
	IONF4[NVAC]=IONSUM[NVAC]
	DO 1 J=1,IONSUM[NVAC]
	ESTF4(NVAC,J)=ESTORE(NVAC,J)
	X4(NVAC,J)=X31[NVAC][L1]+DIST1*DRX0(NVAC,L1)
	Y4(NVAC,J)=Y31(NVAC,L1)+DIST1*DRY0(NVAC,L1)
	Z4(NVAC,J)=Z31(NVAC,L1)+DIST1*DRZ0(NVAC,L1)
	X41(NVAC,L1)=X4(NVAC,J)
	Y41(NVAC,L1)=Y4(NVAC,J)
	Z41(NVAC,L1)=Z4(NVAC,J)
	DRXS(NVAC,J)=DRXE(NVAC,J)
	DRYS(NVAC,J)=DRYE(NVAC,J)
	DRZS(NVAC,J)=DRZE(NVAC,J)
	1 CONTINUE
	return
	# end
def CSSTFB5(NVAC,L1,DIST1):
	# IMPLICIT #real*8 (A-H,O-Z)
	# IMPLICIT #integer*8 (I-N)
	COMMON/CALCAS4B/IONSUM0(10),IFLSUM0(10),ESTORE0(10,28),EPHOTON0(10,28),DRXE0(10,28),DRYE0(10,28),DRZE0(10,28),DRX0(10,28),DRY0(10,28),DRZ0(10,28)
	COMMON/CALCAS5B/IONSUM(10),IFLSUM(10),ESTORE(10,28),EPHOTON(10,28),DRXE(10,28),DRYE(10,28),DRZE(10,28),DRX(10,28),DRY(10,28),DRZ[10,28]
	COMMON/GENB5/IONF5(10),ESTF5(10,5),X5(10,5),Y5(10,5),Z5(10,5),DRXS(10,5),DRYS(10,5),DRZS(10,5)
	COMMON/GEN41/X41(10,28),Y41(10,28),Z41(10,28)
	COMMON/GEN51/X51(10,28),Y51(10,28),Z51(10,28)
	#
	if(L1 == 0):
	:
	# ZERO COUNTER
	IONF5[NVAC]=0
	DO 11 K=1,5
	11  ESTF5(NVAC,K)=0.0
	return
	# endif
	# STORE EVENT DATA FOR FIFTH GENERATION FLUORESCENCE
	if(IONSUM[NVAC]:
	> 5) :
	WRITE(6,99) IONSUM[NVAC],NVAC
	99   print(' WARNING FifTH GENERATION CONVERTED FLUORESCENCE HAS AN  EVENT WITH',I3,' IONS.',/,' COMPTON BRANCH NO=',I3,/)
	sys.exit()
	# endif
	IONF5[NVAC]=IONSUM[NVAC]
	DO 1 J=1,IONSUM[NVAC]
	ESTF5(NVAC,J)=ESTORE(NVAC,J)
	X5(NVAC,J)=X41(NVAC,L1)+DIST1*DRX0(NVAC,L1)
	Y5(NVAC,J)=Y41(NVAC,L1)+DIST1*DRY0(NVAC,L1)
	Z5(NVAC,J)=Z41(NVAC,L1)+DIST1*DRZ0(NVAC,L1)
	X51(NVAC,L1)=X5(NVAC,J)
	Y51(NVAC,L1)=Y5(NVAC,J)
	Z51(NVAC,L1)=Z5(NVAC,J)
	DRXS(NVAC,J)=DRXE(NVAC,J)
	DRYS(NVAC,J)=DRYE(NVAC,J)
	DRZS(NVAC,J)=DRZE(NVAC,J)
	1 CONTINUE
	return
	# end
