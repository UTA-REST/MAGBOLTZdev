      PROGRAM MAGBOLTZ
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      CHARACTER*25 NAME
      CHARACTER*50 SCRPT(300),SCRPTN(10)
      DIMENSION Q(6,4000),QIN(250,4000),E(6),EI(250),KIN(250)
      DIMENSION QION(30,4000),PEQION(30,4000),EION(30),EB(30)
      DIMENSION PEQEL(6,4000),PEQIN(250,4000),KEL(6),PENFRA(3,250)
      DIMENSION NC0(30),EC0(30),WK(30),EFL(30),NG1(30),EG1(30),
     /NG2(30),EG2(30),EG(4000),DEN(4000)
      DIMENSION QATT(8,4000),QNULL(10,4000),SCLN(10)
   
      
      CALL GAS1(Q,QIN,NIN,E,EI,NAME,VIRL,EB,PEQEL,PEQIN,PENFRA,KEL,KIN,
     /QION,PEQION,EION,NION,QATT,NATT,QNULL,NNULL,SCLN,NC0,EC0,WK,EFL,
     /NG1,EG1,NG2,EG2,SCRPT,SCRPTN)
      RETURN


      END PROGRAM MAGBOLTZ


 
      SUBROUTINE GAS1(Q,QIN,NIN,E,EIN,NAME,VIRIAL,EOBY
     /,PEQEL,PEQIN,PENFRA,KEL,KIN,QION,PEQION,EION,NION,QATT,NATT,
     /QNULL,NNULL,SCLN,NC0,EC0,WKLM,EFL,NG1,EG1,NG2,EG2,SCRPT,SCRPTN)
C    /QNULL,NNULL,NC0,EC0,WKLM,EFL,NG1,EG1,NG2,EG2,IZBR,LEGAS,ISHELL,
C    /SCRPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*8 (I-N)
      COMMON/CNSTS/ECHARG,EMASS,AMU,PIR2
      COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN
      COMMON/MIX2/EG(4000),EROOT(4000),QT1(4000),QT2(4000),
     /QT3(4000),QT4(4000)
      COMMON/DENS/DEN(4000)
      DIMENSION PEQEL(6,4000),PEQIN(250,4000),KIN(250),KEL(6)
      DIMENSION QION(30,4000),PEQION(30,4000),EION(30),EOBY(30)
      DIMENSION NC0(30),EC0(30),WKLM(30),EFL(30),NG1(30),EG1(30),NG2(30)
     /,EG2(30),IZBR(250),LEGAS(30),ISHELL(30)
      DIMENSION QATT(8,4000),QNULL(10,4000),SCLN(10)
      DIMENSION Q(6,4000),QIN(250,4000),E(6),EIN(250),PENFRA(3,250)
      DIMENSION XEN(163),YELM(163),YELT(163),YEPS(163),
     /XVBV4(11),YVBV4(11),XVBV1(11),YVBV1(11),XVBV3(11),YVBV3(11),
     /XVIB5(12),YVIB5(12),XVIB6(12),YVIB6(12),
     /XTR1(12),YTR1(12),XTR2(11),YTR2(11),XTR3(11),YTR3(11),
     /XCF3(37),YCF3(37),XCF2(31),YCF2(31),XCF1(28),YCF1(28),XCF32(25),
     /YCF32(25),XCF0(27),YCF0(27),XC0F(27),YC0F(27),XCF22(25),YCF22(25),
     /XCF(22),YCF(22),XCFF(24),YCFF(24),XCF2F(25),YCF2F(25),
     /XCF3F(26),YCF3F(26),XATT(11),YATT(11),
     /XKSHC(81),YKSHC(81),XKSHF(79),YKSHF(79),IOFFN(46),IOFFION(12)
      DIMENSION Z6T(25),Z9T(25),EBRM(25)
      CHARACTER*50 SCRPT(300),SCRPTN(10)
      CHARACTER*25 NAME
      Do 1111 J=1,4000
      DEN(J)=1
      EG(J)=6.25D-5+(J-1)*(1.25D-4)
 1111 CONTINUE
      Do 1110 I=1,30
      Do 1110 J=1,4000
      QION(I,J)=0
      PEQION(I,J)=0
 1110 CONTINUE
    
      Do 1115 I=1,8
      Do 1115 J=1,4000
      QATT(I,J)=0
 1115 CONTINUE
      ESTEP=1.25e-4
      Do 1112 I=1,250
      EIN(I)=0
      Do 1112 J=1,4000
      QIN(I,J)=0
      PEQIN(I,J)=0
 1112 CONTINUE
      Do 1113 I=1,6
      E(I)=0
      Do 1113 J=1,4000
      Q(I,J)=0
      PEQEL(I,J)=0
 1113 CONTINUE
      AKT=2.6037269846599997e-2
      NANISO=2
      EFINAL = 0.5
      NSTEP=4000

      IPEN=1
      DATA XEN/0.0,.001,.002,.003,.004,.005,.006,.007,.008,.009,
     /0.01,.012,.014,.016,.018,0.02,.025,0.03,.035,0.04,
     /.045,0.05,.055,0.06,.065,0.07,.075,0.08,.085,0.09,
     /0.10,0.12,0.14,0.17,0.20,0.24,0.30,0.40,0.50,0.60,
     /0.80,1.00,1.20,1.40,1.70,2.00,3.00,5.00,6.00,7.00,
     /8.00,9.00,10.0,12.0,15.0,20.0,25.0,30.0,40.0,50.0,
     /60.0,80.0,100.,125.,150.,200.,250.,300.,400.,500.,
     /600.,700.,800.,1000.,1250.,1500.,1750.,2000.,2500.,3000.,
     /3500.,4000.,5000.,6000.,7000.,8000.,9000.,10000.,1.25D4,1.50D4,
     /1.75D4,2.0D4,2.5D4,3.0D4,3.5D4,4.0D4,4.5D4,5.0D4,6.0D4,7.0D4,
     /8.0D4,9.0D4,1.0D5,1.25D5,1.5D5,1.75D5,2.0D5,2.5D5,3.0D5,3.5D5,
     /4.0D5,4.5D5,5.0D5,6.0D5,7.0D5,8.0D5,9.0D5,1.0D6,1.25D6,1.5D6,
     /1.75D6,2.0D6,2.5D6,3.0D6,3.5D6,4.0D6,4.5D6,5.0D6,6.0D6,7.0D6,
     /8.0D6,9.0D6,1.0D7,1.25D7,1.5D7,1.75D7,2.0D7,2.5D7,3.0D7,3.5D7,
     /4.0D7,4.5D7,5.0D7,6.0D7,7.0D7,8.0D7,9.0D7,1.0D8,1.25D8,1.5D8,
     /1.75D8,2.0D8,2.5D8,3.0D8,3.5D8,4.0D8,4.5D8,5.0D8,6.0D8,7.0D8,
     /8.0D8,9.0D8,1.0D9/
C ELASTIC MOMENTUM TRANSFER X-SECTION
      DATA YELM/12.5,8.70,7.00,5.95,5.20,4.70,4.30,3.95,3.65,3.40,
     /3.20,2.85,2.58,2.37,2.19,2.04,1.77,1.57,1.41,1.30,
     /1.20,1.12,1.05,0.99,0.93,0.88,0.84,0.80,0.76,0.72,
     /0.65,0.48,0.35,0.29,0.29,0.34,0.47,0.87,1.35,1.85,
     /2.95,4.00,4.75,5.15,5.45,5.65,5.80,6.00,6.10,6.30,
     /6.50,6.80,7.20,8.30,9.50,10.1,9.60,8.80,7.85,6.72,
     /5.90,5.06,4.16,3.57,2.99,1.92,1.53,1.20,0.88,0.66,
     /.525,0.43,0.37,0.30,.228,.169,.131,.104,.0711,.0519,
     /.0397,.0314,.0212,.0153,.0117,.00918,.00743,.00615,.00412,.00297,
     /2.25D-3,1.77D-3,1.18D-3,8.51D-4,6.45D-4,5.08D-4,4.12D-4,3.41D-4,
     /2.47D-4,1.88D-4,
     /1.49D-4,1.21D-4,1.01D-4,6.88D-5,5.05D-5,3.90D-5,3.13D-5,2.17D-5,
     /1.62D-5,1.27D-5,
     /1.03D-5,8.56D-6,7.27D-6,5.49D-6,4.34D-6,3.54D-6,2.96D-6,2.52D-6,
     /1.81D-6,1.36D-6,
     /1.07D-6,8.68D-7,6.08D-7,4.53D-7,3.51D-7,2.82D-7,2.31D-7,1.93D-7,
     /1.42D-7,1.08D-7,
     /8.59D-8,6.98D-8,5.79D-8,3.89D-8,2.80D-8,2.12D-8,1.66D-8,1.10D-8,
     /7.86D-9,5.90D-9,
     /4.59D-9,3.68D-9,3.01D-9,2.13D-9,1.58D-9,1.22D-9,9.75D-10,7.92D-10,
     /5.10D-10,3.56D-10,
     /2.62D-10,2.01D-10,1.29D-10,8.95D-11,6.58D-11,5.04D-11,3.98D-11,
     /3.23D-11,2.24D-11,1.65D-11,
     /1.26D-11,9.96D-12,8.07D-12/
C ELASTIC X-SECTION ASSUMED ISOTROPIC BELOW 0.6 EV
      DATA YELT/12.5,8.70,7.00,5.95,5.20,4.70,4.30,3.95,3.65,3.40,
     /3.20,2.85,2.58,2.37,2.19,2.04,1.77,1.57,1.41,1.30,
     /1.20,1.12,1.05,0.99,0.93,0.88,0.84,0.80,0.76,0.72,
     /0.65,0.48,0.35,0.29,0.29,0.34,0.47,0.87,1.35,1.85,
     /3.77,4.89,5.66,6.43,7.43,8.34,10.6,12.5,11.6,11.0,
     /11.0,11.7,12.9,14.5,16.8,17.6,18.1,17.2,15.9,14.9,
     /14.3,13.0,11.7,10.5,9.65,8.10,6.83,6.02,5.02,4.36,
     /3.83,3.40,3.08,2.65,2.17,1.89,1.55,1.40,1.19,1.11,
     /.921,.822,.696,.568,.492,.435,.390,.353,.286,.241,
     /.209,.185,.150,.127,.111,.0984,.0888,.0810,.0694,.0611,
     /.0522,.050,.0461,.0391,.0344,.0311,.0287,.0253,.0230,.0214,
     /.0202,.0193,.0186,.0176,.0169,.0164,.0160,.0157,.0152,.0148,
     /.0146,.0145,.0143,.0142,.0141,.0141,.0140,.0140,.0140,.0139,
     /.0139,.0139,.0139,.0139,.01389,.01389,.01389,26*.01388/
C EPSILON FOR ELASTIC ANGULAR DISTRIBUTION
C EPSILON =1-YEPS
      DATA YEPS/40*1.0,
     /.68056,.73101,.76161,.70664,.61270,.53797,.37888,.30604,.35505,
     /.40830,
     /.42979,.41826,.39140,.40794,.39986,.40963,.36006,.33951,.32037,
     /.27671,
     /.23985,.21859,.18948,.17666,.15292,.10180,.09358,.07880,.06538,
     /.05301,
     /.04608,.04117,.03833,.03532,.03188,.02561,.02374,.019986,.015005,
     /.010925,
     /.009845,.008442,.006348,.005446,.004667,.004028,.003554,.003186,
     /.002530,.002096,
     /.001783,.001549,.001228,.001016,.000859,.000749,.000661,.000590,
     /.000486,.000411,
     /3.53D-4,3.12D-4,2.78D-4,2.17D-4,1.76D-4,1.47D-4,1.26D-4,9.61D-5,
     /7.68D-5,6.32D-5,
     /5.32D-5,4.56D-5,3.97D-5,3.10D-5,2.30D-5,2.07D-5,1.74D-5,1.49D-5,
     /1.07D-5,8.04D-6,
     /6.28D-6,5.05D-6,3.47D-6,2.54D-6,1.94D-6,1.53D-6,1.24D-6,1.02D-6,
     /7.33D-7,5.51D-7,
     /4.30D-7,3.44D-7,2.82D-7,1.84D-7,1.30D-7,9.62D-8,7.42D-8,4.80D-8,
     /3.35D-8,2.47D-8,
     /1.89D-8,1.50D-8,1.21D-8,8.388D-9,6.133D-9,4.669D-9,3.666D-9,
     /2.950D-9,1.858D-9,1.271D-9,
     /9.21D-10,6.97D-10,4.37D-10,2.98D-10,2.16D-10,1.63D-10,1.28D-10,
     /1.02D-10,7.00D-11,5.10D-11,
     /3.80D-11,3.00D-11,2.40D-11/
C  VIBRATION V4 (RESONANCE ONLY) SCALED BY 1/E**3 ABOVE 50EV
      DATA XVBV4/0.0783,4.00,5.00,6.00,7.00,8.00,9.00,10.0,15.0,20.0,
     /50.0/
      DATA YVBV4/0.0,0.0,0.05,0.35,1.06,1.40,1.26,0.97,0.07,.022,
     /1.D-3/
C  VIBRATION V1 (RESONANCE ONLY) SCALED BY 1/E**3 ABOVE 50EV
      DATA XVBV1/0.1126,4.00,5.00,6.00,7.00,8.00,9.00,10.0,15.0,20.0,
     /50.0/
      DATA YVBV1/0.0,0.0,.016,.118,0.36,0.47,0.42,0.33,.023,.007,
     /3.D-4/
C  VIBRATION V3 (RESONANCE ONLY) SCALED BY 1/E**3 ABOVE 50EV
      DATA XVBV3/0.1588,4.00,5.00,6.00,7.00,8.00,9.00,10.0,15.0,20.0,
     /50.0/
      DATA YVBV3/0.0,0.0,0.15,1.05,3.19,4.20,3.78,2.90,0.20,.067,
     /3.D-3/
C  VIBRATION HARMONIC 2(V3) SCALED BY 1/E ABOVE 50EV
      DATA XVIB5/0.3176,1.00,4.00,5.00,6.00,7.00,8.00,9.00,10.0,15.0,
     /20.0,50.0/
      DATA YVIB5/0.0,.001,0.01,.031,0.23,0.67,0.87,0.79,0.60,.042,
     /.014,.0006/
C VIBRATION HARMONIC (3(V3) + ALL OTHER HARMONICS)
C  SCALED BY 1/E ABOVE 50 EV
      DATA XVIB6/0.4764,1.00,4.00,5.00,6.00,7.00,8.00,9.00,10.0,15.0,
     /20.0,50.0/
      DATA YVIB6/0.0,.0009,.045,.117,.774,2.32,3.06,2.75,2.12,.138,
     /.037,.0018/
C	
C  DISSOCATIVE IONISATION :
C  WEIGHTED AVERAGE OF SIEGLAFF AND NISHIMURA FOR SINGLE IONISATION AND
C  DOUBLE IONISATION.
C  FOR DOUBLE IONISATION WITH BREAKUP :  BRUCE ET AL CPL 190(1992)285
C  NB.  (USED NISHIMURA ONLY BELOW 30EV)
C
C CF3 +
      DATA XCF3/15.7,16.0,17.0,18.0,19.0,20.0,22.0,24.0,26.0,28.0,
     /30.0,35.0,40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,
     /120.,140.,160.,200.,250.,300.,400.,500.,600.,800.,
     /1000.,1250.,1500.,1750.,2000.,2500.,3000./
      DATA YCF3/0.0,.032,.075,.128,.191,.276,.448,.610,.866,1.08,
     /1.26,1.72,2.05,2.35,2.62,2.94,3.13,3.24,3.32,3.35,
     /3.38,3.34,3.27,3.17,3.00,2.81,2.54,2.28,2.09,1.77,
     /1.56,1.32,1.15,1.05,.937,.804,.692/
C CF2+
      DATA XCF2/21.47,24.0,26.0,28.0,
     /30.0,35.0,40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,
     /120.,140.,160.,200.,250.,300.,400.,500.,600.,800.,
     /1000.,1250.,1500.,1750.,2000.,2500.,3000./
      DATA YCF2/0.00,.003,.010,.032,
     /.060,.131,.148,.162,.192,.221,.234,.243,.256,.263,
     /.266,.260,.257,.240,.233,.212,.186,.169,.152,.131,
     /.113,.0961,.0834,.0763,.0681,.0585,.0503/
C CF+
      DATA XCF1/29.14,
     /30.0,35.0,40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,
     /120.,140.,160.,200.,250.,300.,400.,500.,600.,800.,
     /1000.,1250.,1500.,1750.,2000.,2500.,3000./
      DATA YCF1/0.00,
     /.0024,.0145,.0583,.107,.156,.185,.226,.239,.238,.266,
     /.274,.259,.261,.234,.227,.186,.146,.122,.113,.0909,
     /.0820,.0695,.0603,.0552,.0493,.0423,.0364/
C DATA CF3 2+
      DATA XCF32/41.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,120.,140.,
     /160.,200.,250.,300.,400.,500.,600.,800.,1000.,1250.,
     /1500.,1750.,2000.,2500.,3000./
      DATA YCF32/0.00,.0053,.0083,.0104,.0135,.0154,.0164,.0187,.0208,
     /.0198,
     /.0208,.0198,.0187,.0167,.0135,.0114,.0101,.0079,.0065,.0055,
     /.0048,.0044,.0039,.0033,.0029/
C C+
      DATA XCF0/34.77,35.0,40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,
     /120.,140.,160.,200.,250.,300.,400.,500.,600.,800.,
     /1000.,1250.,1500.,1750.,2000.,2500.,3000./
      DATA YCF0/0.0,.0005,.0093,.0426,.0884,.134,.172,.193,.207,.228,
     /.245,.246,.249,.236,.222,.191,.166,.144,.134,.104,
     /.0895,.0759,.0658,.0602,.0538,.0462,.0397/
C F+
      DATA XC0F/34.5,35.0,40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,
     /120.,140.,160.,200.,250.,300.,400.,500.,600.,800.,
     /1000.,1250.,1500.,1750.,2000.,2500.,3000./
      DATA YC0F/0.0,.0019,.0085,.0271,.0561,.1051,.154,.1937,.212,.289,
     /.363,.408,.439,.461,.440,.378,.316,.264,.227,.174,
     /.170,.144,.125,.114,.102,.0874,.0753/
C CF2 2+
      DATA XCF22/42.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,120.,140.,
     /160.,200.,250.,300.,400.,500.,600.,800.,1000.,1250.,
     /1500.,1750.,2000.,2500.,3000./
      DATA YCF22/0.0,.0002,.0033,.0095,.0194,.0287,.0348,.0409,.0483,
     /.0521,
     /.0522,.0517,.0467,.0458,.0367,.0303,.0280,.0218,.0164,.0139,
     /.0120,.0110,.0098,.0084,.0073/
C ION PAIRS:
C   (C+ , F+)
      DATA XCF/63.0,70.0,80.0,90.0,100.,120.,140.,160.,200.,250.,
     /300.,400.,500.,600.,800.,1000.,1250.,1500.,1750.,2000.,
     /2500.,3000./
      DATA YCF/0.0,.002,.009,.020,.025,.038,.048,.056,.062,.059,
     /.068,.049,.043,.036,.025,.019,.016,.014,.012,.011,
     /.0096,.0082/
C   (CF+ , F+)
      DATA XCFF/43.0,50.0,60.0,70.0,80.0,90.0,100.,120.,140.,160.,
     /200.,250.,300.,400.,500.,600.,800.,1000.,1250.,1500.,
     /1750.,2000.,2500.,3000./
      DATA YCFF/0.0,.001,.009,.028,.049,.077,.084,.111,.125,.136,
     /.139,.126,.133,.109,.095,.078,.059,.040,.034,.030,
     /.027,.024,.021,.018/
C   (CF2 + , F+)
      DATA XCF2F/40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,120.,140.,
     /160.,200.,250.,300.,400.,500.,600.,800.,1000.,1250.,
     /1500.,1750.,2000.,2500.,3000./
      DATA YCF2F/0.0,.001,.004,.013,.024,.034,.043,.046,.053,.054,
     /.057,.056,.049,.050,.042,.036,.030,.023,.015,.013,
     /.011,.0104,.0093,.0080,.0069/
C   (CF3 + , F+)
      DATA XCF3F/36.0,40.0,45.0,50.0,60.0,70.0,80.0,90.0,100.,120.,
     /140.,160.,200.,250.,300.,400.,500.,600.,800.,1000.,
     /1250.,1500.,1750.,2000.,2500.,3000./
      DATA YCF3F/0.0,.001,.003,.006,.014,.023,.030,.037,.038,.042,
     /.041,.044,.045,.040,.038,.033,.028,.023,.018,.012,
     /.0105,.0091,.0083,.0074,.0064,.0055/
C CARBON K-SHELL IONISATION X-SECTION
      DATA XKSHC/285.,298.,307.,316.,325.,335.,345.,365.,398.,422.,
     /447.,473.,501.,531.,613.,668.,708.,750.,817.,917.,
     /1000.,1122.,1296.,1496.,1679.,1884.,2054.,2238.,2512.,2985.,
     /3981.,5012.,7079.,1.0D4,1.50D4,2.05D4,2.51D4,3.07D4,4.10D4,5.01D4,
     /6.13D4,7.08D4,8.18D4,1.0D5,1.54D5,2.05D5,2.99D5,4.10D5,5.01D5,
     /6.13D5,
     /7.08D5,8.18D5,1.0D6,1.25D6,1.5D6,2.05D6,3.07D6,4.10D6,5.01D6,
     /6.13D6,
     /7.08D6,8.18D6,1.0D7,1.5D7,2.05D7,3.07D7,4.10D7,5.01D7,6.13D7,
     /7.08D7,
     /8.18D7,1.0D8,1.5D8,2.05D8,3.07D8,4.10D8,5.01D8,6.13D8,7.08D8,
     /8.18D8,
     /1.0D9/
      DATA YKSHC/0.00,1.66D-4,3.48D-4,5.25D-4,6.96D-4,8.63D-4,1.02D-3,
     /1.33D-3,1.75D-3,2.01D-3,
     /2.24D-3,2.46D-3,2.66D-3,2.84D-3,3.21D-3,3.38D-3,3.47D-3,3.55D-3,
     /3.65D-3,3.72D-3,
     /3.75D-3,3.74D-3,3.68D-3,3.57D-3,3.45D-3,3.31D-3,3.19D-3,3.07D-3,
     /2.91D-3,2.66D-3,
     /2.25D-3,1.95D-3,1.55D-3,1.21D-3,8.97D-4,7.07D-4,6.07D-4,5.21D-4,
     /4.21D-4,3.63D-4,
     /3.14D-4,2.84D-4,2.57D-4,2.25D-4,1.74D-4,1.50D-4,1.28D-4,1.15D-4,
     /1.09D-4,1.05D-4,
     /1.03D-4,1.02D-4,1.01D-4,1.005D-4,1.01D-4,1.03D-4,1.07D-4,1.11D-4,
     /1.14D-4,1.17D-4,
     /1.20D-4,1.22D-4,1.25D-4,1.32D-4,1.38D-4,1.45D-4,1.50D-4,1.54D-4,
     /1.58D-4,1.60D-4,
     /1.63D-4,1.67D-4,1.74D-4,1.80D-4,1.87D-4,1.92D-4,1.96D-4,2.00D-4,
     /2.02D-4,2.05D-4,
     /2.09D-4/
C FLUORINE K-SHELL IONISATION X-SECTION
      DATA XKSHF/685.4,705.,726.,747.,770.,792.,816.,840.,865.,890.,
     /916.,944.,1000.,1090.,1188.,1296.,1496.,1679.,1884.,2054.,
     /2238.,2512.,2985.,3758.,4467.,5158.,5957.,7079.,1.0D4,1.26D4,
     /1.50D4,2.05D4,2.51D4,3.07D4,4.10D4,5.01D4,6.13D4,7.08D4,8.18D4,
     /1.0D5,
     /1.50D5,2.05D5,2.99D5,4.10D5,5.01D5,6.13D5,7.08D5,8.18D5,1.00D6,
     /1.26D6,
     /1.50D6,2.05D6,3.07D6,4.10D6,5.01D6,6.13D6,7.08D6,8.18D6,1.00D7,
     /1.26D7,
     /1.50D7,2.05D7,3.07D7,4.10D7,5.01D7,6.13D7,7.08D7,8.18D7,1.00D8,
     /1.26D8,
     /1.50D8,2.05D8,3.07D8,4.10D8,5.01D8,6.13D8,7.08D8,8.18D8,1.00D9/
      DATA YKSHF/0.00,3.39D-5,6.77D-5,1.00D-4,1.32D-4,1.63D-4,1.92D-4,
     /2.21D-4,2.48D-4,2.75D-4,
     /3.00D-4,3.25D-4,3.71D-4,4.33D-4,4.87D-4,5.34D-4,5.96D-4,6.32D-4,
     /6.57D-4,6.69D-4,
     /6.77D-4,6.79D-4,6.68D-4,6.33D-4,5.97D-4,5.62D-4,5.25D-4,4.80D-4,
     /3.93D-4,3.41D-4,
     /3.04D-4,2.45D-4,2.13D-4,1.85D-4,1.51D-4,1.31D-4,1.14D-4,1.04D-4,
     /9.46D-5,8.32D-5,
     /6.58D-5,5.60D-5,4.80D-5,4.35D-5,4.15D-5,4.00D-5,3.93D-5,3.89D-5,
     /3.85D-5,3.86D-5,
     /3.89D-5,3.98D-5,4.17D-5,4.33D-5,4.45D-5,4.58D-5,4.68D-5,4.78D-5,
     /4.92D-5,5.09D-5,
     /5.21D-5,5.45D-5,5.75D-5,5.96D-5,6.12D-5,6.27D-5,6.38D-5,6.49D-5,
     /6.64D-5,6.82D-5,
     /6.95D-5,7.19D-5,7.50D-5,7.72D-5,7.88D-5,8.03D-5,8.14D-5,8.25D-5,
     /8.40D-5/
C ATTACHMENT
      DATA XATT/4.00,4.10,5.00,6.00,7.00,8.00,9.00,10.0,11.0,
     /12.0,100./
      DATA YATT/.0,.00001,.00087,.0062,.0125,.0134,.0047,.0009,.0004,
     /.00001,.0000001/
C
C  NEUTRAL DISSOCIATION
C      DIPOLE NEUTRAL DISSOCIATION GIVEN ANALYTICALLY
C      NON-DIPOLE  NEUTRAL DISSOCIATION :
      DATA XTR1/11.5,12.5,14.0,15.0,16.0,17.0,19.0,21.0,24.0,27.0,
     /31.0,34.0/
      DATA YTR1/0.00,.005,.017,.026,.029,.031,.035,.035,.031,.026,
     /.019,.015/
      DATA XTR2/12.5,14.0,15.0,16.0,17.0,19.0,21.0,24.0,27.0,31.0,
     /34.0/
      DATA YTR2/0.00,.030,.056,.064,.068,.075,.077,.068,.057,.042,
     /.033/
      DATA XTR3/14.0,15.0,16.0,17.0,19.0,21.0,24.0,27.0,31.0,34.0,
     /39.0/
      DATA YTR3/0.00,.087,.180,.210,.237,.250,.250,.237,.187,.145,
     /.107/
C BREMSTRAHLUNG X-SECTION WITH CUT OFF
      DATA Z6T/298.,178.,85.2,47.5,26.3,12.2,7.06,4.45,3.06,2.82,
     /2.89,2.99,3.08,3.13,3.18,3.25,3.31,3.39,3.44,3.49,
     /3.52,3.54,3.55,3.57,3.57/
      DATA Z9T/573.,358.,179.,101.6,57.3,26.5,15.4,9.63,6.52,5.92,
     /6.01,6.18,6.35,6.43,6.52,6.65,6.75,6.87,6.95,7.02,
     /7.07,7.10,7.12,7.13,7.14/
      DATA EBRM/1000.,2000.,5000.,1.E4,2.E4,5.E4,1.E5,2.E5,5.E5,1.E6,
     /2.E6,3.E6,4.E6,5.E6,6.E6,8.E6,1.E7,1.5E7,2.E7,3.E7,
     /4.E7,5.E7,6.E7,8.E7,1.E8/
C ----------------------------------------------------------------------
C 2015: UPDATE INCLUDES NEW OSCILATOR STRENGTH TO EXCITATIONS WHICH
C       ARE ALL DISSOCIATIVE. INTRODUCED ALL DISSOCIATIVE IONISATION
C       CHANNELS FROM THE 3 GROUPS:  LINDSAY , NISHIMURA AND BONHAM
C       USED WEIGHTED AVERAGE TO GET CONSISTENT COUNTING AND GROSS
C       IONISATIONS.
C
C 2012: UPDATE INCLUDES CARBON AND FLUORINE K-SHELL IONISATION X-SECS.
C   NEW ANALYSIS UPDATED TO MARCH  2008
C   ALLOWS SUPERELASTIC SCATTERING TO V2,V4,V1 AND V3 VIBRATIONAL LEVELS
C   BORN ANGULAR DISTRIBUTION FOR  V4 AND V3 VIBRATIONAL LEVELS
C   INCLUDED NEW IONISATION X-SECTIONS BY NISHIMURA AND READJUSTED
C   DISSOCIATION X-SECTION TO FIT TOWNSEND MEASUREMENTS.
C   ELASTIC X-SECTION BELOW 0.6 EV ASSUMED ISOTROPIC SINCE NO ACCURATE
C   DATA EXIST ON ELASTIC SCATTERING AT THE RAMSAUER MINIMUM.
C   THE ELASTIC X-SECTION BETWEEN 0.0 AND 0.6 EV IS NOT SENSITIVE
C   ENOUGH TO DRIFT AND DIFFUSION TO ACCURATELY PREDICT THE
C   POSITION OF THE RAMSAUER MINIMUM. THE ABSOLUTE VALUE OF THE ELASTIC
C   X-SECTION BELOW THE RAMSAUER MINIMUM ( LESS THAN 0.18 EV) SEEMS TO
C   BE LOWER THAN PREDICTIONS BY MANN AND LINDER OR FIELD ET AL.
C    THE TEMPERATURE DEPENDENCE OF THE LOW FIELD MOBILITY CF GEE AND
C   FREEMAN WHICH IS REPRODUCED BY THIS X-SECTION SET SEEMS ALSO TO
C   EXCLUDE HIGHER ELASTIC X-SECTIONS IN THE REGION BETWEEN 0.02 AND
C   0.1 EV.
C   THE DATA BASE NOW FITS NAKAMURAS DRIFT VELOCITY IN CF4 AND CF4 ARGON
C   MIXTURES TO WITHIN EXPERIMENTAL ERRORS . NAKAMURAS DATA IS MUCH MORE
C   ACCURATE THAN HUNTERS DATA SO WE REJECT HUNTERS DATA IN THE NEW
C   ANALYSIS.
C   THE TOWNSEND IONISATION AND ATTACHMENT RATES AGREE WELL WITH THE
C   PUBLISHED DATA .
C ---------------------------------------------------------------
      IF(NANISO.EQ.0) THEN
       NAME=' CF4 ISOTROPIC     2015  '
      ELSE
       NAME=' CF4 ANISOTROPIC   2015  '
      ENDIF
C--------------------------------------------------------------------
C  
      AMU=1.660538921e-27

      EMASS2=1021997.804
      API=DACOS(-1.0D0)
      A0=0.52917720859D-8
      RY=13.60569193
      BBCONST=16.0*API*A0*A0*RY*RY/EMASS2
C
C BORN BETHE VALUES FOR IONISATION
      CONST=1.873884D-20
      AM2=9.50
      C=100.9
C
      NCF3=37
      NCF2=31
      NCF1=28
      NCF32=25
      NCF0=27
      NC0F=27
      NCF22=25
      NCF=22
      NCFF=24
      NCF2F=25
      NCF3F=26
C
      NION=12
      NATT=1
      NIN=46
      NNULL=0
C
C ARRAY SIZE
      NASIZE=4000
C
      NBREM=25
      DO 3 J=1,NIN
      IZBR(J)=0
    3 CONTINUE
      IZBR(47)=6
      IZBR(48)=9
c
      DO 1 J=1,6
    1 KEL(J)=NANISO
C ASSUME CAPITELLI LONGO TYPE OF ANGULAR DISTRIBUTION FOR
C  ALL VIBRATIONAL LEVELS AND THE SUM OF HIGHER HARMONICS
      DO 2 J=1,10
    2 KIN(J)=1
C ANGULAR DISTRIBUTION FOR DISS.EXCITATION IS GIVEN BY OKHRIMOVSKKY
      DO 4 J=11,NIN
    4 KIN(J)=NANISO
C RATIO OF MOMENTUM TRANSFER TO TOTAL X-SEC FOR RESONANCE
C PART OF VIBRATIONAL X-SECTIONS
      RAT=0.75
C
      NDATA=163
      NVBV4=11
      NVBV1=11
      NVBV3=11
      NVIB5=12
      NVIB6=12
      NATT1=11
      NTR1=12
      NTR2=11
      NTR3=11
      NKSHC=81
      NKSHF=79
C
      E(1)=0.0
      E(2)=2.0*EMASS/(88.0043*AMU)
      E(3)=15.90
      E(4)=0.0
      E(5)=0.0
      E(6)=0.0
C
      EION(1)=15.7
      EION(2)=21.47
      EION(3)=29.14
      EION(4)=34.5
      EION(5)=34.77
      EION(6)=36.0
      EION(7)=40.0
      EION(8)=41.0
      EION(9)=43.0
      EION(10)=63.0
      EION(11)=285.0
      EION(12)=685.4
C  OPAL BEATY IONISATION ENERGY SPLITTING
      DO 6 J=1,10
    6 EOBY(J)=0.58*EION(J)
C OPAL BEATY SPLITTING FACTOR FOR SHELLS
      EOBY(11)=210.0
      EOBY(12)=510.0
      DO 28 J=1,10
      LEGAS(J)=0
   28 ISHELL(J)=0
      LEGAS(11)=1
      LEGAS(12)=2
      ISHELL(11)=1
      ISHELL(12)=1
C SINGLE IONISATION DATA
      DO 30 J=1,5
      NC0(J)=0
      EC0(J)=0.0
      WKLM(J)=0.0
      EFL(J)=0.0
      NG1(J)=0
      EG1(J)=0.0
      NG2(J)=0
   30 EG2(J)=0.0
C DOUBLE IONISATION DATA
      DO 31 J=6,10
      NC0(J)=1.0
      EC0(J)=1.0
      WKLM(J)=0.0
      EFL(J)=0.0
      NG1(J)=0
      EG1(J)=0.0
      NG2(J)=0
   31 EG2(J)=0.0
C K SHELL DATA INCLUDING FLUORESCENCE
      NC0(11)=2
      EC0(11)=253.0
      WKLM(11)=0.0026
      EFL(11)=273.0
      NG1(11)=1
      EG1(11)=253.0
      NG2(11)=1
      EG2(11)=5.0
      NC0(12)=3
      EC0(12)=625.2
      WKLM(12)=0.010
      EFL(12)=668.
      NG1(12)=2
      EG1(12)=625.2
      NG2(12)=1
      EG2(12)=5.0
C
      DO 776 J=1,NION
      DO 777 I=1,NASIZE
      IF(EG(I).GT.EION(J)) THEN
       IOFFION(J)=I-1
       GO TO 776
      ENDIF
  777 CONTINUE
  776 CONTINUE
C
      EIN(1)=-0.0539
      EIN(2)=0.0539
      EIN(3)=-0.0783
      EIN(4)=0.0783
      EIN(5)=-0.1126
      EIN(6)=0.1126
      EIN(7)=-0.1588
      EIN(8)=0.1588
      EIN(9)=0.3176
      EIN(10)=0.4764
      EIN(11)=11.5
      EIN(12)=11.63
      EIN(13)=11.88
      EIN(14)=12.13
      EIN(15)=12.38
      EIN(16)=12.50
      EIN(17)=12.63
      EIN(18)=12.88
      EIN(19)=13.13
      EIN(20)=13.38
      EIN(21)=13.63
      EIN(22)=13.88
      EIN(23)=14.00
      EIN(24)=14.13
      EIN(25)=14.38
      EIN(26)=14.63
      EIN(27)=14.88
      EIN(28)=15.13
      EIN(29)=15.38
      EIN(30)=15.63
      EIN(31)=15.88
      EIN(32)=16.13
      EIN(33)=16.38
      EIN(34)=16.63
      EIN(35)=16.88
      EIN(36)=17.13
      EIN(37)=17.38
      EIN(38)=17.63
      EIN(39)=17.88
      EIN(40)=18.13
      EIN(41)=18.38
      EIN(42)=18.63
      EIN(43)=18.88
      EIN(44)=19.13
      EIN(45)=19.38
      EIN(46)=19.63
      EIN(47)=0.0
      EIN(48)=0.0
C OFFSET ENERGY FOR DISSOCIATION ANGULAR DISTRIBUTION
      DO 5 NL=11,46
      DO 651 I=1,NASIZE
      IF(EG(I).GT.DABS(EIN(NL))) THEN
       IOFFN(NL)=I-1
       GO TO 5
      ENDIF
  651 CONTINUE
    5 CONTINUE
C***********************************************************************
C ENTER PENNING TRANSFER FRACTION FOR EACH LEVEL
C ONLY DISSOCIATION X-SECTION (LEVEL 11) HAS ENOUGH ENERGY TO GIVE
C  POSSIBLE PENNING TRANSFER
      DO 7 K=1,46
      DO 7 L=1,3
    7 PENFRA(L,K)=0.0
C PENNING TRANSFER FRACTION FOR LEVEL 11
      PENFRA(1,K)=0.0
C PENNING TRANSFER DISTANCE IN MICRONS
      PENFRA(2,K)=1.0
C PENNING TRANSFER TIME IN PICOSECONDS
      PENFRA(3,K)=1.0
      IF(IPEN.EQ.0) GO TO 8
      IF(PENFRA(1,11).EQ.0.0) GO TO 8
      WRITE(6,999) NAME,EIN(11),PENFRA(1,11),PENFRA(2,11),PENFRA(3,11)
  999 FORMAT(' GAS = ',A15,' ENERGY LEVEL = ',F7.4,' EV.',/,' PENNING PR
     /OBABILITY = ',F5.3,' ABS.LENGTH = ',F7.2,' DECAY TIME = ',F7.1,/)
    8 CONTINUE
C***********************************************************************
      SCRPT(1)='                                                  '
      SCRPT(2)=' ELASTIC  ANISOTROPIC            CF4              '
      IF(NANISO.EQ.0) THEN
       SCRPT(2)=' ELASTIC  ISOTROPIC             CF4              '
      ENDIF
      SCRPT(3)=' ION  CF3 +                      ELOSS=   15.70   '
      SCRPT(4)=' ION  CF2 +                      ELOSS=   21.47   '
      SCRPT(5)=' ION  CF +                       ELOSS=   29.14   '
      SCRPT(6)=' ION  F +                        ELOSS=   34.5    '
      SCRPT(7)=' ION  C +                        ELOSS=   34.77   '
      SCRPT(8)=' DOUBLE ION    CF3 + , F +       ELOSS=   36.0    '
      SCRPT(9)=' DOUBLE ION    CF2 + , F +       ELOSS=   40.0    '
      SCRPT(10)=' IONS  CF3 ++ OR CF2 ++          ELOSS=   41.0    '
      SCRPT(11)=' DOUBLE ION    CF +  , F +       ELOSS=   43.0    '
      SCRPT(12)=' DOUBLE ION    C  +  , F +       ELOSS=   63.0    '
      SCRPT(13)=' IONISATION   CARBON K-SHELL     ELOSS=  285.0    '
      SCRPT(14)=' IONISATION FLUORINE K-SHELL     ELOSS=  685.4    '
      SCRPT(15)=' ATTACHMENT                                       '
      SCRPT(16)='                                                  '
      SCRPT(17)='                                                  '
      SCRPT(18)=' VIB  V2           ANISOTROPIC   ELOSS=   -0.0539 '
      SCRPT(19)=' VIB  V2           ANISOTROPIC   ELOSS=    0.0539 '
      SCRPT(20)=' VIB  V4           ANISOTROPIC   ELOSS=   -0.0783 '
      SCRPT(21)=' VIB  V4           ANISOTROPIC   ELOSS=    0.0783 '
      SCRPT(22)=' VIB  V1           ANISOTROPIC   ELOSS=   -0.1126 '
      SCRPT(23)=' VIB  V1           ANISOTROPIC   ELOSS=    0.1126 '
      SCRPT(24)=' VIB  V3           ANISOTROPIC   ELOSS=   -0.1588 '
      SCRPT(25)=' VIB  V3           ANISOTROPIC   ELOSS=    0.1588 '
      SCRPT(26)=' VIB 2V3           ANISOTROPIC   ELOSS=    0.3176 '
      SCRPT(27)=' VIB HARMONIC      ANISOTROPIC   ELOSS=    0.4764 '
      SCRPT(28)=' NEUTRAL DISS      NON-DIPOLE    ELOSS=   11.5    '
      SCRPT(29)=' NEUTRAL DISS DIPOLE F=0.000189  ELOSS=   11.63   '
      SCRPT(30)=' NEUTRAL DISS DIPOLE F=0.001085  ELOSS=   11.88   '
      SCRPT(31)=' NEUTRAL DISS DIPOLE F=0.004807  ELOSS=   12.13   '
      SCRPT(32)=' NEUTRAL DISS DIPOLE F=0.008819  ELOSS=   12.38   '
      SCRPT(33)=' NEUTRAL DISS      NON-DIPOLE    ELOSS=   12.50   '
      SCRPT(34)=' NEUTRAL DISS DIPOLE F=0.008918  ELOSS=   12.63   '
      SCRPT(35)=' NEUTRAL DISS DIPOLE F=0.008420  ELOSS=   12.88   '
      SCRPT(36)=' NEUTRAL DISS DIPOLE F=0.02531   ELOSS=   13.13   '
      SCRPT(37)=' NEUTRAL DISS DIPOLE F=0.09553   ELOSS=   13.38   '
      SCRPT(38)=' NEUTRAL DISS DIPOLE F=0.11193   ELOSS=   13.63   '
      SCRPT(39)=' NEUTRAL DISS DIPOLE F=0.10103   ELOSS=   13.88   '
      SCRPT(40)=' NEUTRAL DISS      NON-DIPOLE    ELOSS=   14.00   '
      SCRPT(41)=' NEUTRAL DISS DIPOLE F=0.06902   ELOSS=   14.13   '
      SCRPT(42)=' NEUTRAL DISS DIPOLE F=0.03968   ELOSS=   14.38   '
      SCRPT(43)=' NEUTRAL DISS DIPOLE F=0.02584   ELOSS=   14.63   '
      SCRPT(44)=' NEUTRAL DISS DIPOLE F=0.02071   ELOSS=   14.88   '
      SCRPT(45)=' NEUTRAL DISS DIPOLE F=0.03122   ELOSS=   15.13   '
      SCRPT(46)=' NEUTRAL DISS DIPOLE F=0.05580   ELOSS=   15.38   '
      SCRPT(47)=' NEUTRAL DISS DIPOLE F=0.10187   ELOSS=   15.63   '
      SCRPT(48)=' NEUTRAL DISS DIPOLE F=0.09427   ELOSS=   15.88   '
      SCRPT(49)=' NEUTRAL DISS DIPOLE F=0.05853   ELOSS=   16.13   '
      SCRPT(50)=' NEUTRAL DISS DIPOLE F=0.06002   ELOSS=   16.38   '
      SCRPT(51)=' NEUTRAL DISS DIPOLE F=0.05647   ELOSS=   16.63   '
      SCRPT(52)=' NEUTRAL DISS DIPOLE F=0.04885   ELOSS=   16.88   '
      SCRPT(53)=' NEUTRAL DISS DIPOLE F=0.04036   ELOSS=   17.13   '
      SCRPT(54)=' NEUTRAL DISS DIPOLE F=0.03298   ELOSS=   17.38   '
      SCRPT(55)=' NEUTRAL DISS DIPOLE F=0.02593   ELOSS=   17.63   '
      SCRPT(56)=' NEUTRAL DISS DIPOLE F=0.01802   ELOSS=   17.88   '
      SCRPT(57)=' NEUTRAL DISS DIPOLE F=0.01287   ELOSS=   18.13   '
      SCRPT(58)=' NEUTRAL DISS DIPOLE F=0.00830   ELOSS=   18.38   '
      SCRPT(59)=' NEUTRAL DISS DIPOLE F=0.00698   ELOSS=   18.63   '
      SCRPT(60)=' NEUTRAL DISS DIPOLE F=0.00581   ELOSS=   18.88   '
      SCRPT(61)=' NEUTRAL DISS DIPOLE F=0.00502   ELOSS=   19.13   '
      SCRPT(62)=' NEUTRAL DISS DIPOLE F=0.00398   ELOSS=   19.38   '
      SCRPT(63)=' NEUTRAL DISS DIPOLE F=0.00189   ELOSS=   19.63   '
      SCRPT(64)=' BREMSSTRAHLUNG FROM CARBON ATOM                  '
      SCRPT(65)=' BREMSSTRAHLUNG FROM FLUORINE ATOMS               '
C  VIBRATIONAL DEGENERACY
      DEGV4=3.0
      DEGV3=3.0
      DEGV2=2.0
      DEGV1=1.0
C CALC VIB LEVEL POPULATIONS
      APOPV2=DEGV2*DEXP(EIN(1)/AKT)
      APOPV4=DEGV4*DEXP(EIN(3)/AKT)
      APOPV1=DEGV1*DEXP(EIN(5)/AKT)
      APOPV3=DEGV3*DEXP(EIN(7)/AKT)
      APOPGS=1.0
      APOPSUM=APOPGS+APOPV2+APOPV4+APOPV1+APOPV3
      APOPGS=1.0/APOPSUM
      APOPV2=APOPV2/APOPSUM
      APOPV4=APOPV4/APOPSUM
      APOPV1=APOPV1/APOPSUM
      APOPV3=APOPV3/APOPSUM
C RENORMALISE GROUND STATE TO ALLOW FOR EXCITATION X-SEC FROM
C EXCITED VIBRATIONAL STATES (EXACT APPROX IF THE HOT TRANSITIONS HAVE
C EQUAL X-SEC TO THE GROUND STATE TRANSITIONS)
C
      APOPGS=1.0
C																												
C     EN=-ESTEP/2.0
      DO 9000 I=1,NSTEP
      EN=EG(I)
C     EN=EN+ESTEP
      GAMMA1=(EMASS2+2.0D0*EN)/EMASS2
      GAMMA2=GAMMA1*GAMMA1
      BETA=DSQRT(1.0D0-1.0D0/GAMMA2)
      BETA2=BETA*BETA
C
      DO 10 J=2,NDATA
      IF(EN.LE.XEN(J)) GO TO 20
   10 CONTINUE
      J=NDATA
   20 A=(YELM(J)-YELM(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YELM(J)-XEN(J)*YELM(J-1))/(XEN(J-1)-XEN(J))
      QMOM=(A*EN+B)*1.D-16
      A=(YELT(J)-YELT(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YELT(J)-XEN(J)*YELT(J-1))/(XEN(J-1)-XEN(J))
      QELA=(A*EN+B)*1.D-16
      A=(YEPS(J)-YEPS(J-1))/(XEN(J)-XEN(J-1))
      B=(XEN(J-1)*YEPS(J)-XEN(J)*YEPS(J-1))/(XEN(J-1)-XEN(J))
      PQ2=(A*EN+B)
C EPS CORRECTED FOR 1-EPS
      PQ2=1.0-PQ2
      PQ1=0.5+(QELA-QMOM)/QELA
      IF(NANISO.EQ.0) PEQEL(2,I)=0.5
      IF(NANISO.EQ.1) PEQEL(2,I)=PQ1
      IF(NANISO.EQ.2) PEQEL(2,I)=PQ2
      Q(2,I)=QELA
      IF(NANISO.EQ.0) Q(2,I)=QMOM
C  DISSOCIATIVE IONISATION
C  ION  =  CF3 +
      QION(1,I)=0.0
      PEQION(1,I)=0.5
      IF(NANISO.EQ.2) PEQION(1,I)=0.0
      IF(EN.LE.EION(1)) GO TO 45
      IF(EN.GT.XCF3(NCF3)) GO TO 43
      DO 41 J=2,NCF3
      IF(EN.LE.XCF3(J)) GO TO 42
   41 CONTINUE
      J=NCF3
   42 A=(YCF3(J)-YCF3(J-1))/(XCF3(J)-XCF3(J-1))
      B=(XCF3(J-1)*YCF3(J)-XCF3(J)*YCF3(J-1))/(XCF3(J-1)-XCF3(J))
      QION(1,I)=(A*EN+B)*1.D-16
      GO TO 44
C USE BORN BETHE X-SECTION ABOVE XCF3(NCF3) EV
   43 X2=1.0D0/BETA2
      X1=X2*DLOG(BETA2/(1.0D0-BETA2))-1.0D0
      QION(1,I)=CONST*(AM2*(X1-DEN(I)/2.0)+C*X2)*0.7344
   44 CONTINUE
      IF(EN.LE.(2.0*EION(1))) GO TO 45
      PEQION(1,I)=PEQEL(2,(I-IOFFION(1)))
C  ION = CF2 +
   45 QION(2,I)=0.0
      PEQION(2,I)=0.5
      IF(NANISO.EQ.2) PEQION(2,I)=0.0
      IF(EN.LE.EION(2)) GO TO 50
      IF(EN.GT.XCF2(NCF2)) GO TO 48
      DO 46 J=2,NCF2
      IF(EN.LE.XCF2(J)) GO TO 47
   46 CONTINUE
      J=NCF2
   47 A=(YCF2(J)-YCF2(J-1))/(XCF2(J)-XCF2(J-1))
      B=(XCF2(J-1)*YCF2(J)-XCF2(J)*YCF2(J-1))/(XCF2(J-1)-XCF2(J))
      QION(2,I)=(A*EN+B)*1.D-16
      GO TO 49
C USE BORN BETHE X-SECTION ABOVE XCF2(NCF2) EV
   48 QION(2,I)=CONST*(AM2*(X1-DEN(I)/2.0)+C*X2)*0.0534
   49 CONTINUE
      IF(EN.LE.(2.0*EION(2))) GO TO 50
      PEQION(2,I)=PEQEL(2,(I-IOFFION(2)))
C  ION = CF +
   50 QION(3,I)=0.0
      PEQION(3,I)=0.5
      IF(NANISO.EQ.2) PEQION(3,I)=0.0
      IF(EN.LE.EION(3)) GO TO 55
      IF(EN.GT.XCF1(NCF1)) GO TO 53
      DO 51 J=2,NCF1
      IF(EN.LE.XCF1(J)) GO TO 52
   51 CONTINUE
      J=NCF1
   52 A=(YCF1(J)-YCF1(J-1))/(XCF1(J)-XCF1(J-1))
      B=(XCF1(J-1)*YCF1(J)-XCF1(J)*YCF1(J-1))/(XCF1(J-1)-XCF1(J))
      QION(3,I)=(A*EN+B)*1.D-16
      GO TO 54
C USE BORN BETHE X-SECTION ABOVE XCF1(NCF1) EV
   53 QION(3,I)=CONST*(AM2*(X1-DEN(I)/2.0)+C*X2)*0.0386
   54 CONTINUE
      IF(EN.LE.(2.0*EION(3))) GO TO 55
      PEQION(3,I)=PEQEL(2,(I-IOFFION(3)))
C  ION = F +
   55 QION(4,I)=0.0
      PEQION(4,I)=0.5
      IF(NANISO.EQ.2) PEQION(4,I)=0.0
      IF(EN.LE.EION(4)) GO TO 60
      IF(EN.GT.XC0F(NC0F)) GO TO 58
      DO 56 J=2,NC0F
      IF(EN.LE.XC0F(J)) GO TO 57
   56 CONTINUE
      J=NC0F
   57 A=(YC0F(J)-YC0F(J-1))/(XC0F(J)-XC0F(J-1))
      B=(XC0F(J-1)*YC0F(J)-XC0F(J)*YC0F(J-1))/(XC0F(J-1)-XC0F(J))
      QION(4,I)=(A*EN+B)*1.D-16
      GO TO 59
C USE BORN BETHE X-SECTION ABOVE XC0F(NC0F) EV
   58 QION(4,I)=CONST*(AM2*(X1-DEN(I)/2.0)+C*X2)*0.0799
   59 CONTINUE
      IF(EN.LE.(2.0*EION(4))) GO TO 60
      PEQION(4,I)=PEQEL(2,(I-IOFFION(4)))
C  ION = C +
   60 QION(5,I)=0.0
      PEQION(5,I)=0.5
      IF(NANISO.EQ.2) PEQION(5,I)=0.0
      IF(EN.LE.EION(5)) GO TO 65
      IF(EN.GT.XCF0(NCF0)) GO TO 63
      DO 61 J=2,NCF0
      IF(EN.LE.XCF0(J)) GO TO 62
   61 CONTINUE
      J=NCF0
   62 A=(YCF0(J)-YCF0(J-1))/(XCF0(J)-XCF0(J-1))
      B=(XCF0(J-1)*YCF0(J)-XCF0(J)*YCF0(J-1))/(XCF0(J-1)-XCF0(J))
      QION(5,I)=(A*EN+B)*1.D-16
      GO TO 64
C USE BORN BETHE X-SECTION ABOVE XCF0(NCF0) EV
   63 QION(5,I)=CONST*(AM2*(X1-DEN(I)/2.0)+C*X2)*0.0422
   64 CONTINUE
      IF(EN.LE.(2.0*EION(5))) GO TO 65
      PEQION(5,I)=PEQEL(2,(I-IOFFION(5)))
C  DOUBLE IONS  CF3 +  AND F +
   65 QION(6,I)=0.0
      PEQION(6,I)=0.5
      IF(NANISO.EQ.2) PEQION(6,I)=0.0
      IF(EN.LE.EION(6)) GO TO 70
      IF(EN.GT.XCF3F(NCF3F)) GO TO 68
      DO 66 J=2,NCF3F
      IF(EN.LE.XCF3F(J)) GO TO 67
   66 CONTINUE
      J=NCF3F
   67 A=(YCF3F(J)-YCF3F(J-1))/(XCF3F(J)-XCF3F(J-1))
      B=(XCF3F(J-1)*YCF3F(J)-XCF3F(J)*YCF3F(J-1))/(XCF3F(J-1)-XCF3F(J))
      QION(6,I)=(A*EN+B)*1.D-16
      GO TO 69
C USE BORN BETHE X-SECTION ABOVE XCF3F(NCF3F) EV
   68 QION(6,I)=CONST*(AM2*(X1-DEN(I)/2.0)+C*X2)*0.0058
   69 CONTINUE
      IF(EN.LE.(2.0*EION(6))) GO TO 70
      PEQION(6,I)=PEQEL(2,(I-IOFFION(6)))
C  DOUBLE IONS  CF2 +  AND F +
   70 QION(7,I)=0.0
      PEQION(7,I)=0.5
      IF(NANISO.EQ.2) PEQION(7,I)=0.0
      IF(EN.LE.EION(7)) GO TO 75
      IF(EN.GT.XCF2F(NCF2F)) GO TO 73
      DO 71 J=2,NCF2F
      IF(EN.LE.XCF2F(J)) GO TO 72
   71 CONTINUE
      J=NCF2F
   72 A=(YCF2F(J)-YCF2F(J-1))/(XCF2F(J)-XCF2F(J-1))
      B=(XCF2F(J-1)*YCF2F(J)-XCF2F(J)*YCF2F(J-1))/(XCF2F(J-1)-XCF2F(J))
      QION(7,I)=(A*EN+B)*1.D-16
      GO TO 74
C USE BORN BETHE X-SECTION ABOVE XCF2F(NCF2F) EV
   73 QION(7,I)=CONST*(AM2*(X1-DEN(I)/2.0)+C*X2)*0.0073
   74 CONTINUE
      IF(EN.LE.(2.0*EION(7))) GO TO 75
      PEQION(7,I)=PEQEL(2,(I-IOFFION(7)))
C  DOUBLE CHARGED ION  CF3 ++
   75 QION(8,I)=0.0
      PEQION(8,I)=0.5
      IF(NANISO.EQ.2) PEQION(8,I)=0.0
      IF(EN.LE.EION(8)) GO TO 80
      IF(EN.GT.XCF32(NCF32)) GO TO 78
      DO 76 J=2,NCF32
      IF(EN.LE.XCF32(J)) GO TO 77
   76 CONTINUE
      J=NCF32
   77 A=(YCF32(J)-YCF32(J-1))/(XCF32(J)-XCF32(J-1))
      B=(XCF32(J-1)*YCF32(J)-XCF32(J)*YCF32(J-1))/(XCF32(J-1)-XCF32(J))
      QION(8,I)=(A*EN+B)*1.D-16
      GO TO 79
C USE BORN BETHE X-SECTION ABOVE XCF32(NCF32) EV
   78 QION(8,I)=CONST*(AM2*(X1-DEN(I)/2.0)+C*X2)*0.0031
   79 CONTINUE
      IF(EN.LE.(2.0*EION(8))) GO TO 80
      PEQION(8,I)=PEQEL(2,(I-IOFFION(8)))
C  DOUBLE CHARGED ION  CF2 ++
C
C  ADD INTO CF3 ++
C
   80 IF(EN.LE.XCF22(1)) GO TO 85
      IF(EN.GT.XCF22(NCF22)) GO TO 83
      DO 81 J=2,NCF22
      IF(EN.LE.XCF22(J)) GO TO 82
   81 CONTINUE
      J=NCF22
   82 A=(YCF22(J)-YCF22(J-1))/(XCF22(J)-XCF22(J-1))
      B=(XCF22(J-1)*YCF22(J)-XCF22(J)*YCF22(J-1))/(XCF22(J-1)-XCF22(J))
      QION(8,I)=QION(8,I)+(A*EN+B)*1.D-16
      GO TO 85
C USE BORN BETHE X-SECTION ABOVE XCF22(NCF22) EV
   83 QION(8,I)=QION(8,I)+CONST*(AM2*(X1-DEN(I)/2.0)+C*X2)*0.0077
C  DOUBLE IONS    CF +  AND F +
   85 QION(9,I)=0.0
      PEQION(9,I)=0.5
      IF(NANISO.EQ.2) PEQION(9,I)=0.0
      IF(EN.LE.EION(9)) GO TO 90
      IF(EN.GT.XCFF(NCFF)) GO TO 88
      DO 86 J=2,NCFF
      IF(EN.LE.XCFF(J)) GO TO 87
   86 CONTINUE
      J=NCFF
   87 A=(YCFF(J)-YCFF(J-1))/(XCFF(J)-XCFF(J-1))
      B=(XCFF(J-1)*YCFF(J)-XCFF(J)*YCFF(J-1))/(XCFF(J-1)-XCFF(J))
      QION(9,I)=(A*EN+B)*1.D-16
      GO TO 89
C USE BORN BETHE X-SECTION ABOVE XCFF(NCFF) EV
   88 QION(9,I)=CONST*(AM2*(X1-DEN(I)/2.0)+C*X2)*0.0189
   89 CONTINUE
      IF(EN.LE.(2.0*EION(9))) GO TO 90
      PEQION(9,I)=PEQEL(2,(I-IOFFION(9)))
C  DOUBLE IONS    C +  AND F +
   90 QION(10,I)=0.0
      PEQION(10,I)=0.5
      IF(NANISO.EQ.2) PEQION(10,I)=0.0
      IF(EN.LE.EION(10)) GO TO 95
      IF(EN.GT.XCF(NCF)) GO TO 93
      DO 91 J=2,NCF
      IF(EN.LE.XCF(J)) GO TO 92
   91 CONTINUE
      J=NCF
   92 A=(YCF(J)-YCF(J-1))/(XCF(J)-XCF(J-1))
      B=(XCF(J-1)*YCF(J)-XCF(J)*YCF(J-1))/(XCF(J-1)-XCF(J))
      QION(10,I)=(A*EN+B)*1.D-16
      GO TO 94
C USE BORN BETHE X-SECTION ABOVE XCF(NCF) EV
   93 QION(10,I)=CONST*(AM2*(X1-DEN(I)/2.0)+C*X2)*0.0087
   94 CONTINUE
      IF(EN.LE.(2.0*EION(10))) GO TO 95
      PEQION(10,I)=PEQEL(2,(I-IOFFION(10)))
C CARBON K-SHELL IONISATION
   95 QION(11,I)=0.0
      PEQION(11,I)=0.5
      IF(NANISO.EQ.2) PEQION(11,I)=0.0
      IF(EN.LE.EION(11)) GO TO 135
      DO 130 J=2,NKSHC
      IF(EN.LE.XKSHC(J)) GO TO 131
  130 CONTINUE
      J=NKSHC
  131 A=(YKSHC(J)-YKSHC(J-1))/(XKSHC(J)-XKSHC(J-1))
      B=(XKSHC(J-1)*YKSHC(J)-XKSHC(J)*YKSHC(J-1))/(XKSHC(J-1)-XKSHC(J))
      QION(11,I)=(A*EN+B)*1.D-16
      IF(EN.LE.(2.0*EION(11))) GO TO 135
      PEQION(11,I)=PEQEL(2,(I-IOFFION(11)))
C FLUORINE K-SHELL IONISATION
  135 QION(12,I)=0.0
      PEQION(12,I)=0.5
      IF(NANISO.EQ.2) PEQION(12,I)=0.0
      IF(EN.LE.EION(12)) GO TO 145
      DO 140 J=2,NKSHF
      IF(EN.LE.XKSHF(J)) GO TO 141
  140 CONTINUE
      J=NKSHF
  141 A=(YKSHF(J)-YKSHF(J-1))/(XKSHF(J)-XKSHF(J-1))
      B=(XKSHF(J-1)*YKSHF(J)-XKSHF(J)*YKSHF(J-1))/(XKSHF(J-1)-XKSHF(J))
C FACTOR OF 4 FROM NUMBER OF FLUORINE ATOMS IN MOLECULE
      QION(12,I)=4.0*(A*EN+B)*1.D-16
      IF(EN.LE.(2.0*EION(12))) GO TO 145
      PEQION(12,I)=PEQEL(2,(I-IOFFION(12)))
C
C ATTACHMENT
  145 Q(4,I)=0.0
      IF(EN.LE.XATT(1)) GO TO 250
      IF(EN.GT.XATT(NATT1)) GO TO 250
      DO 210 J=2,NATT1
      IF(EN.LE.XATT(J)) GO TO 220
  210 CONTINUE
      J=NATT1
  220 A=(YATT(J)-YATT(J-1))/(XATT(J)-XATT(J-1))
      B=(XATT(J-1)*YATT(J)-XATT(J)*YATT(J-1))/(XATT(J-1)-XATT(J))
      Q(4,I)=(A*EN+B)*1.D-16
      QATT(1,I)=Q(4,I)
C
  250 Q(5,I)=0.0
      Q(6,I)=0.0
C SCALE FACTOR FOR VIBRATIONAL DIPOLE V3 ABOVE 0.4EV
      VDSC=1.0
      IF(EN.GT.0.4) THEN
       EPR=EN
       IF(EN.GT.5.0) EPR=5.0
       VDSC=(14.4-EPR)/14.0
      ENDIF
C
C SUPERELASTIC OF VIBRATION V2 ISOTROPIC  BELOW 100EV
C
      QIN(1,I)=0.0
      PEQIN(1,I)=0.5
      IF(EN.LE.0.0) GO TO 350
      EFAC=DSQRT(1.0-(EIN(1)/EN))
      QIN(1,I)=0.007*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(1,I)=QIN(1,I)*APOPV2*1.D-16/DEGV2

      IF(EN.GT.100.0) PEQIN(1,I)=PQ1
  350 CONTINUE
C VIBRATION V2 ISOTROPIC BELOW 100EV
      QIN(2,I)=0.0
      PEQIN(2,I)=0.5
      IF(EN.LE.EIN(2)) GO TO 400
      EFAC=DSQRT(1.0-(EIN(2)/EN))
      QIN(2,I)=0.007*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(2,I)=QIN(2,I)*APOPGS*1.D-16
      IF(EN.GT.100.0) PEQIN(2,I)=PQ1
  400 CONTINUE
C
C SUPERELASTIC OF VIBRATION V4 ISOTROPIC BELOW 100EV
C
      QIN(3,I)=0.0
      PEQIN(3,I)=0.5
      IF(EN.LE.0.0) GO TO 450
      IF((EN-EIN(3)).GT.XVBV4(NVBV4)) GO TO 424
      DO 410 J=2,NVBV4
      IF((EN-EIN(3)).LE.XVBV4(J)) GO TO 420
  410 CONTINUE
      J=NVBV4
  420 A=(YVBV4(J)-YVBV4(J-1))/(XVBV4(J)-XVBV4(J-1))
      B=(XVBV4(J-1)*YVBV4(J)-XVBV4(J)*YVBV4(J-1))/(XVBV4(J-1)-XVBV4(J))
      QIN(3,I)=(EN-EIN(3))*(A*(EN-EIN(3))+B)/EN
      GO TO 425
  424 QIN(3,I)=YVBV4(NVBV4)*(XVBV4(NVBV4)/(EN*(EN-EIN(3)))**2)
  425 CONTINUE
      EFAC=DSQRT(1.0-(EIN(3)/EN))
      QIN(3,I)=QIN(3,I)+0.0500*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(3,I)=QIN(3,I)*APOPV4*1.D-16/DEGV4
      IF(EN.GT.100.0) PEQIN(3,I)=PQ1
  450 CONTINUE
C VIBRATION V4 ANISOTROPIC
      QIN(4,I)=0.0
      PEQIN(4,I)=0.5
      IF(EN.LE.EIN(4)) GO TO 500
      IF(EN.GT.XVBV4(NVBV4)) GO TO 474
      DO 460 J=2,NVBV4
      IF(EN.LE.XVBV4(J)) GO TO 470
  460 CONTINUE
      J=NVBV4
  470 A=(YVBV4(J)-YVBV4(J-1))/(XVBV4(J)-XVBV4(J-1))
      B=(XVBV4(J-1)*YVBV4(J)-XVBV4(J)*YVBV4(J-1))/(XVBV4(J-1)-XVBV4(J))
      QIN(4,I)=A*EN+B
      GO TO 475
  474 QIN(4,I)=YVBV4(NVBV4)*(XVBV4(NVBV4)/EN)**3
  475 CONTINUE
      EFAC=DSQRT(1.0-(EIN(4)/EN))
      ADIP=0.0500*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      ELF=EN-EIN(4)
      FWD=DLOG((EN+ELF)/(EN+ELF-2.0*DSQRT(EN*ELF)))
      BCK=DLOG((EN+ELF+2.0*DSQRT(EN*ELF))/(EN+ELF))
C RATIO OF MT TO TOTAL X-SECT FOR RESONANCE PART = RAT
      XMT=((1.5-FWD/(FWD+BCK))*ADIP+RAT*QIN(4,I))*APOPGS*1.D-16
      QIN(4,I)=(QIN(4,I)+ADIP)*APOPGS*1.D-16
      IF(EN.LE.100.0) PEQIN(4,I)=0.5+(QIN(4,I)-XMT)/QIN(4,I)
      IF(EN.GT.100.0) PEQIN(4,I)=PQ1
  500 CONTINUE
C SUPERELASTIC OF VIBRATION V1 ISOTROPIC BELOW 100EV
      QIN(5,I)=0.0
      PEQIN(5,I)=0.5
      IF(EN.LE.0.0) GO TO 550
      IF((EN-EIN(5)).GT.XVBV1(NVBV1)) GO TO 524
      DO 510 J=2,NVBV1
      IF((EN-EIN(5)).LE.XVBV1(J)) GO TO 520
  510 CONTINUE
      J=NVBV1
  520 A=(YVBV1(J)-YVBV1(J-1))/(XVBV1(J)-XVBV1(J-1))
      B=(XVBV1(J-1)*YVBV1(J)-XVBV1(J)*YVBV1(J-1))/(XVBV1(J-1)-XVBV1(J))
      QIN(5,I)=(EN-EIN(5))*(A*(EN-EIN(5))+B)/EN
      GO TO 525
  524 QIN(5,I)=YVBV1(NVBV1)*(XVBV1(NVBV1)/(EN*(EN-EIN(5)))**2)
  525 CONTINUE
      EFAC=DSQRT(1.0-(EIN(5)/EN))
      QIN(5,I)=QIN(5,I)+0.0224*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(5,I)=QIN(5,I)*APOPV1*1.D-16/DEGV1
      IF(EN.GT.100.0) PEQIN(5,I)=PQ1
  550 CONTINUE
C  VIBRATION V1  ISOTROPIC BELOW 100EV
      QIN(6,I)=0.0
      PEQIN(6,I)=0.5
      IF(EN.LE.EIN(6)) GO TO 600
      IF(EN.GT.XVBV1(NVBV1)) GO TO 574
      DO 560 J=2,NVBV1
      IF(EN.LE.XVBV1(J)) GO TO 570
  560 CONTINUE
      J=NVBV1
  570 A=(YVBV1(J)-YVBV1(J-1))/(XVBV1(J)-XVBV1(J-1))
      B=(XVBV1(J-1)*YVBV1(J)-XVBV1(J)*YVBV1(J-1))/(XVBV1(J-1)-XVBV1(J))
      QIN(6,I)=A*EN+B
      GO TO 575
  574 QIN(6,I)=YVBV1(NVBV1)*(XVBV1(NVBV1)/EN)**3
  575 CONTINUE
      EFAC=DSQRT(1.0-(EIN(6)/EN))
      QIN(6,I)=QIN(6,I)+0.0224*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      QIN(6,I)=QIN(6,I)*APOPGS*1.D-16
      IF(EN.GT.100.0) PEQIN(6,I)=PQ1
  600 CONTINUE
C SUPERELASTIC OF VIBRATION V3 ISOTROPIC BELOW 100EV
      QIN(7,I)=0.0
      PEQIN(7,I)=0.5
      IF(EN.LE.0.0) GO TO 650
      IF((EN-EIN(7)).GT.XVBV3(NVBV3)) GO TO 624
      DO 610 J=2,NVBV3
      IF((EN-EIN(7)).LE.XVBV3(J)) GO TO 620
  610 CONTINUE
      J=NVBV3
  620 A=(YVBV3(J)-YVBV3(J-1))/(XVBV3(J)-XVBV3(J-1))
      B=(XVBV3(J-1)*YVBV3(J)-XVBV3(J)*YVBV3(J-1))/(XVBV3(J-1)-XVBV3(J))
      QIN(7,I)=(EN-EIN(7))*(A*(EN-EIN(7))+B)/EN
      GO TO 625
  624 QIN(7,I)=YVBV3(NVBV3)*(XVBV3(NVBV3)/(EN*(EN-EIN(7)))**2)
  625 CONTINUE
      EFAC=DSQRT(1.0-(EIN(7)/EN))
      QIN(7,I)=QIN(7,I)+VDSC*1.610*DLOG((EFAC+1.0)/(EFAC-1.0))/EN
      QIN(7,I)=QIN(7,I)*APOPV3*1.D-16/DEGV3
      IF(EN.GT.100.0) PEQIN(7,I)=PQ1
  650 CONTINUE
C VIBRATION V3 ANISOTROPIC
      QIN(8,I)=0.0
      PEQIN(8,I)=0.5
      IF(EN.LE.EIN(8)) GO TO 700
      IF(EN.GT.XVBV3(NVBV3)) GO TO 674
      DO 660 J=2,NVBV3
      IF(EN.LE.XVBV3(J)) GO TO 670
  660 CONTINUE
      J=NVBV3
  670 A=(YVBV3(J)-YVBV3(J-1))/(XVBV3(J)-XVBV3(J-1))
      B=(XVBV3(J-1)*YVBV3(J)-XVBV3(J)*YVBV3(J-1))/(XVBV3(J-1)-XVBV3(J))
      QIN(8,I)=A*EN+B
      GO TO 675
  674 QIN(8,I)=YVBV3(NVBV3)*(XVBV3(NVBV3)/EN)**3
  675 CONTINUE
      EFAC=DSQRT(1.0-(EIN(8)/EN))
      ADIP=VDSC*1.610*DLOG((1.0+EFAC)/(1.0-EFAC))/EN
      ELF=EN-EIN(8)
      FWD=DLOG((EN+ELF)/(EN+ELF-2.0*DSQRT(EN*ELF)))
      BCK=DLOG((EN+ELF+2.0*DSQRT(EN*ELF))/(EN+ELF))
C   ASSUME RATIO MOM T./ TOT X-SECT FOR RESONANCE PART = RAT
      XMT=((1.5-FWD/(FWD+BCK))*ADIP+RAT*QIN(8,I))*APOPGS*1.D-16
      QIN(8,I)=(QIN(8,I)+ADIP)*APOPGS*1.D-16
      IF(EN.LE.100.0) PEQIN(8,I)=0.5+(QIN(8,I)-XMT)/QIN(8,I)
      IF(EN.GT.100.0) PEQIN(8,I)=PQ1
  700 CONTINUE
C VIBRATION HARMONIC 2V3
      QIN(9,I)=0.0
      PEQIN(9,I)=0.5
      IF(EN.LE.EIN(9)) GO TO 800
      IF(EN.GT.XVIB5(NVIB5)) GO TO 724
      DO 710 J=2,NVIB5
      IF(EN.LE.XVIB5(J)) GO TO 720
  710 CONTINUE
      J=NVIB5
  720 A=(YVIB5(J)-YVIB5(J-1))/(XVIB5(J)-XVIB5(J-1))
      B=(XVIB5(J-1)*YVIB5(J)-XVIB5(J)*YVIB5(J-1))/(XVIB5(J-1)-XVIB5(J))
      QIN(9,I)=(A*EN+B)
      GO TO 725
  724 QIN(9,I)=YVIB5(NVIB5)*(XVIB5(NVIB5)/EN)
  725 CONTINUE
      QIN(9,I)=QIN(9,I)*APOPGS*1.D-16
      IF(EN.LE.100.0) PEQIN(9,I)=0.5+(1.0-RAT)
      IF(EN.GT.100.0) PEQIN(9,I)=PQ1
  800 CONTINUE
C VIBRATION HARMONIC 3V3
      QIN(10,I)=0.0
      PEQIN(10,I)=0.5
      IF(EN.LE.EIN(10)) GO TO 900
      IF(EN.GT.XVIB6(NVIB6)) GO TO 824
      DO 810 J=2,NVIB6
      IF(EN.LE.XVIB6(J)) GO TO 820
  810 CONTINUE
      J=NVIB6
  820 A=(YVIB6(J)-YVIB6(J-1))/(XVIB6(J)-XVIB6(J-1))
      B=(XVIB6(J-1)*YVIB6(J)-XVIB6(J)*YVIB6(J-1))/(XVIB6(J-1)-XVIB6(J))
      QIN(10,I)=(A*EN+B)
      GO TO 825
  824 QIN(10,I)=YVIB6(NVIB6)*(XVIB6(NVIB6)/EN)
  825 CONTINUE
      QIN(10,I)=QIN(10,I)*APOPGS*1.D-16
      IF(EN.LE.100.0) PEQIN(10,I)=0.5+(1.0-RAT)
      IF(EN.GT.100.0) PEQIN(10,I)=PQ1
  900 CONTINUE
C
C TRIPLET NEUTRAL DISSOCIATION ELOSS=11.5 EV
      QIN(11,I)=0.0
      PEQIN(11,I)=0.0
      IF(EN.LE.EIN(11)) GO TO 903
      IF(EN.GT.XTR1(NTR1)) GO TO 9025
      DO 901 J=2,NTR1
      IF(EN.LE.XTR1(J)) GO TO 902
  901 CONTINUE
      J=NTR1
  902 A=(YTR1(J)-YTR1(J-1))/(XTR1(J)-XTR1(J-1))
      B=(XTR1(J-1)*YTR1(J)-XTR1(J)*YTR1(J-1))/(XTR1(J-1)-XTR1(J))
      QIN(11,I)=(A*EN+B)*1.D-16
      GO TO 9026
 9025 QIN(11,I)=YTR1(NTR1)*(XTR1(NTR1)/EN)**2*1.D-16
 9026 IF(EN.LE.(3.0*EIN(11))) GO TO 903
      PEQIN(11,I)=PEQEL(2,(I-IOFFN(11)))
C SINGLET NEUTRAL DISSOCIATION  ELOSS=11.63 EV     F=0.0001893
  903 QIN(12,I)=0.0
      PEQIN(12,I)=0.0
      IF(EN.LE.EIN(12)) GO TO 904
      QIN(12,I)=.0001893/(EIN(12)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(12)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(12)+E(3))*1.0107
      IF(QIN(12,I).LT.0.0) QIN(12,I)=0.0
      IF(EN.LE.(3.0*EIN(12))) GO TO 904
      PEQIN(12,I)=PEQEL(2,(I-IOFFN(12)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=11.88 EV     F=0.001085
  904 QIN(13,I)=0.0
      PEQIN(13,I)=0.0
      IF(EN.LE.EIN(13)) GO TO 905
      QIN(13,I)=0.001085/(EIN(13)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(13)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(13)+E(3))*1.0105
      IF(QIN(13,I).LT.0.0) QIN(13,I)=0.0
      IF(EN.LE.(3.0*EIN(13))) GO TO 905
      PEQIN(13,I)=PEQEL(2,(I-IOFFN(13)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=12.13 EV     F=0.004807
  905 QIN(14,I)=0.0
      PEQIN(14,I)=0.0
      IF(EN.LE.EIN(14)) GO TO 906
      QIN(14,I)=0.004807/(EIN(14)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(14)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(14)+E(3))*1.0103
      IF(QIN(14,I).LT.0.0) QIN(14,I)=0.0
      IF(EN.LE.(3.0*EIN(14))) GO TO 906
      PEQIN(14,I)=PEQEL(2,(I-IOFFN(14)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=12.38 EV     F=0.008819
  906 QIN(15,I)=0.0
      PEQIN(15,I)=0.0
      IF(EN.LE.EIN(15)) GO TO 907
      QIN(15,I)=0.008819/(EIN(15)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(15)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(15)+E(3))*1.0101
      IF(QIN(15,I).LT.0.0) QIN(15,I)=0.0
      IF(EN.LE.(3.0*EIN(15))) GO TO 907
      PEQIN(15,I)=PEQEL(2,(I-IOFFN(15)))
C TRIPLET NEUTRAL DISSOCIATION ELOSS=12.5 EV
  907 QIN(16,I)=0.0
      PEQIN(16,I)=0.0
      IF(EN.LE.EIN(16)) GO TO 910
      IF(EN.GT.XTR2(NTR2)) GO TO 9095
      DO 908 J=2,NTR2
      IF(EN.LE.XTR2(J)) GO TO 909
  908 CONTINUE
      J=NTR2
  909 A=(YTR2(J)-YTR2(J-1))/(XTR2(J)-XTR2(J-1))
      B=(XTR2(J-1)*YTR2(J)-XTR2(J)*YTR2(J-1))/(XTR2(J-1)-XTR2(J))
      QIN(16,I)=(A*EN+B)*1.D-16
      GO TO 9096
 9095 QIN(16,I)=YTR2(NTR2)*(XTR2(NTR2)/EN)**2*1.D-16
 9096 IF(EN.LE.(3.0*EIN(16))) GO TO 910
      PEQIN(16,I)=PEQEL(2,(I-IOFFN(16)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=12.63 EV     F=0.008918
  910 QIN(17,I)=0.0
      PEQIN(17,I)=0.0
      IF(EN.LE.EIN(17)) GO TO 911
      QIN(17,I)=0.008918/(EIN(17)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(17)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(17)+E(3))*1.0099
      IF(QIN(17,I).LT.0.0) QIN(17,I)=0.0
      IF(EN.LE.(3.0*EIN(17))) GO TO 911
      PEQIN(17,I)=PEQEL(2,(I-IOFFN(17)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=12.88 EV     F=0.008420
  911 QIN(18,I)=0.0
      PEQIN(18,I)=0.0
      IF(EN.LE.EIN(18)) GO TO 912
      QIN(18,I)=0.008420/(EIN(18)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(18)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(18)+E(3))*1.0097
      IF(QIN(18,I).LT.0.0) QIN(18,I)=0.0
      IF(EN.LE.(3.0*EIN(18))) GO TO 912
      PEQIN(18,I)=PEQEL(2,(I-IOFFN(18)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=13.13 EV     F=0.02531
  912 QIN(19,I)=0.0
      PEQIN(19,I)=0.0
      IF(EN.LE.EIN(19)) GO TO 913
      QIN(19,I)=0.02531/(EIN(19)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(19)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(19)+E(3))*1.0095
      IF(QIN(19,I).LT.0.0) QIN(19,I)=0.0
      IF(EN.LE.(3.0*EIN(19))) GO TO 913
      PEQIN(19,I)=PEQEL(2,(I-IOFFN(19)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=13.38 EV     F=0.09553
  913 QIN(20,I)=0.0
      PEQIN(20,I)=0.0
      IF(EN.LE.EIN(20)) GO TO 914
      QIN(20,I)=0.09553/(EIN(20)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(20)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(20)+E(3))*1.0093
      IF(QIN(20,I).LT.0.0) QIN(20,I)=0.0
      IF(EN.LE.(3.0*EIN(20))) GO TO 914
      PEQIN(20,I)=PEQEL(2,(I-IOFFN(20)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=13.63 EV     F=0.11193
  914 QIN(21,I)=0.0
      PEQIN(21,I)=0.0
      IF(EN.LE.EIN(21)) GO TO 915
      QIN(21,I)=0.11193/(EIN(21)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(21)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(21)+E(3))*1.0092
      IF(QIN(21,I).LT.0.0) QIN(21,I)=0.0
      IF(EN.LE.(3.0*EIN(21))) GO TO 915
      PEQIN(21,I)=PEQEL(2,(I-IOFFN(21)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=13.88 EV     F=0.10103
  915 QIN(22,I)=0.0
      PEQIN(22,I)=0.0
      IF(EN.LE.EIN(22)) GO TO 916
      QIN(22,I)=0.10103/(EIN(22)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(22)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(22)+E(3))*1.0090
      IF(QIN(22,I).LT.0.0) QIN(22,I)=0.0
      IF(EN.LE.(3.0*EIN(22))) GO TO 916
      PEQIN(22,I)=PEQEL(2,(I-IOFFN(22)))
C TRIPLET NEUTRAL DISSOCIATION ELOSS=14.0 EV
  916 QIN(23,I)=0.0
      PEQIN(23,I)=0.0
      IF(EN.LE.EIN(23)) GO TO 919
      IF(EN.GT.XTR3(NTR3)) GO TO 9185
      DO 917 J=2,NTR3
      IF(EN.LE.XTR3(J)) GO TO 918
  917 CONTINUE
      J=NTR3
  918 A=(YTR3(J)-YTR3(J-1))/(XTR3(J)-XTR3(J-1))
      B=(XTR3(J-1)*YTR3(J)-XTR3(J)*YTR3(J-1))/(XTR3(J-1)-XTR3(J))
      QIN(23,I)=(A*EN+B)*1.D-16
      GO TO 9186
 9185 QIN(23,I)=YTR3(NTR3)*(XTR3(NTR3)/EN)**2*1.D-16
 9186 IF(EN.LE.(3.0*EIN(23))) GO TO 919
      PEQIN(23,I)=PEQEL(2,(I-IOFFN(23)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=14.13 EV     F=0.06902
  919 QIN(24,I)=0.0
      PEQIN(24,I)=0.0
      IF(EN.LE.EIN(24)) GO TO 920
      QIN(24,I)=0.06902/(EIN(24)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(24)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(24)+E(3))*1.0088
      IF(QIN(24,I).LT.0.0) QIN(24,I)=0.0
      IF(EN.LE.(3.0*EIN(24))) GO TO 920
      PEQIN(24,I)=PEQEL(2,(I-IOFFN(24)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=14.38 EV     F=0.03968
  920 QIN(25,I)=0.0
      PEQIN(25,I)=0.0
      IF(EN.LE.EIN(25)) GO TO 921
      QIN(25,I)=0.03968/(EIN(25)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(25)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(25)+E(3))*1.0087
      IF(QIN(25,I).LT.0.0) QIN(25,I)=0.0
      IF(EN.LE.(3.0*EIN(25))) GO TO 921
      PEQIN(25,I)=PEQEL(2,(I-IOFFN(25)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=14.63 EV     F=0.02584
  921 QIN(26,I)=0.0
      PEQIN(26,I)=0.0
      IF(EN.LE.EIN(26)) GO TO 922
      QIN(26,I)=0.02584/(EIN(26)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(26)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(26)+E(3))*1.0085
      IF(QIN(26,I).LT.0.0) QIN(26,I)=0.0
      IF(EN.LE.(3.0*EIN(26))) GO TO 922
      PEQIN(26,I)=PEQEL(2,(I-IOFFN(26)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=14.88 EV     F=0.02071
  922 QIN(27,I)=0.0
      PEQIN(27,I)=0.0
      IF(EN.LE.EIN(27)) GO TO 923
      QIN(27,I)=0.02071/(EIN(27)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(27)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(27)+E(3))*1.0084
      IF(QIN(27,I).LT.0.0) QIN(27,I)=0.0
      IF(EN.LE.(3.0*EIN(27))) GO TO 923
      PEQIN(27,I)=PEQEL(2,(I-IOFFN(27)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=15.13 EV     F=0.03122
  923 QIN(28,I)=0.0
      PEQIN(28,I)=0.0
      IF(EN.LE.EIN(28)) GO TO 924
      QIN(28,I)=0.03122/(EIN(28)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(28)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(28)+E(3))*1.0083
      IF(QIN(28,I).LT.0.0) QIN(28,I)=0.0
      IF(EN.LE.(3.0*EIN(28))) GO TO 924
      PEQIN(28,I)=PEQEL(2,(I-IOFFN(28)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=15.38 EV     F=0.05580
  924 QIN(29,I)=0.0
      PEQIN(29,I)=0.0
      IF(EN.LE.EIN(29)) GO TO 925
      QIN(29,I)=0.05580/(EIN(29)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(29)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(29)+E(3))*1.0081
      IF(QIN(29,I).LT.0.0) QIN(29,I)=0.0
      IF(EN.LE.(3.0*EIN(29))) GO TO 925
      PEQIN(29,I)=PEQEL(2,(I-IOFFN(29)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=15.63 EV     F=0.10187
  925 QIN(30,I)=0.0
      PEQIN(30,I)=0.0
      IF(EN.LE.EIN(30)) GO TO 926
      QIN(30,I)=0.10187/(EIN(30)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(30)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(30)+E(3))*1.0080
      IF(QIN(30,I).LT.0.0) QIN(30,I)=0.0
      IF(EN.LE.(3.0*EIN(30))) GO TO 926
      PEQIN(30,I)=PEQEL(2,(I-IOFFN(30)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=15.88 EV     F=0.09427
  926 QIN(31,I)=0.0
      PEQIN(31,I)=0.0
      IF(EN.LE.EIN(31)) GO TO 927
      QIN(31,I)=0.09427/(EIN(31)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(31)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(31)+E(3))*1.0079
      IF(QIN(31,I).LT.0.0) QIN(31,I)=0.0
      IF(EN.LE.(3.0*EIN(31))) GO TO 927
      PEQIN(31,I)=PEQEL(2,(I-IOFFN(31)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=16.13 EV     F=0.05853
  927 QIN(32,I)=0.0
      PEQIN(32,I)=0.0
      IF(EN.LE.EIN(32)) GO TO 928
      QIN(32,I)=0.05853/(EIN(32)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(32)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(32)+E(3))*1.0077
      IF(QIN(32,I).LT.0.0) QIN(32,I)=0.0
      IF(EN.LE.(3.0*EIN(32))) GO TO 928
      PEQIN(32,I)=PEQEL(2,(I-IOFFN(32)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=16.38 EV     F=0.06002
  928 QIN(33,I)=0.0
      PEQIN(33,I)=0.0
      IF(EN.LE.EIN(33)) GO TO 929
      QIN(33,I)=0.06002/(EIN(33)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(33)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(33)+E(3))*1.0076
      IF(QIN(33,I).LT.0.0) QIN(33,I)=0.0
      IF(EN.LE.(3.0*EIN(33))) GO TO 929
      PEQIN(33,I)=PEQEL(2,(I-IOFFN(33)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=16.63 EV     F=0.05647
  929 QIN(34,I)=0.0
      PEQIN(34,I)=0.0
      IF(EN.LE.EIN(34)) GO TO 930
      QIN(34,I)=0.05647/(EIN(34)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(34)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(34)+E(3))*1.0075
      IF(QIN(34,I).LT.0.0) QIN(34,I)=0.0
      IF(EN.LE.(3.0*EIN(34))) GO TO 930
      PEQIN(34,I)=PEQEL(2,(I-IOFFN(34)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=16.88 EV     F=0.04885
  930 QIN(35,I)=0.0
      PEQIN(35,I)=0.0
      IF(EN.LE.EIN(35)) GO TO 931
      QIN(35,I)=0.04885/(EIN(35)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(35)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(35)+E(3))*1.0074
      IF(QIN(35,I).LT.0.0) QIN(35,I)=0.0
      IF(EN.LE.(3.0*EIN(35))) GO TO 931
      PEQIN(35,I)=PEQEL(2,(I-IOFFN(35)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=17.13 EV     F=0.04036
  931 QIN(36,I)=0.0
      PEQIN(36,I)=0.0
      IF(EN.LE.EIN(36)) GO TO 932
      QIN(36,I)=0.04036/(EIN(36)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(36)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(36)+E(3))*1.0073
      IF(QIN(36,I).LT.0.0) QIN(36,I)=0.0
      IF(EN.LE.(3.0*EIN(36))) GO TO 932
      PEQIN(36,I)=PEQEL(2,(I-IOFFN(36)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=17.38 EV     F=0.03298
  932 QIN(37,I)=0.0
      PEQIN(37,I)=0.0
      IF(EN.LE.EIN(37)) GO TO 933
      QIN(37,I)=0.03298/(EIN(37)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(37)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(37)+E(3))*1.0072
      IF(QIN(37,I).LT.0.0) QIN(37,I)=0.0
      IF(EN.LE.(3.0*EIN(37))) GO TO 933
      PEQIN(37,I)=PEQEL(2,(I-IOFFN(37)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=17.63 EV     F=0.02593
  933 QIN(38,I)=0.0
      PEQIN(38,I)=0.0
      IF(EN.LE.EIN(38)) GO TO 934
      QIN(38,I)=0.02593/(EIN(38)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(38)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(38)+E(3))*1.0071
      IF(QIN(38,I).LT.0.0) QIN(38,I)=0.0
      IF(EN.LE.(3.0*EIN(38))) GO TO 934
      PEQIN(38,I)=PEQEL(2,(I-IOFFN(38)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=17.88 EV     F=0.01802
  934 QIN(39,I)=0.0
      PEQIN(39,I)=0.0
      IF(EN.LE.EIN(39)) GO TO 935
      QIN(39,I)=0.01802/(EIN(39)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(39)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(39)+E(3))*1.0070
      IF(QIN(39,I).LT.0.0) QIN(39,I)=0.0
      IF(EN.LE.(3.0*EIN(39))) GO TO 935
      PEQIN(39,I)=PEQEL(2,(I-IOFFN(39)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=18.13 EV     F=0.01287
  935 QIN(40,I)=0.0
      PEQIN(40,I)=0.0
      IF(EN.LE.EIN(40)) GO TO 936
      QIN(40,I)=0.01287/(EIN(40)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(40)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(40)+E(3))*1.0069
      IF(QIN(40,I).LT.0.0) QIN(40,I)=0.0
      IF(EN.LE.(3.0*EIN(40))) GO TO 936
      PEQIN(40,I)=PEQEL(2,(I-IOFFN(40)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=18.38 EV     F=0.00830
  936 QIN(41,I)=0.0
      PEQIN(41,I)=0.0
      IF(EN.LE.EIN(41)) GO TO 937
      QIN(41,I)=0.00830/(EIN(41)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(41)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(41)+E(3))*1.0068
      IF(QIN(41,I).LT.0.0) QIN(41,I)=0.0
      IF(EN.LE.(3.0*EIN(41))) GO TO 937
      PEQIN(41,I)=PEQEL(2,(I-IOFFN(41)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=18.63 EV     F=0.00698
  937 QIN(42,I)=0.0
      PEQIN(42,I)=0.0
      IF(EN.LE.EIN(42)) GO TO 938
      QIN(42,I)=0.00698/(EIN(42)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(42)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(42)+E(3))*1.0067
      IF(QIN(42,I).LT.0.0) QIN(42,I)=0.0
      IF(EN.LE.(3.0*EIN(42))) GO TO 938
      PEQIN(42,I)=PEQEL(2,(I-IOFFN(42)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=18.88 EV     F=0.00581
  938 QIN(43,I)=0.0
      PEQIN(43,I)=0.0
      IF(EN.LE.EIN(43)) GO TO 939
      QIN(43,I)=0.00581/(EIN(43)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(43)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(43)+E(3))*1.0066
      IF(QIN(43,I).LT.0.0) QIN(43,I)=0.0
      IF(EN.LE.(3.0*EIN(43))) GO TO 939
      PEQIN(43,I)=PEQEL(2,(I-IOFFN(43)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=19.13 EV     F=0.00502
  939 QIN(44,I)=0.0
      PEQIN(44,I)=0.0
      IF(EN.LE.EIN(44)) GO TO 940
      QIN(44,I)=0.00502/(EIN(44)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(44)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(44)+E(3))*1.0065
      IF(QIN(44,I).LT.0.0) QIN(44,I)=0.0
      IF(EN.LE.(3.0*EIN(44))) GO TO 940
      PEQIN(44,I)=PEQEL(2,(I-IOFFN(44)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=19.38 EV     F=0.00398
  940 QIN(45,I)=0.0
      PEQIN(45,I)=0.0
      IF(EN.LE.EIN(45)) GO TO 941
      QIN(45,I)=0.00398/(EIN(45)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(45)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(45)+E(3))*1.0064
      IF(QIN(45,I).LT.0.0) QIN(45,I)=0.0
      IF(EN.LE.(3.0*EIN(45))) GO TO 941
      PEQIN(45,I)=PEQEL(2,(I-IOFFN(45)))
C SINGLET NEUTRAL DISSOCIATION   ELOSS=19.63 EV     F=0.00189
  941 QIN(46,I)=0.0
      PEQIN(46,I)=0.0
      IF(EN.LE.EIN(46)) GO TO 942
      QIN(46,I)=0.00198/(EIN(46)*BETA2)*(DLOG(BETA2*GAMMA2*EMASS2/(4.0
     /*EIN(46)))-BETA2-DEN(I)/2.0)*BBCONST*EN/(EN+EIN(46)+E(3))*1.0064
      IF(QIN(46,I).LT.0.0) QIN(46,I)=0.0
      IF(EN.LE.(3.0*EIN(46))) GO TO 942
      PEQIN(46,I)=PEQEL(2,(I-IOFFN(46)))
  942 CONTINUE
C LOAD BREMSSTRAHLUNG X-SECTIONS
C     QIN(47,I)=0.0
C     QIN(48,I)=0.0
C     IF(EN.LE.1000.) GO TO 1000
C     DO 952 J=2,NBREM
C     IF(EN.LE.EBRM(J)) GO TO 953
C 952 CONTINUE
C     J=NBREM
C 953 A=(DLOG(Z6T(J))-DLOG(Z6T(J-1)))/(EBRM(J)-EBRM(J-1))
C     B=(DLOG(Z6T(J))*EBRM(J-1)-DLOG(Z6T(J-1))*EBRM(J))/
C    /(EBRM(J-1)-EBRM(J))
C     A1=(DLOG(Z9T(J))-DLOG(Z9T(J-1)))/(EBRM(J)-EBRM(J-1))
C     B1=(DLOG(Z9T(J))*EBRM(J-1)-DLOG(Z9T(J-1))*EBRM(J))/
C    /(EBRM(J-1)-EBRM(J))
C     QIN(47,I)=DEXP(A*EN+B)*1.D-24
C     QIN(48,I)=DEXP(A1*EN+B1)*4.D-24
 1000 CONTINUE
C
C COUNTING IONISATION SUM
      QIONSUM=0.0
      DO 1001 J=1,12
 1001 QIONSUM=QIONSUM+QION(J,I)
      QSNGLSUM=0.0
      DO 1002 J=11,46
C SKIP TRIPLETS
      IF(J.EQ.11.OR.J.EQ.16.OR.J.EQ.23) GO TO 1002
      QSNGLSUM=QSNGLSUM+QIN(J,I)
 1002 CONTINUE
      QTRIPSUM=QIN(11,I)+QIN(16,I)+QIN(23,I)
C VIBRATION SUM
      VSUM=0.0
      DO 1003 J=1,10
 1003 VSUM=VSUM+QIN(J,I)
C GROSS IONISATION SUM
      QIONG=QIONSUM
      DO 1004 J=6,12
 1004 QIONG=QIONG+QION(J,I)
      If(I.EQ.1) THEN
      DO 1121 J=1,10
 1121 print *,QIN(J,I)
      ENDIF

C
      DISTOT=QSNGLSUM+QTRIPSUM+QIONSUM
      Q(1,I)=Q(2,I)+Q(4,I)+VSUM+DISTOT
C     WRITE(6,444) EN,Q(1,I),Q(2,I),VSUM,QSNGLSUM,QTRIPSUM,QIONSUM,
C    /QIONG,DISTOT
C 444 FORMAT(' EN=',D12.6,' TOT=',D12.4,' ELAS=',D12.4,' VIB SUM=',
C    /D12.4,/,' NEUTRAL DIP. DISS=',D12.4,' TRIPLET DISS=',D12.4,/,
C    /' COUNT IONISATION=',D12.4,/' GROSS IONISATION=',D12.4,/,
C    /' DISTOT=',D12.4)
 9000 CONTINUE
C  SAVE COMPUTE TIME
C     IF(EFINAL.GT.1000.) NIN=48


      DO 9001 J=11,46
      IF(EFINAL.LE.EIN(J)) THEN
       NIN=J-1
       GO TO 9002
      ENDIF

 9001 CONTINUE


 9002 CONTINUE
      print *,'Q='
      Print *,Q(1,)
      RETURN
      END
